var $c=Object.defineProperty;var tu=(a,t)=>{for(var e in t)$c(a,e,{get:t[e],enumerable:!0})};var Pi={};tu(Pi,{MODE:()=>eu,NODE_ENV:()=>nu,SSR:()=>su});var eu="development",nu="development",su=!1;function kt(){}function iu(a,t){for(let e in t)a[e]=t[e];return a}function Qr(a){return a()}function Hr(){return Object.create(null)}function fe(a){a.forEach(Qr)}function Ke(a){return typeof a=="function"}function At(a,t){return a!=a?t==t:a!==t||a&&typeof a=="object"||typeof a=="function"}function ru(a){return Object.keys(a).length===0}function ou(a,...t){if(a==null)return kt;let e=a.subscribe(...t);return e.unsubscribe?()=>e.unsubscribe():e}function ee(a,t,e){a.$$.on_destroy.push(ou(t,e))}function ji(a,t,e,i){if(a){let c=Zr(a,t,e,i);return a[0](c)}}function Zr(a,t,e,i){return a[1]&&i?iu(e.ctx.slice(),a[1](i(t))):e.ctx}function au(a,t,e,i){if(a[2]&&i){let c=a[2](i(e));if(t.dirty===void 0)return c;if(typeof c=="object"){let l=[],r=Math.max(t.dirty.length,c.length);for(let s=0;s<r;s+=1)l[s]=t.dirty[s]|c[s];return l}return t.dirty|c}return t.dirty}function Ri(a,t,e,i,c,l,r){let s=au(t,i,c,l);if(s){let n=Zr(t,e,i,r);a.p(n,s)}}var Xr=typeof window!="undefined",Fi=Xr?()=>window.performance.now():()=>Date.now(),Kr=Xr?a=>requestAnimationFrame(a):kt,gn=new Set;function Jr(a){gn.forEach(t=>{t.c(a)||(gn.delete(t),t.f())}),gn.size!==0&&Kr(Jr)}function $r(a){let t;return gn.size===0&&Kr(Jr),{promise:new Promise(e=>{gn.add(t={c:a,f:e})}),abort(){gn.delete(t)}}}function X(a,t){a.appendChild(t)}function Ot(a,t,e){a.insertBefore(t,e||null)}function wt(a){a.parentNode.removeChild(a)}function Je(a,t){for(let e=0;e<a.length;e+=1)a[e]&&a[e].d(t)}function K(a){return document.createElement(a)}function $e(a){return document.createTextNode(a)}function Pt(){return $e(" ")}function Ct(a,t,e,i){return a.addEventListener(t,e,i),()=>a.removeEventListener(t,e,i)}function H(a,t,e){e==null?a.removeAttribute(t):a.getAttribute(t)!==e&&a.setAttribute(t,e)}function cu(a){return Array.from(a.childNodes)}function qi(a,t){t=""+t,a.wholeText!==t&&(a.data=t)}function Et(a,t,e,i){a.style.setProperty(t,e,i?"important":"")}function uu(a,t){let e=document.createEvent("CustomEvent");return e.initCustomEvent(a,!1,!1,t),e}var js;function Rs(a){js=a}function Vi(){if(!js)throw new Error("Function called outside component initialization");return js}function rs(){let a=Vi();return(t,e)=>{let i=a.$$.callbacks[t];if(i){let c=uu(t,e);i.slice().forEach(l=>{l.call(a,c)})}}}function Wi(a,t){Vi().$$.context.set(a,t)}function Li(a){return Vi().$$.context.get(a)}function xe(a,t){let e=a.$$.callbacks[t.type];e&&e.slice().forEach(i=>i(t))}var os=[],as=[],Fs=[],to=[],lu=Promise.resolve(),Bi=!1;function hu(){Bi||(Bi=!0,lu.then(eo))}function bn(a){Fs.push(a)}var zi=!1,Ui=new Set;function eo(){if(!zi){zi=!0;do{for(let a=0;a<os.length;a+=1){let t=os[a];Rs(t),fu(t.$$)}for(Rs(null),os.length=0;as.length;)as.pop()();for(let a=0;a<Fs.length;a+=1){let t=Fs[a];Ui.has(t)||(Ui.add(t),t())}Fs.length=0}while(os.length);for(;to.length;)to.pop()();Bi=!1,zi=!1,Ui.clear()}}function fu(a){if(a.fragment!==null){a.update(),fe(a.before_update);let t=a.dirty;a.dirty=[-1],a.fragment&&a.fragment.p(a.ctx,t),a.after_update.forEach(bn)}}var qs=new Set,tn;function vn(){tn={r:0,c:[],p:tn}}function wn(){tn.r||fe(tn.c),tn=tn.p}function at(a,t){a&&a.i&&(qs.delete(a),a.i(t))}function St(a,t,e,i){if(a&&a.o){if(qs.has(a))return;qs.add(a),tn.c.push(()=>{qs.delete(a),i&&(e&&a.d(1),i())}),a.o(t)}}function ne(a){a&&a.c()}function Zt(a,t,e,i){let{fragment:c,on_mount:l,on_destroy:r,after_update:s}=a.$$;c&&c.m(t,e),i||bn(()=>{let n=l.map(Qr).filter(Ke);r?r.push(...n):fe(n),a.$$.on_mount=[]}),s.forEach(bn)}function Xt(a,t){let e=a.$$;e.fragment!==null&&(fe(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function pu(a,t){a.$$.dirty[0]===-1&&(os.push(a),hu(),a.$$.dirty.fill(0)),a.$$.dirty[t/31|0]|=1<<t%31}function qt(a,t,e,i,c,l,r=[-1]){let s=js;Rs(a);let n=a.$$={fragment:null,ctx:null,props:l,update:kt,not_equal:c,bound:Hr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:[]),callbacks:Hr(),dirty:r,skip_bound:!1},o=!1;if(n.ctx=e?e(a,t.props||{},(u,h,...f)=>{let p=f.length?f[0]:h;return n.ctx&&c(n.ctx[u],n.ctx[u]=p)&&(!n.skip_bound&&n.bound[u]&&n.bound[u](p),o&&pu(a,u)),h}):[],n.update(),o=!0,fe(n.before_update),n.fragment=i?i(n.ctx):!1,t.target){if(t.hydrate){let u=cu(t.target);n.fragment&&n.fragment.l(u),u.forEach(wt)}else n.fragment&&n.fragment.c();t.intro&&at(a.$$.fragment),Zt(a,t.target,t.anchor,t.customElement),eo()}Rs(s)}var jt=class{$destroy(){Xt(this,1),this.$destroy=kt}$on(t,e){let i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{let c=i.indexOf(e);c!==-1&&i.splice(c,1)}}$set(t){this.$$set&&!ru(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};var no="14.7.77",so=(a,t,e)=>({endTime:t,insertTime:e,type:"exponentialRampToValue",value:a}),io=(a,t,e)=>({endTime:t,insertTime:e,type:"linearRampToValue",value:a}),Gi=(a,t)=>({startTime:t,type:"setValue",value:a}),ro=(a,t,e)=>({duration:e,startTime:t,type:"setValueCurve",values:a}),oo=(a,t,{startTime:e,target:i,timeConstant:c})=>i+(t-i)*Math.exp((e-a)/c),Sn=a=>a.type==="exponentialRampToValue",Vs=a=>a.type==="linearRampToValue",Pe=a=>Sn(a)||Vs(a),Yi=a=>a.type==="setValue",Oe=a=>a.type==="setValueCurve",Ws=(a,t,e,i)=>{let c=a[t];return c===void 0?i:Pe(c)||Yi(c)?c.value:Oe(c)?c.values[c.values.length-1]:oo(e,Ws(a,t-1,c.startTime,i),c)},ao=(a,t,e,i,c)=>e===void 0?[i.insertTime,c]:Pe(e)?[e.endTime,e.value]:Yi(e)?[e.startTime,e.value]:Oe(e)?[e.startTime+e.duration,e.values[e.values.length-1]]:[e.startTime,Ws(a,t-1,e.startTime,c)],Qi=a=>a.type==="cancelAndHold",Hi=a=>a.type==="cancelScheduledValues",Te=a=>Qi(a)||Hi(a)?a.cancelTime:Sn(a)||Vs(a)?a.endTime:a.startTime,co=(a,t,e,{endTime:i,value:c})=>e===c?c:0<e&&0<c||e<0&&c<0?e*(c/e)**((a-t)/(i-t)):0,uo=(a,t,e,{endTime:i,value:c})=>e+(a-t)/(i-t)*(c-e),du=(a,t)=>{let e=Math.floor(t),i=Math.ceil(t);return e===i?a[e]:(1-(t-e))*a[e]+(1-(i-t))*a[i]},_u=(a,{duration:t,startTime:e,values:i})=>{let c=(a-e)/t*(i.length-1);return du(i,c)},Ls=a=>a.type==="setTarget",lo=class{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){let e=Te(t);if(Qi(t)||Hi(t)){let i=this._automationEvents.findIndex(l=>Hi(t)&&Oe(l)?l.startTime+l.duration>=e:Te(l)>=e),c=this._automationEvents[i];if(i!==-1&&(this._automationEvents=this._automationEvents.slice(0,i)),Qi(t)){let l=this._automationEvents[this._automationEvents.length-1];if(c!==void 0&&Pe(c)){if(Ls(l))throw new Error("The internal list is malformed.");let r=Oe(l)?l.startTime+l.duration:Te(l),s=Oe(l)?l.values[l.values.length-1]:l.value,n=Sn(c)?co(e,r,s,c):uo(e,r,s,c),o=Sn(c)?so(n,e,this._currenTime):io(n,e,this._currenTime);this._automationEvents.push(o)}l!==void 0&&Ls(l)&&this._automationEvents.push(Gi(this.getValue(e),e)),l!==void 0&&Oe(l)&&l.startTime+l.duration>e&&(this._automationEvents[this._automationEvents.length-1]=ro(new Float32Array([6,7]),l.startTime,e-l.startTime))}}else{let i=this._automationEvents.findIndex(r=>Te(r)>e),c=i===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[i-1];if(c!==void 0&&Oe(c)&&Te(c)+c.duration>e)return!1;let l=Sn(t)?so(t.value,t.endTime,this._currenTime):Vs(t)?io(t.value,e,this._currenTime):t;if(i===-1)this._automationEvents.push(l);else{if(Oe(t)&&e+t.duration>Te(this._automationEvents[i]))return!1;this._automationEvents.splice(i,0,l)}}return!0}flush(t){let e=this._automationEvents.findIndex(i=>Te(i)>t);if(e>1){let i=this._automationEvents.slice(e-1),c=i[0];Ls(c)&&i.unshift(Gi(Ws(this._automationEvents,e-2,c.startTime,this._defaultValue),c.startTime)),this._automationEvents=i}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;let e=this._automationEvents[this._automationEvents.length-1],i=this._automationEvents.findIndex(r=>Te(r)>t),c=this._automationEvents[i],l=Te(e)<=t?e:this._automationEvents[i-1];if(l!==void 0&&Ls(l)&&(c===void 0||!Pe(c)||c.insertTime>t))return oo(t,Ws(this._automationEvents,i-2,l.startTime,this._defaultValue),l);if(l!==void 0&&Yi(l)&&(c===void 0||!Pe(c)))return l.value;if(l!==void 0&&Oe(l)&&(c===void 0||!Pe(c)||l.startTime+l.duration>t))return t<l.startTime+l.duration?_u(t,l):l.values[l.values.length-1];if(l!==void 0&&Pe(l)&&(c===void 0||!Pe(c)))return l.value;if(c!==void 0&&Sn(c)){let[r,s]=ao(this._automationEvents,i-1,l,c,this._defaultValue);return co(t,r,s,c)}if(c!==void 0&&Vs(c)){let[r,s]=ao(this._automationEvents,i-1,l,c,this._defaultValue);return uo(t,r,s,c)}return this._defaultValue}},mu=a=>({cancelTime:a,type:"cancelAndHold"}),yu=a=>({cancelTime:a,type:"cancelScheduledValues"}),gu=(a,t)=>({endTime:t,type:"exponentialRampToValue",value:a}),bu=(a,t)=>({endTime:t,type:"linearRampToValue",value:a}),vu=(a,t,e)=>({startTime:t,target:a,timeConstant:e,type:"setTarget"}),wu=()=>new DOMException("","AbortError"),Su=a=>(t,e,[i,c,l],r)=>{a(t[c],[e,i,l],s=>s[0]===e&&s[1]===i,r)},xu=a=>(t,e,i)=>{let c=[];for(let l=0;l<i.numberOfInputs;l+=1)c.push(new Set);a.set(t,{activeInputs:c,outputs:new Set,passiveInputs:new WeakMap,renderer:e})},Ou=a=>(t,e)=>{a.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})},xn=new WeakSet,ho=new WeakMap,Zi=new WeakMap,fo=new WeakMap,Xi=new WeakMap,Bs=new WeakMap,po=new WeakMap,Ki=new WeakMap,Ji=new WeakMap,$i=new WeakMap,_o={construct(){return _o}},Tu=a=>{try{let t=new Proxy(a,_o);new t}catch{return!1}return!0},mo=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,yo=(a,t)=>{let e=[],i=a.replace(/^[\s]+/,""),c=i.match(mo);for(;c!==null;){let l=c[1].slice(1,-1),r=c[0].replace(/([\s]+)?;?$/,"").replace(l,new URL(l,t).toString());e.push(r),i=i.slice(c[0].length).replace(/^[\s]+/,""),c=i.match(mo)}return[e.join(";"),i]},go=a=>{if(a!==void 0&&!Array.isArray(a))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},bo=a=>{if(!Tu(a))throw new TypeError("The given value for processorCtor should be a constructor.");if(a.prototype===null||typeof a.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},ku=(a,t,e,i,c,l,r,s,n,o,u,h)=>(f,p,d={credentials:"omit"})=>{let _=l(f);if(_.audioWorklet!==void 0)return Promise.all([c(p),Promise.resolve(a(u,u))]).then(([[k,x],g])=>{let[A,T]=yo(k,x),O=g?T:T.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),D=`${A};(registerProcessor=>{${O}
})((n,p)=>registerProcessor(n,class extends p{${g?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${g?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`,C=new Blob([D],{type:"application/javascript; charset=utf-8"}),E=URL.createObjectURL(C);return _.audioWorklet.addModule(E,d).then(()=>s(_)?void 0:r(_).audioWorklet.addModule(E,d)).finally(()=>URL.revokeObjectURL(E))});let y=o.get(f);if(y!==void 0&&y.has(p))return Promise.resolve();let m=n.get(f);if(m!==void 0){let k=m.get(p);if(k!==void 0)return k}let b=c(p).then(([k,x])=>{let[g,A]=yo(k,x),T=`${g};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${A}
})})(window,'_AWGS')`;return e(T)}).then(()=>{let k=h._AWGS.pop();if(k===void 0)throw new SyntaxError;i(_.currentTime,_.sampleRate,()=>k(class{},void 0,(x,g)=>{if(x.trim()==="")throw t();let A=Ji.get(_);if(A!==void 0){if(A.has(x))throw t();bo(g),go(g.parameterDescriptors),A.set(x,g)}else bo(g),go(g.parameterDescriptors),Ji.set(_,new Map([[x,g]]))},_.sampleRate,void 0,void 0))});return m===void 0?n.set(f,new Map([[p,b]])):m.set(p,b),b.then(()=>{let k=o.get(f);k===void 0?o.set(f,new Set([p])):k.add(p)}).finally(()=>{let k=n.get(f);k!==void 0&&k.delete(p)}),b},se=(a,t)=>{let e=a.get(t);if(e===void 0)throw new Error("A value with the given key could not be found.");return e},zs=(a,t)=>{let e=Array.from(a).filter(t);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");let[i]=e;return a.delete(i),i},vo=(a,t,e,i)=>{let c=se(a,t),l=zs(c,r=>r[0]===e&&r[1]===i);return c.size===0&&a.delete(t),l},cs=a=>se(po,a),On=a=>{if(xn.has(a))throw new Error("The AudioNode is already stored.");xn.add(a),cs(a).forEach(t=>t(!0))},wo=a=>"port"in a,us=a=>{if(!xn.has(a))throw new Error("The AudioNode is not stored.");xn.delete(a),cs(a).forEach(t=>t(!1))},tr=(a,t)=>{!wo(a)&&t.every(e=>e.size===0)&&us(a)},Au=(a,t,e,i,c,l,r,s,n,o,u,h,f)=>{let p=new WeakMap;return(d,_,y,m,b)=>{let{activeInputs:k,passiveInputs:x}=l(_),{outputs:g}=l(d),A=s(d),T=O=>{let w=n(_),M=n(d);if(O){let D=vo(x,d,y,m);a(k,d,D,!1),!b&&!h(d)&&e(M,w,y,m),f(_)&&On(_)}else{let D=i(k,d,y,m);t(x,m,D,!1),!b&&!h(d)&&c(M,w,y,m);let C=r(_);if(C===0)u(_)&&tr(_,k);else{let E=p.get(_);E!==void 0&&clearTimeout(E),p.set(_,setTimeout(()=>{u(_)&&tr(_,k)},C*1e3))}}};return o(g,[_,y,m],O=>O[0]===_&&O[1]===y&&O[2]===m,!0)?(A.add(T),u(d)?a(k,d,[y,m,T],!0):t(x,m,[d,y,T],!0),!0):!1}},Cu=a=>(t,e,[i,c,l],r)=>{let s=t.get(i);s===void 0?t.set(i,new Set([[c,e,l]])):a(s,[c,e,l],n=>n[0]===c&&n[1]===e,r)},Eu=a=>(t,e)=>{let i=a(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(i).connect(t.destination);let c=()=>{e.removeEventListener("ended",c),e.disconnect(i),i.disconnect()};e.addEventListener("ended",c)},Du=a=>(t,e)=>{a(t).add(e)},Mu={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Nu=(a,t,e,i,c,l)=>class extends a{constructor(s,n){let o=c(s),u={...Mu,...n},h=i(o,u),f=l(o)?t():null;super(s,!1,h,f);this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(s){this._nativeAnalyserNode.fftSize=s}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(s){let n=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=s,!(s>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=n,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(s){let n=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=s,!(this._nativeAnalyserNode.maxDecibels>s))throw this._nativeAnalyserNode.minDecibels=n,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(s){this._nativeAnalyserNode.smoothingTimeConstant=s}getByteFrequencyData(s){this._nativeAnalyserNode.getByteFrequencyData(s)}getByteTimeDomainData(s){this._nativeAnalyserNode.getByteTimeDomainData(s)}getFloatFrequencyData(s){this._nativeAnalyserNode.getFloatFrequencyData(s)}getFloatTimeDomainData(s){this._nativeAnalyserNode.getFloatTimeDomainData(s)}},Rt=(a,t)=>a.context===t,Iu=(a,t,e)=>()=>{let i=new WeakMap,c=async(l,r,s)=>{let n=t(l);if(!Rt(n,r)){let u={channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,fftSize:n.fftSize,maxDecibels:n.maxDecibels,minDecibels:n.minDecibels,smoothingTimeConstant:n.smoothingTimeConstant};n=a(r,u)}return i.set(r,n),await e(l,r,n,s),n};return{render(l,r,s){let n=i.get(r);return n!==void 0?Promise.resolve(n):c(l,r,s)}}},Us=a=>{try{a.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},pe=()=>new DOMException("","IndexSizeError"),er=a=>{a.getChannelData=(t=>e=>{try{return t.call(a,e)}catch(i){throw i.code===12?pe():i}})(a.getChannelData)},Pu={numberOfChannels:1},ju=(a,t,e,i,c,l,r,s)=>{let n=null;return class So{constructor(u){if(c===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:h,numberOfChannels:f,sampleRate:p}={...Pu,...u};n===null&&(n=new c(1,1,44100));let d=i!==null&&t(l,l)?new i({length:h,numberOfChannels:f,sampleRate:p}):n.createBuffer(f,h,p);if(d.numberOfChannels===0)throw e();return typeof d.copyFromChannel!="function"?(r(d),er(d)):t(Us,()=>Us(d))||s(d),a.add(d),d}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===So.prototype||a.has(u)}}},Bt=-34028234663852886e22,Vt=-Bt,ke=a=>xn.has(a),Ru={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Fu=(a,t,e,i,c,l,r,s)=>class extends a{constructor(o,u){let h=l(o),f={...Ru,...u},p=c(h,f),d=r(h),_=d?t():null;super(o,!1,p,_);this._audioBufferSourceNodeRenderer=_,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=p,this._onended=null,this._playbackRate=e(this,d,p.playbackRate,Vt,Bt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(o){if(this._nativeAudioBufferSourceNode.buffer=o,o!==null){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(o){this._nativeAudioBufferSourceNode.loop=o}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(o){this._nativeAudioBufferSourceNode.loopEnd=o}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(o){this._nativeAudioBufferSourceNode.loopStart=o}get onended(){return this._onended}set onended(o){let u=typeof o=="function"?s(this,o):null;this._nativeAudioBufferSourceNode.onended=u;let h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?o:h}get playbackRate(){return this._playbackRate}start(o=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(o,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[o,u]:[o,u,h]),this.context.state!=="closed"){On(this);let f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),ke(this)&&us(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(o=0){this._nativeAudioBufferSourceNode.stop(o),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=o)}},qu=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=null,s=null,n=async(o,u,h)=>{let f=e(o),p=Rt(f,u);if(!p){let d={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,loop:f.loop,loopEnd:f.loopEnd,loopStart:f.loopStart,playbackRate:f.playbackRate.value};f=t(u,d),r!==null&&f.start(...r),s!==null&&f.stop(s)}return l.set(u,f),p?await a(u,o.playbackRate,f.playbackRate,h):await i(u,o.playbackRate,f.playbackRate,h),await c(o,u,f,h),f};return{set start(o){r=o},set stop(o){s=o},render(o,u,h){let f=l.get(u);return f!==void 0?Promise.resolve(f):n(o,u,h)}}},Vu=a=>"playbackRate"in a,Wu=a=>"frequency"in a&&"gain"in a,Lu=a=>"offset"in a,Bu=a=>!("frequency"in a)&&"gain"in a,zu=a=>"detune"in a&&"frequency"in a,Uu=a=>"pan"in a,Wt=a=>se(ho,a),ls=a=>se(fo,a),nr=(a,t)=>{let{activeInputs:e}=Wt(a);e.forEach(c=>c.forEach(([l])=>{t.includes(a)||nr(l,[...t,a])}));let i=Vu(a)?[a.playbackRate]:wo(a)?Array.from(a.parameters.values()):Wu(a)?[a.Q,a.detune,a.frequency,a.gain]:Lu(a)?[a.offset]:Bu(a)?[a.gain]:zu(a)?[a.detune,a.frequency]:Uu(a)?[a.pan]:[];for(let c of i){let l=ls(c);l!==void 0&&l.activeInputs.forEach(([r])=>nr(r,t))}ke(a)&&us(a)},xo=a=>{nr(a.destination,[])},Gu=a=>a===void 0||typeof a=="number"||typeof a=="string"&&(a==="balanced"||a==="interactive"||a==="playback"),Yu=(a,t,e,i,c,l,r,s,n)=>class extends a{constructor(u={}){if(n===null)throw new Error("Missing the native AudioContext constructor.");let h=new n(u);if(h===null)throw i();if(!Gu(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw e();super(h,2);let{latencyHint:f}=u,{sampleRate:p}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:f==="balanced"?512/p:f==="interactive"||f===void 0?256/p:f==="playback"?1024/p:Math.max(2,Math.min(128,Math.round(f*p/128)))*128/p,this._nativeAudioContext=h,n.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";let d=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",d)};h.addEventListener("statechange",d)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),xo(this)}))}createMediaElementSource(u){return new c(this,{mediaElement:u})}createMediaStreamDestination(){return new l(this)}createMediaStreamSource(u){return new r(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new s(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{let f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?t():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?t():u})}},Qu=(a,t,e,i,c,l,r,s)=>class extends a{constructor(o,u){let h=l(o),f=r(h),p=c(h,u,f),d=f?t(s):null;super(o,!1,p,d);this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=p}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(o){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(o>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=o}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(o){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=o}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Hu=a=>{let t=null,e=async(i,c,l)=>{let r=c.destination;return await a(i,c,r,l),r};return{render(i,c,l){return t===null&&(t=e(i,c,l)),t}}},Zu=(a,t,e,i,c)=>(l,r)=>{let s=r.listener,n=()=>{let b=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),k=c(r),x=i(r,256,9,0),g=(O,w)=>{let M=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:w});return M.connect(b,0,O),M.start(),Object.defineProperty(M.offset,"defaultValue",{get(){return w}}),a({context:l},k,M.offset,Vt,Bt)},A=[0,0,-1,0,1,0],T=[0,0,0];return x.onaudioprocess=({inputBuffer:O})=>{let w=[O.getChannelData(0)[0],O.getChannelData(1)[0],O.getChannelData(2)[0],O.getChannelData(3)[0],O.getChannelData(4)[0],O.getChannelData(5)[0]];w.some((D,C)=>D!==A[C])&&(s.setOrientation(...w),A=w);let M=[O.getChannelData(6)[0],O.getChannelData(7)[0],O.getChannelData(8)[0]];M.some((D,C)=>D!==T[C])&&(s.setPosition(...M),T=M)},b.connect(x),{forwardX:g(0,0),forwardY:g(1,0),forwardZ:g(2,-1),positionX:g(6,0),positionY:g(7,0),positionZ:g(8,0),upX:g(3,0),upY:g(4,1),upZ:g(5,0)}},{forwardX:o,forwardY:u,forwardZ:h,positionX:f,positionY:p,positionZ:d,upX:_,upY:y,upZ:m}=s.forwardX===void 0?n():s;return{get forwardX(){return o},get forwardY(){return u},get forwardZ(){return h},get positionX(){return f},get positionY(){return p},get positionZ(){return d},get upX(){return _},get upY(){return y},get upZ(){return m}}},Gs=a=>"context"in a,hs=a=>Gs(a[0]),en=(a,t,e,i)=>{for(let c of a)if(e(c)){if(i)return!1;throw Error("The set contains at least one similar element.")}return a.add(t),!0},Oo=(a,t,[e,i],c)=>{en(a,[t,e,i],l=>l[0]===t&&l[1]===e,c)},To=(a,[t,e,i],c)=>{let l=a.get(t);l===void 0?a.set(t,new Set([[e,i]])):en(l,[e,i],r=>r[0]===e,c)},Tn=a=>"inputs"in a,Ys=(a,t,e,i)=>{if(Tn(t)){let c=t.inputs[i];return a.connect(c,e,0),[c,e,0]}return a.connect(t,e,i),[t,e,i]},ko=(a,t,e)=>{for(let i of a)if(i[0]===t&&i[1]===e)return a.delete(i),i;return null},Xu=(a,t,e)=>zs(a,i=>i[0]===t&&i[1]===e),Ao=(a,t)=>{if(!cs(a).delete(t))throw new Error("Missing the expected event listener.")},Co=(a,t,e)=>{let i=se(a,t),c=zs(i,l=>l[0]===e);return i.size===0&&a.delete(t),c},Qs=(a,t,e,i)=>{Tn(t)?a.disconnect(t.inputs[i],e,0):a.disconnect(t,e,i)},nt=a=>se(Zi,a),fs=a=>se(Xi,a),nn=a=>Ki.has(a),Hs=a=>!xn.has(a),Eo=a=>new Promise(t=>{let e=a.createScriptProcessor(256,1,1),i=a.createGain(),c=a.createBuffer(1,2,44100),l=c.getChannelData(0);l[0]=1,l[1]=1;let r=a.createBufferSource();r.buffer=c,r.loop=!0,r.connect(e).connect(a.destination),r.connect(i),r.disconnect(i),e.onaudioprocess=s=>{let n=s.inputBuffer.getChannelData(0);Array.prototype.some.call(n,o=>o===1)?t(!0):t(!1),r.stop(),e.onaudioprocess=null,r.disconnect(e),e.disconnect(a.destination)},r.start()}),sr=(a,t)=>{let e=new Map;for(let i of a)for(let c of i){let l=e.get(c);e.set(c,l===void 0?1:l+1)}e.forEach((i,c)=>t(c,i))},Zs=a=>"context"in a,Ku=a=>{let t=new Map;a.connect=(e=>(i,c=0,l=0)=>{let r=Zs(i)?e(i,c,l):e(i,c),s=t.get(i);return s===void 0?t.set(i,[{input:l,output:c}]):s.every(n=>n.input!==l||n.output!==c)&&s.push({input:l,output:c}),r})(a.connect.bind(a)),a.disconnect=(e=>(i,c,l)=>{if(e.apply(a),i===void 0)t.clear();else if(typeof i=="number")for(let[r,s]of t){let n=s.filter(o=>o.output!==i);n.length===0?t.delete(r):t.set(r,n)}else if(t.has(i))if(c===void 0)t.delete(i);else{let r=t.get(i);if(r!==void 0){let s=r.filter(n=>n.output!==c&&(n.input!==l||l===void 0));s.length===0?t.delete(i):t.set(i,s)}}for(let[r,s]of t)s.forEach(n=>{Zs(r)?a.connect(r,n.output,n.input):a.connect(r,n.output)})})(a.disconnect)},Ju=(a,t,e,i)=>{let{activeInputs:c,passiveInputs:l}=ls(t),{outputs:r}=Wt(a),s=cs(a),n=o=>{let u=nt(a),h=fs(t);if(o){let f=Co(l,a,e);Oo(c,a,f,!1),!i&&!nn(a)&&u.connect(h,e)}else{let f=Xu(c,a,e);To(l,f,!1),!i&&!nn(a)&&u.disconnect(h,e)}};return en(r,[t,e],o=>o[0]===t&&o[1]===e,!0)?(s.add(n),ke(a)?Oo(c,a,[e,n],!0):To(l,[a,e,n],!0),!0):!1},$u=(a,t,e,i)=>{let{activeInputs:c,passiveInputs:l}=Wt(t),r=ko(c[i],a,e);return r===null?[vo(l,a,e,i)[2],!1]:[r[2],!0]},tl=(a,t,e)=>{let{activeInputs:i,passiveInputs:c}=ls(t),l=ko(i,a,e);return l===null?[Co(c,a,e)[1],!1]:[l[2],!0]},ir=(a,t,e,i,c)=>{let[l,r]=$u(a,e,i,c);if(l!==null&&(Ao(a,l),r&&!t&&!nn(a)&&Qs(nt(a),nt(e),i,c)),ke(e)){let{activeInputs:s}=Wt(e);tr(e,s)}},rr=(a,t,e,i)=>{let[c,l]=tl(a,e,i);c!==null&&(Ao(a,c),l&&!t&&!nn(a)&&nt(a).disconnect(fs(e),i))},el=(a,t)=>{let e=Wt(a),i=[];for(let c of e.outputs)hs(c)?ir(a,t,...c):rr(a,t,...c),i.push(c[0]);return e.outputs.clear(),i},nl=(a,t,e)=>{let i=Wt(a),c=[];for(let l of i.outputs)l[1]===e&&(hs(l)?ir(a,t,...l):rr(a,t,...l),c.push(l[0]),i.outputs.delete(l));return c},sl=(a,t,e,i,c)=>{let l=Wt(a);return Array.from(l.outputs).filter(r=>r[0]===e&&(i===void 0||r[1]===i)&&(c===void 0||r[2]===c)).map(r=>(hs(r)?ir(a,t,...r):rr(a,t,...r),l.outputs.delete(r),r[0]))},il=(a,t,e,i,c,l,r,s,n,o,u,h,f,p,d)=>class extends o{constructor(y,m,b,k){super(b);this._context=y,this._nativeAudioNode=b;let x=u(y);h(x)&&e(Eo,()=>Eo(x))!==!0&&Ku(b),Zi.set(this,b),po.set(this,new Set),y.state!=="closed"&&m&&On(this),a(this,k,b)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,m=0,b=0){if(m<0||m>=this._nativeAudioNode.numberOfOutputs)throw c();let k=u(this._context),x=d(k);if(f(y)||p(y))throw l();if(Gs(y)){let T=nt(y);try{let w=Ys(this._nativeAudioNode,T,m,b),M=Hs(this);(x||M)&&this._nativeAudioNode.disconnect(...w),this.context.state!=="closed"&&!M&&Hs(y)&&On(y)}catch(w){throw w.code===12?l():w}if(t(this,y,m,b,x)){let w=n([this],y);sr(w,i(x))}return y}let g=fs(y);if(g.name==="playbackRate")throw r();try{this._nativeAudioNode.connect(g,m),(x||Hs(this))&&this._nativeAudioNode.disconnect(g,m)}catch(T){throw T.code===12?l():T}if(Ju(this,y,m,x)){let T=n([this],y);sr(T,i(x))}}disconnect(y,m,b){let k,x=u(this._context),g=d(x);if(y===void 0)k=el(this,g);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw c();k=nl(this,g,y)}else{if(m!==void 0&&(m<0||m>=this.numberOfOutputs)||Gs(y)&&b!==void 0&&(b<0||b>=y.numberOfInputs))throw c();if(k=sl(this,g,y,m,b),k.length===0)throw l()}for(let A of k){let T=n([this],A);sr(T,s)}}},rl=(a,t,e,i,c,l,r,s,n,o,u,h,f)=>(p,d,_,y=null,m=null)=>{let b=new lo(_.defaultValue),k=d?i(b):null,x={get defaultValue(){return _.defaultValue},get maxValue(){return y===null?_.maxValue:y},get minValue(){return m===null?_.minValue:m},get value(){return _.value},set value(g){_.value=g,x.setValueAtTime(g,p.context.currentTime)},cancelAndHoldAtTime(g){if(typeof _.cancelAndHoldAtTime=="function")k===null&&b.flush(p.context.currentTime),b.add(c(g)),_.cancelAndHoldAtTime(g);else{let A=Array.from(b).pop();k===null&&b.flush(p.context.currentTime),b.add(c(g));let T=Array.from(b).pop();_.cancelScheduledValues(g),A!==T&&T!==void 0&&(T.type==="exponentialRampToValue"?_.exponentialRampToValueAtTime(T.value,T.endTime):T.type==="linearRampToValue"?_.linearRampToValueAtTime(T.value,T.endTime):T.type==="setValue"?_.setValueAtTime(T.value,T.startTime):T.type==="setValueCurve"&&_.setValueCurveAtTime(T.values,T.startTime,T.duration))}return x},cancelScheduledValues(g){return k===null&&b.flush(p.context.currentTime),b.add(l(g)),_.cancelScheduledValues(g),x},exponentialRampToValueAtTime(g,A){if(g===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;return k===null&&b.flush(p.context.currentTime),b.add(r(g,A)),_.exponentialRampToValueAtTime(g,A),x},linearRampToValueAtTime(g,A){return k===null&&b.flush(p.context.currentTime),b.add(s(g,A)),_.linearRampToValueAtTime(g,A),x},setTargetAtTime(g,A,T){return k===null&&b.flush(p.context.currentTime),b.add(n(g,A,T)),_.setTargetAtTime(g,A,T),x},setValueAtTime(g,A){return k===null&&b.flush(p.context.currentTime),b.add(o(g,A)),_.setValueAtTime(g,A),x},setValueCurveAtTime(g,A,T){let O=g instanceof Float32Array?g:new Float32Array(g);if(h!==null&&h.name==="webkitAudioContext"){let w=A+T,M=p.context.sampleRate,D=Math.ceil(A*M),C=Math.floor(w*M),E=C-D,F=new Float32Array(E);for(let L=0;L<E;L+=1){let V=(O.length-1)/T*((D+L)/M-A),Y=Math.floor(V),gt=Math.ceil(V);F[L]=Y===gt?O[Y]:(1-(V-Y))*O[Y]+(1-(gt-V))*O[gt]}k===null&&b.flush(p.context.currentTime),b.add(u(F,A,T)),_.setValueCurveAtTime(F,A,T);let W=C/M;W<w&&f(x,F[F.length-1],W),f(x,O[O.length-1],w)}else k===null&&b.flush(p.context.currentTime),b.add(u(O,A,T)),_.setValueCurveAtTime(O,A,T);return x}};return e.set(x,_),t.set(x,p),a(x,k),x},ol=a=>({replay(t){for(let e of a)if(e.type==="exponentialRampToValue"){let{endTime:i,value:c}=e;t.exponentialRampToValueAtTime(c,i)}else if(e.type==="linearRampToValue"){let{endTime:i,value:c}=e;t.linearRampToValueAtTime(c,i)}else if(e.type==="setTarget"){let{startTime:i,target:c,timeConstant:l}=e;t.setTargetAtTime(c,i,l)}else if(e.type==="setValue"){let{startTime:i,value:c}=e;t.setValueAtTime(c,i)}else if(e.type==="setValueCurve"){let{duration:i,startTime:c,values:l}=e;t.setValueCurveAtTime(l,c,i)}else throw new Error("Can't apply an unknown automation.")}}),or=class{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((i,c)=>t.call(e,i,c,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}},al={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},cl=(a,t,e,i,c,l,r,s,n,o,u,h,f)=>class extends t{constructor(d,_,y){var m;let b=s(d),k=n(b),x=u({...al,...y}),g=Ji.get(b),A=g==null?void 0:g.get(_),T=k||b.state!=="closed"?b:(m=r(b))!==null&&m!==void 0?m:b,O=c(T,k?null:d.baseLatency,o,_,A,x),w=k?i(_,x,A):null;super(d,!0,O,w);let M=[];O.parameters.forEach((C,E)=>{let F=e(this,k,C);M.push([E,F])}),this._nativeAudioWorkletNode=O,this._onprocessorerror=null,this._parameters=new or(M),k&&a(b,this);let{activeInputs:D}=l(this);h(O,D)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(d){let _=typeof d=="function"?f(this,d):null;this._nativeAudioWorkletNode.onprocessorerror=_;let y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===_?d:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Xs(a,t,e,i,c){if(typeof a.copyFromChannel=="function")t[e].byteLength===0&&(t[e]=new Float32Array(128)),a.copyFromChannel(t[e],i,c);else{let l=a.getChannelData(i);if(t[e].byteLength===0)t[e]=l.slice(c,c+128);else{let r=new Float32Array(l.buffer,c*Float32Array.BYTES_PER_ELEMENT,128);t[e].set(r)}}}var Do=(a,t,e,i,c)=>{typeof a.copyToChannel=="function"?t[e].byteLength!==0&&a.copyToChannel(t[e],i,c):t[e].byteLength!==0&&a.getChannelData(i).set(t[e],c)},Ks=(a,t)=>{let e=[];for(let i=0;i<a;i+=1){let c=[],l=typeof t=="number"?t:t[i];for(let r=0;r<l;r+=1)c.push(new Float32Array(128));e.push(c)}return e},ul=(a,t)=>{let e=se($i,a),i=nt(t);return se(e,i)},ll=async(a,t,e,i,c,l,r)=>{let s=t===null?Math.ceil(a.context.length/128)*128:t.length,n=i.channelCount*i.numberOfInputs,o=c.reduce((y,m)=>y+m,0),u=o===0?null:e.createBuffer(o,s,e.sampleRate);if(l===void 0)throw new Error("Missing the processor constructor.");let h=Wt(a),f=await ul(e,a),p=Ks(i.numberOfInputs,i.channelCount),d=Ks(i.numberOfOutputs,c),_=Array.from(a.parameters.keys()).reduce((y,m)=>({...y,[m]:new Float32Array(128)}),{});for(let y=0;y<s;y+=128){if(i.numberOfInputs>0&&t!==null)for(let m=0;m<i.numberOfInputs;m+=1)for(let b=0;b<i.channelCount;b+=1)Xs(t,p[m],b,b,y);l.parameterDescriptors!==void 0&&t!==null&&l.parameterDescriptors.forEach(({name:m},b)=>{Xs(t,_,m,n+b,y)});for(let m=0;m<i.numberOfInputs;m+=1)for(let b=0;b<c[m];b+=1)d[m][b].byteLength===0&&(d[m][b]=new Float32Array(128));try{let m=p.map((k,x)=>h.activeInputs[x].size===0?[]:k),b=r(y/e.sampleRate,e.sampleRate,()=>f.process(m,d,_));if(u!==null)for(let k=0,x=0;k<i.numberOfOutputs;k+=1){for(let g=0;g<c[k];g+=1)Do(u,d[k],g,x+g,y);x+=c[k]}if(!b)break}catch(m){a.dispatchEvent(new ErrorEvent("processorerror",{colno:m.colno,filename:m.filename,lineno:m.lineno,message:m.message}));break}}return u},hl=(a,t,e,i,c,l,r,s,n,o,u,h,f,p,d,_)=>(y,m,b)=>{let k=new WeakMap,x=null,g=async(A,T,O)=>{let w=u(A),M=null,D=Rt(w,T),C=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(h===null){let E=C.reduce((V,Y)=>V+Y,0),F=c(T,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),W=[];for(let V=0;V<A.numberOfOutputs;V+=1)W.push(i(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[V]}));let L=r(T,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1});L.connect=t.bind(null,W),L.disconnect=n.bind(null,W),M=[F,W,L]}else D||(w=new h(T,y));if(k.set(T,M===null?w:M[2]),M!==null){if(x===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");let Y=A.channelCount*A.numberOfInputs,gt=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,tt=Y+gt;x=ll(A,tt===0?null:await(async()=>{let It=new f(tt,Math.ceil(A.context.length/128)*128,T.sampleRate),U=[],he=[];for(let rt=0;rt<m.numberOfInputs;rt+=1)U.push(r(It,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),he.push(c(It,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));let yn=await Promise.all(Array.from(A.parameters.values()).map(async rt=>{let bt=l(It,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:rt.value});return await p(It,rt,bt.offset,O),bt})),j=i(It,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Y+gt)});for(let rt=0;rt<m.numberOfInputs;rt+=1){U[rt].connect(he[rt]);for(let bt=0;bt<m.channelCount;bt+=1)he[rt].connect(j,bt,rt*m.channelCount+bt)}for(let[rt,bt]of yn.entries())bt.connect(j,0,Y+rt),bt.start(0);return j.connect(It.destination),await Promise.all(U.map(rt=>d(A,It,rt,O))),_(It)})(),T,m,C,b,o)}let E=await x,F=e(T,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[W,L,V]=M;E!==null&&(F.buffer=E,F.start(0)),F.connect(W);for(let Y=0,gt=0;Y<A.numberOfOutputs;Y+=1){let tt=L[Y];for(let Nt=0;Nt<C[Y];Nt+=1)W.connect(tt,gt+Nt,Nt);gt+=C[Y]}return V}if(D)for(let[E,F]of A.parameters.entries())await a(T,F,w.parameters.get(E),O);else for(let[E,F]of A.parameters.entries())await p(T,F,w.parameters.get(E),O);return await d(A,T,w,O),w};return{render(A,T,O){s(T,A);let w=k.get(T);return w!==void 0?Promise.resolve(w):g(A,T,O)}}},fl=(a,t,e,i,c,l,r,s,n,o,u,h,f,p,d,_,y,m,b,k)=>class extends d{constructor(g,A){super(g,A);this._nativeContext=g,this._audioWorklet=a===void 0?void 0:{addModule:(T,O)=>a(this,T,O)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new c(this)}createBuffer(g,A,T){return new e({length:A,numberOfChannels:g,sampleRate:T})}createBufferSource(){return new i(this)}createChannelMerger(g=6){return new l(this,{numberOfInputs:g})}createChannelSplitter(g=6){return new r(this,{numberOfOutputs:g})}createConstantSource(){return new s(this)}createConvolver(){return new n(this)}createDelay(g=1){return new u(this,{maxDelayTime:g})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(g,A){return new p(this,{feedback:A,feedforward:g})}createOscillator(){return new _(this)}createPanner(){return new y(this)}createPeriodicWave(g,A,T={disableNormalization:!1}){return new m(this,{...T,imag:A,real:g})}createStereoPanner(){return new b(this)}createWaveShaper(){return new k(this)}decodeAudioData(g,A,T){return o(this._nativeContext,g).then(O=>(typeof A=="function"&&A(O),O)).catch(O=>{throw typeof T=="function"&&T(O),O})}},pl={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},dl=(a,t,e,i,c,l,r,s)=>class extends a{constructor(o,u){let h=l(o),f={...pl,...u},p=c(h,f),d=r(h),_=d?e():null;super(o,!1,p,_);this._Q=t(this,d,p.Q,Vt,Bt),this._detune=t(this,d,p.detune,1200*Math.log2(Vt),-1200*Math.log2(Vt)),this._frequency=t(this,d,p.frequency,o.sampleRate/2,0),this._gain=t(this,d,p.gain,40*Math.log10(Vt),Bt),this._nativeBiquadFilterNode=p,s(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(o){this._nativeBiquadFilterNode.type=o}getFrequencyResponse(o,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(o,u,h)}catch(f){throw f.code===11?i():f}if(o.length!==u.length||u.length!==h.length)throw i()}},_l=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=async(s,n,o)=>{let u=e(s),h=Rt(u,n);if(!h){let f={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=t(n,f)}return l.set(n,u),h?(await a(n,s.Q,u.Q,o),await a(n,s.detune,u.detune,o),await a(n,s.frequency,u.frequency,o),await a(n,s.gain,u.gain,o)):(await i(n,s.Q,u.Q,o),await i(n,s.detune,u.detune,o),await i(n,s.frequency,u.frequency,o),await i(n,s.gain,u.gain,o)),await c(s,n,u,o),u};return{render(s,n,o){let u=l.get(n);return u!==void 0?Promise.resolve(u):r(s,n,o)}}},ml=(a,t)=>(e,i)=>{let c=t.get(e);if(c!==void 0)return c;let l=a.get(e);if(l!==void 0)return l;try{let r=i();return r instanceof Promise?(a.set(e,r),r.catch(()=>!1).then(s=>(a.delete(e),t.set(e,s),s))):(t.set(e,r),r)}catch{return t.set(e,!1),!1}},yl={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},gl=(a,t,e,i,c)=>class extends a{constructor(r,s){let n=i(r),o={...yl,...s},u=e(n,o),h=c(n)?t():null;super(r,!1,u,h)}},bl=(a,t,e)=>()=>{let i=new WeakMap,c=async(l,r,s)=>{let n=t(l);if(!Rt(n,r)){let u={channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,numberOfInputs:n.numberOfInputs};n=a(r,u)}return i.set(r,n),await e(l,r,n,s),n};return{render(l,r,s){let n=i.get(r);return n!==void 0?Promise.resolve(n):c(l,r,s)}}},vl={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},wl=(a,t,e,i,c,l)=>class extends a{constructor(s,n){let o=i(s),u=l({...vl,...n}),h=e(o,u),f=c(o)?t():null;super(s,!1,h,f)}},Sl=(a,t,e)=>()=>{let i=new WeakMap,c=async(l,r,s)=>{let n=t(l);if(!Rt(n,r)){let u={channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,numberOfOutputs:n.numberOfOutputs};n=a(r,u)}return i.set(r,n),await e(l,r,n,s),n};return{render(l,r,s){let n=i.get(r);return n!==void 0?Promise.resolve(n):c(l,r,s)}}},xl=a=>(t,e,i,c)=>a(e,t,i,c),Ol=a=>(t,e,i=0,c=0)=>{let l=t[i];if(l===void 0)throw a();return Zs(e)?l.connect(e,0,c):l.connect(e,0)},Tl=a=>(t,e)=>{let i=a(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=t.createBuffer(1,2,44100);return i.buffer=c,i.loop=!0,i.connect(e),i.start(),()=>{i.stop(),i.disconnect(e)}},kl={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Al=(a,t,e,i,c,l,r)=>class extends a{constructor(n,o){let u=c(n),h={...kl,...o},f=i(u,h),p=l(u),d=p?e():null;super(n,!1,f,d);this._constantSourceNodeRenderer=d,this._nativeConstantSourceNode=f,this._offset=t(this,p,f.offset,Vt,Bt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(n){let o=typeof n=="function"?r(this,n):null;this._nativeConstantSourceNode.onended=o;let u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===o?n:u}start(n=0){if(this._nativeConstantSourceNode.start(n),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=n),this.context.state!=="closed"){On(this);let o=()=>{this._nativeConstantSourceNode.removeEventListener("ended",o),ke(this)&&us(this)};this._nativeConstantSourceNode.addEventListener("ended",o)}}stop(n=0){this._nativeConstantSourceNode.stop(n),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=n)}},Cl=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=null,s=null,n=async(o,u,h)=>{let f=e(o),p=Rt(f,u);if(!p){let d={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,offset:f.offset.value};f=t(u,d),r!==null&&f.start(r),s!==null&&f.stop(s)}return l.set(u,f),p?await a(u,o.offset,f.offset,h):await i(u,o.offset,f.offset,h),await c(o,u,f,h),f};return{set start(o){r=o},set stop(o){s=o},render(o,u,h){let f=l.get(u);return f!==void 0?Promise.resolve(f):n(o,u,h)}}},El=a=>t=>(a[0]=t,a[0]),Dl={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ml=(a,t,e,i,c,l)=>class extends a{constructor(s,n){let o=i(s),u={...Dl,...n},h=e(o,u),p=c(o)?t():null;super(s,!1,h,p);this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&l(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(s){if(this._nativeConvolverNode.buffer=s,s===null&&this._nativeConvolverNode.buffer!==null){let n=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=n.createBuffer(1,1,44100),this._isBufferNullified=!0,l(this,0)}else this._isBufferNullified=!1,l(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(s){this._nativeConvolverNode.normalize=s}},Nl=(a,t,e)=>()=>{let i=new WeakMap,c=async(l,r,s)=>{let n=t(l);if(!Rt(n,r)){let u={buffer:n.buffer,channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,disableNormalization:!n.normalize};n=a(r,u)}return i.set(r,n),Tn(n)?await e(l,r,n.inputs[0],s):await e(l,r,n,s),n};return{render(l,r,s){let n=i.get(r);return n!==void 0?Promise.resolve(n):c(l,r,s)}}},Il=(a,t)=>(e,i,c)=>{if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(e,i,c)}catch(l){throw l.name==="SyntaxError"?a():l}},Pl=()=>new DOMException("","DataCloneError"),jl=a=>{let{port1:t}=new MessageChannel;t.postMessage(a,[a])},Rl=(a,t,e,i,c,l,r,s,n,o,u)=>(h,f)=>{let p=r(h)?h:l(h);if(c.has(f)){let d=e();return Promise.reject(d)}try{c.add(f)}catch{}return t(n,()=>n(p))?p.decodeAudioData(f).then(d=>(t(s,()=>s(d))||u(d),a.add(d),d)):new Promise((d,_)=>{let y=()=>{try{jl(f)}catch{}},m=b=>{_(b),y()};try{p.decodeAudioData(f,b=>{typeof b.copyFromChannel!="function"&&(o(b),er(b)),a.add(b),y(),d(b)},b=>{m(b===null?i():b)})}catch(b){m(b)}})},Fl=(a,t,e,i,c,l,r,s)=>(n,o)=>{let u=t.get(n);if(u===void 0)throw new Error("Missing the expected cycle count.");let h=l(n.context),f=s(h);if(u===o){if(t.delete(n),!f&&r(n)){let p=i(n),{outputs:d}=e(n);for(let _ of d)if(hs(_)){let y=i(_[0]);a(p,y,_[1],_[2])}else{let y=c(_[0]);p.connect(y,_[1])}}}else t.set(n,u-o)},ql={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Vl=(a,t,e,i,c,l,r)=>class extends a{constructor(n,o){let u=c(n),h={...ql,...o},f=i(u,h),p=l(u),d=p?e(h.maxDelayTime):null;super(n,!1,f,d);this._delayTime=t(this,p,f.delayTime),r(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},Wl=(a,t,e,i,c)=>l=>{let r=new WeakMap,s=async(n,o,u)=>{let h=e(n),f=Rt(h,o);if(!f){let p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:l};h=t(o,p)}return r.set(o,h),f?await a(o,n.delayTime,h.delayTime,u):await i(o,n.delayTime,h.delayTime,u),await c(n,o,h,u),h};return{render(n,o,u){let h=r.get(o);return h!==void 0?Promise.resolve(h):s(n,o,u)}}},Ll=a=>(t,e,i,c)=>a(t[c],l=>l[0]===e&&l[1]===i),Bl=a=>(t,e)=>{a(t).delete(e)},zl=a=>"delayTime"in a,Ul=(a,t,e)=>function i(c,l){let r=Gs(l)?l:e(a,l);if(zl(r))return[];if(c[0]===r)return[c];if(c.includes(r))return[];let{outputs:s}=t(r);return Array.from(s).map(n=>i([...c,r],n[0])).reduce((n,o)=>n.concat(o),[])},Js=(a,t,e)=>{let i=t[e];if(i===void 0)throw a();return i},Gl=a=>(t,e=void 0,i=void 0,c=0)=>e===void 0?t.forEach(l=>l.disconnect()):typeof e=="number"?Js(a,t,e).disconnect():Zs(e)?i===void 0?t.forEach(l=>l.disconnect(e)):c===void 0?Js(a,t,i).disconnect(e,0):Js(a,t,i).disconnect(e,0,c):i===void 0?t.forEach(l=>l.disconnect(e)):Js(a,t,i).disconnect(e,0),Yl={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ql=(a,t,e,i,c,l,r,s)=>class extends a{constructor(o,u){let h=l(o),f={...Yl,...u},p=i(h,f),d=r(h),_=d?e():null;super(o,!1,p,_);this._attack=t(this,d,p.attack),this._knee=t(this,d,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=t(this,d,p.ratio),this._release=t(this,d,p.release),this._threshold=t(this,d,p.threshold),s(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(o){let u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=o,o>2)throw this._nativeDynamicsCompressorNode.channelCount=u,c()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(o){let u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=o,o==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,c()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Hl=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=async(s,n,o)=>{let u=e(s),h=Rt(u,n);if(!h){let f={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=t(n,f)}return l.set(n,u),h?(await a(n,s.attack,u.attack,o),await a(n,s.knee,u.knee,o),await a(n,s.ratio,u.ratio,o),await a(n,s.release,u.release,o),await a(n,s.threshold,u.threshold,o)):(await i(n,s.attack,u.attack,o),await i(n,s.knee,u.knee,o),await i(n,s.ratio,u.ratio,o),await i(n,s.release,u.release,o),await i(n,s.threshold,u.threshold,o)),await c(s,n,u,o),u};return{render(s,n,o){let u=l.get(n);return u!==void 0?Promise.resolve(u):r(s,n,o)}}},Zl=()=>new DOMException("","EncodingError"),Xl=a=>t=>new Promise((e,i)=>{if(a===null){i(new SyntaxError);return}let c=a.document.head;if(c===null)i(new SyntaxError);else{let l=a.document.createElement("script"),r=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(r),n=a.onerror,o=()=>{a.onerror=n,URL.revokeObjectURL(s)};a.onerror=(u,h,f,p,d)=>{if(h===s||h===a.location.href&&f===1&&p===1)return o(),i(d),!1;if(n!==null)return n(u,h,f,p,d)},l.onerror=()=>{o(),i(new SyntaxError)},l.onload=()=>{o(),e()},l.src=s,l.type="module",c.appendChild(l)}}),Kl=a=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,i,c){if(i!==null){let l=this._listeners.get(i);l===void 0&&(l=a(this,i),typeof i=="function"&&this._listeners.set(i,l)),this._nativeEventTarget.addEventListener(e,l,c)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,i,c){let l=i===null?void 0:this._listeners.get(i);this._nativeEventTarget.removeEventListener(e,l===void 0?null:l,c)}},Jl=a=>(t,e,i)=>{Object.defineProperties(a,{currentFrame:{configurable:!0,get(){return Math.round(t*e)}},currentTime:{configurable:!0,get(){return t}}});try{return i()}finally{a!==null&&(delete a.currentFrame,delete a.currentTime)}},$l=a=>async t=>{try{let e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw a()},th={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},eh=(a,t,e,i,c,l)=>class extends a{constructor(s,n){let o=c(s),u={...th,...n},h=i(o,u),f=l(o),p=f?e():null;super(s,!1,h,p);this._gain=t(this,f,h.gain,Vt,Bt)}get gain(){return this._gain}},nh=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=async(s,n,o)=>{let u=e(s),h=Rt(u,n);if(!h){let f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=t(n,f)}return l.set(n,u),h?await a(n,s.gain,u.gain,o):await i(n,s.gain,u.gain,o),await c(s,n,u,o),u};return{render(s,n,o){let u=l.get(n);return u!==void 0?Promise.resolve(u):r(s,n,o)}}},sh=(a,t)=>e=>t(a,e),ih=a=>t=>{let e=a(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer},rh=a=>t=>{var e;return(e=a.get(t))!==null&&e!==void 0?e:0},oh=a=>t=>{let e=a(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer},ah=a=>t=>a.get(t),Tt=()=>new DOMException("","InvalidStateError"),ch=a=>t=>{let e=a.get(t);if(e===void 0)throw Tt();return e},uh=(a,t)=>e=>{let i=a.get(e);if(i!==void 0)return i;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new t(1,1,8e3),a.set(e,i),i},lh=a=>t=>{let e=a.get(t);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e},$s=()=>new DOMException("","InvalidAccessError"),hh=a=>{a.getFrequencyResponse=(t=>(e,i,c)=>{if(e.length!==i.length||i.length!==c.length)throw $s();return t.call(a,e,i,c)})(a.getFrequencyResponse)},fh={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},ph=(a,t,e,i,c,l)=>class extends a{constructor(s,n){let o=i(s),u=c(o),h={...fh,...n},f=t(o,u?null:s.baseLatency,h),p=u?e(h.feedback,h.feedforward):null;super(s,!1,f,p);hh(f),this._nativeIIRFilterNode=f,l(this,1)}getFrequencyResponse(s,n,o){return this._nativeIIRFilterNode.getFrequencyResponse(s,n,o)}},Mo=(a,t,e,i,c,l,r,s,n,o,u)=>{let h=o.length,f=s;for(let p=0;p<h;p+=1){let d=e[0]*o[p];for(let _=1;_<c;_+=1){let y=f-_&n-1;d+=e[_]*l[y],d-=a[_]*r[y]}for(let _=c;_<i;_+=1)d+=e[_]*l[f-_&n-1];for(let _=c;_<t;_+=1)d-=a[_]*r[f-_&n-1];l[f]=o[p],r[f]=d,f=f+1&n-1,u[p]=d}return f},dh=(a,t,e,i)=>{let c=e instanceof Float64Array?e:new Float64Array(e),l=i instanceof Float64Array?i:new Float64Array(i),r=c.length,s=l.length,n=Math.min(r,s);if(c[0]!==1){for(let d=0;d<r;d+=1)l[d]/=c[0];for(let d=1;d<s;d+=1)c[d]/=c[0]}let o=32,u=new Float32Array(o),h=new Float32Array(o),f=t.createBuffer(a.numberOfChannels,a.length,a.sampleRate),p=a.numberOfChannels;for(let d=0;d<p;d+=1){let _=a.getChannelData(d),y=f.getChannelData(d);u.fill(0),h.fill(0),Mo(c,r,l,s,n,u,h,0,o,_,y)}return f},_h=(a,t,e,i,c)=>(l,r)=>{let s=new WeakMap,n=null,o=async(u,h,f)=>{let p=null,d=t(u),_=Rt(d,h);if(h.createIIRFilter===void 0?p=a(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):_||(d=h.createIIRFilter(r,l)),s.set(h,p===null?d:p),p!==null){if(n===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");let m=new e(u.context.destination.channelCount,u.context.length,h.sampleRate);n=(async()=>{await i(u,m,m.destination,f);let b=await c(m);return dh(b,h,l,r)})()}let y=await n;return p.buffer=y,p.start(0),p}return await i(u,h,d,f),d};return{render(u,h,f){let p=s.get(h);return p!==void 0?Promise.resolve(p):o(u,h,f)}}},mh=(a,t,e,i,c,l)=>r=>(s,n)=>{let o=a.get(s);if(o===void 0){if(!r&&l(s)){let u=i(s),{outputs:h}=e(s);for(let f of h)if(hs(f)){let p=i(f[0]);t(u,p,f[1],f[2])}else{let p=c(f[0]);u.disconnect(p,f[1])}}a.set(s,n)}else a.set(s,o+n)},yh=(a,t)=>e=>{let i=a.get(e);return t(i)||t(e)},gh=(a,t)=>e=>a.has(e)||t(e),bh=(a,t)=>e=>a.has(e)||t(e),vh=(a,t)=>e=>{let i=a.get(e);return t(i)||t(e)},wh=a=>t=>a!==null&&t instanceof a,Sh=a=>t=>a!==null&&typeof a.AudioNode=="function"&&t instanceof a.AudioNode,xh=a=>t=>a!==null&&typeof a.AudioParam=="function"&&t instanceof a.AudioParam,Oh=(a,t)=>e=>a(e)||t(e),Th=a=>t=>a!==null&&t instanceof a,kh=a=>a!==null&&a.isSecureContext;var Ah=(a,t,e,i)=>class extends a{constructor(l,r){let s=e(l),n=t(s,r);if(i(s))throw TypeError();super(l,!0,n,null);this._nativeMediaElementAudioSourceNode=n}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},Ch={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Eh=(a,t,e,i)=>class extends a{constructor(l,r){let s=e(l);if(i(s))throw new TypeError;let n={...Ch,...r},o=t(s,n);super(l,!1,o,null);this._nativeMediaStreamAudioDestinationNode=o}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Dh=(a,t,e,i)=>class extends a{constructor(l,r){let s=e(l),n=t(s,r);if(i(s))throw new TypeError;super(l,!0,n,null);this._nativeMediaStreamAudioSourceNode=n}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Mh=(a,t,e)=>class extends a{constructor(c,l){let r=e(c),s=t(r,l);super(c,!0,s,null)}},Nh=(a,t,e,i,c,l)=>class extends e{constructor(s,n){super(s);this._nativeContext=s,Bs.set(this,s),i(s)&&c.set(s,new Set),this._destination=new a(this,n),this._listener=t(this,s),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(s){let n=typeof s=="function"?l(this,s):null;this._nativeContext.onstatechange=n;let o=this._nativeContext.onstatechange;this._onstatechange=o!==null&&o===n?s:o}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},ps=a=>{let t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let e=a.decodeAudioData(t.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch{}return!1},Ih=(a,t)=>(e,i,c)=>{let l=new Set;return e.connect=(r=>(s,n=0,o=0)=>{let u=l.size===0;if(t(s))return r.call(e,s,n,o),a(l,[s,n,o],h=>h[0]===s&&h[1]===n&&h[2]===o,!0),u&&i(),s;r.call(e,s,n),a(l,[s,n],h=>h[0]===s&&h[1]===n,!0),u&&i()})(e.connect),e.disconnect=(r=>(s,n,o)=>{let u=l.size>0;if(s===void 0)r.apply(e),l.clear();else if(typeof s=="number"){r.call(e,s);for(let f of l)f[1]===s&&l.delete(f)}else{t(s)?r.call(e,s,n,o):r.call(e,s,n);for(let f of l)f[0]===s&&(n===void 0||f[1]===n)&&(o===void 0||f[2]===o)&&l.delete(f)}let h=l.size===0;u&&h&&c()})(e.disconnect),e},it=(a,t,e)=>{let i=t[e];i!==void 0&&i!==a[e]&&(a[e]=i)},xt=(a,t)=>{it(a,t,"channelCount"),it(a,t,"channelCountMode"),it(a,t,"channelInterpretation")},No=a=>typeof a.getFloatTimeDomainData=="function",Ph=a=>{a.getFloatTimeDomainData=t=>{let e=new Uint8Array(t.length);a.getByteTimeDomainData(e);let i=Math.max(e.length,a.fftSize);for(let c=0;c<i;c+=1)t[c]=(e[c]-128)*.0078125;return t}},jh=(a,t)=>(e,i)=>{let c=e.createAnalyser();if(xt(c,i),!(i.maxDecibels>i.minDecibels))throw t();return it(c,i,"fftSize"),it(c,i,"maxDecibels"),it(c,i,"minDecibels"),it(c,i,"smoothingTimeConstant"),a(No,()=>No(c))||Ph(c),c},Rh=a=>a===null?null:a.hasOwnProperty("AudioBuffer")?a.AudioBuffer:null,ut=(a,t,e)=>{let i=t[e];i!==void 0&&i!==a[e].value&&(a[e].value=i)},Fh=a=>{a.start=(t=>{let e=!1;return(i=0,c=0,l)=>{if(e)throw Tt();t.call(a,i,c,l),e=!0}})(a.start)},ar=a=>{a.start=(t=>(e=0,i=0,c)=>{if(typeof c=="number"&&c<0||i<0||e<0)throw new RangeError("The parameters can't be negative.");t.call(a,e,i,c)})(a.start)},cr=a=>{a.stop=(t=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");t.call(a,e)})(a.stop)},qh=(a,t,e,i,c,l,r,s,n,o,u)=>(h,f)=>{let p=h.createBufferSource();return xt(p,f),ut(p,f,"playbackRate"),it(p,f,"buffer"),it(p,f,"loop"),it(p,f,"loopEnd"),it(p,f,"loopStart"),t(e,()=>e(h))||Fh(p),t(i,()=>i(h))||n(p),t(c,()=>c(h))||o(p,h),t(l,()=>l(h))||ar(p),t(r,()=>r(h))||u(p,h),t(s,()=>s(h))||cr(p),a(h,p),p},Vh=a=>a===null?null:a.hasOwnProperty("AudioContext")?a.AudioContext:a.hasOwnProperty("webkitAudioContext")?a.webkitAudioContext:null,Wh=(a,t)=>(e,i,c)=>{let l=e.destination;if(l.channelCount!==i)try{l.channelCount=i}catch{}c&&l.channelCountMode!=="explicit"&&(l.channelCountMode="explicit"),l.maxChannelCount===0&&Object.defineProperty(l,"maxChannelCount",{value:i});let r=a(e,{channelCount:i,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:1});return t(r,"channelCount",s=>()=>s.call(r),s=>n=>{s.call(r,n);try{l.channelCount=n}catch(o){if(n>l.maxChannelCount)throw o}}),t(r,"channelCountMode",s=>()=>s.call(r),s=>n=>{s.call(r,n),l.channelCountMode=n}),t(r,"channelInterpretation",s=>()=>s.call(r),s=>n=>{s.call(r,n),l.channelInterpretation=n}),Object.defineProperty(r,"maxChannelCount",{get:()=>l.maxChannelCount}),r.connect(l),r},Lh=a=>a===null?null:a.hasOwnProperty("AudioWorkletNode")?a.AudioWorkletNode:null,Bh=a=>{let{port1:t}=new MessageChannel;try{t.postMessage(a)}finally{t.close()}},zh=(a,t,e,i,c)=>(l,r,s,n,o,u)=>{if(s!==null)try{let h=new s(l,n,u),f=new Map,p=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw a()}},channelCountMode:{get:()=>"explicit",set:()=>{throw a()}},onprocessorerror:{get:()=>p,set:d=>{typeof p=="function"&&h.removeEventListener("processorerror",p),p=typeof d=="function"?d:null,typeof p=="function"&&h.addEventListener("processorerror",p)}}}),h.addEventListener=(d=>(..._)=>{if(_[0]==="processorerror"){let y=typeof _[1]=="function"?_[1]:typeof _[1]=="object"&&_[1]!==null&&typeof _[1].handleEvent=="function"?_[1].handleEvent:null;if(y!==null){let m=f.get(_[1]);m!==void 0?_[1]=m:(_[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),y(b)):y(new ErrorEvent(_[0],{...b}))},f.set(y,_[1]))}}return d.call(h,"error",_[1],_[2]),d.call(h,..._)})(h.addEventListener),h.removeEventListener=(d=>(..._)=>{if(_[0]==="processorerror"){let y=f.get(_[1]);y!==void 0&&(f.delete(_[1]),_[1]=y)}return d.call(h,"error",_[1],_[2]),d.call(h,_[0],_[1],_[2])})(h.removeEventListener),u.numberOfOutputs!==0){let d=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(d).connect(l.destination),c(h,()=>d.disconnect(),()=>d.connect(l.destination))}return h}catch(h){throw h.code===11?i():h}if(o===void 0)throw i();return Bh(u),t(l,r,o,u)},Io=(a,t)=>a===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(a*t))))),Uh=a=>new Promise((t,e)=>{let{port1:i,port2:c}=new MessageChannel;i.onmessage=({data:l})=>{i.close(),c.close(),t(l)},i.onmessageerror=({data:l})=>{i.close(),c.close(),e(l)},c.postMessage(a)}),Gh=async(a,t)=>{let e=await Uh(t);return new a(e)},Yh=(a,t,e,i)=>{let c=$i.get(a);c===void 0&&(c=new WeakMap,$i.set(a,c));let l=Gh(e,i);return c.set(t,l),l},Qh=(a,t,e,i,c,l,r,s,n,o,u,h,f)=>(p,d,_,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw n();let m=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(m.some(I=>I<1))throw n();if(m.length!==y.numberOfOutputs)throw t();if(y.channelCountMode!=="explicit")throw n();let b=y.channelCount*y.numberOfInputs,k=m.reduce((I,q)=>I+q,0),x=_.parameterDescriptors===void 0?0:_.parameterDescriptors.length;if(b+x>6||k>6)throw n();let g=new MessageChannel,A=[],T=[];for(let I=0;I<y.numberOfInputs;I+=1)A.push(r(p,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),T.push(c(p,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));let O=[];if(_.parameterDescriptors!==void 0)for(let{defaultValue:I,maxValue:q,minValue:vt,name:ot}of _.parameterDescriptors){let Q=l(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[ot]!==void 0?y.parameterData[ot]:I===void 0?0:I});Object.defineProperties(Q.offset,{defaultValue:{get:()=>I===void 0?0:I},maxValue:{get:()=>q===void 0?Vt:q},minValue:{get:()=>vt===void 0?Bt:vt}}),O.push(Q)}let w=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+x)}),M=Io(d,p.sampleRate),D=s(p,M,b+x,Math.max(1,k)),C=c(p,{channelCount:Math.max(1,k),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,k)}),E=[];for(let I=0;I<y.numberOfOutputs;I+=1)E.push(i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:m[I]}));for(let I=0;I<y.numberOfInputs;I+=1){A[I].connect(T[I]);for(let q=0;q<y.channelCount;q+=1)T[I].connect(w,q,I*y.channelCount+q)}let F=new or(_.parameterDescriptors===void 0?[]:_.parameterDescriptors.map(({name:I},q)=>{let vt=O[q];return vt.connect(w,0,b+q),vt.start(0),[I,vt.offset]}));w.connect(D);let W=y.channelInterpretation,L=null,V=y.numberOfOutputs===0?[D]:E,Y={get bufferSize(){return M},get channelCount(){return y.channelCount},set channelCount(I){throw e()},get channelCountMode(){return y.channelCountMode},set channelCountMode(I){throw e()},get channelInterpretation(){return W},set channelInterpretation(I){for(let q of A)q.channelInterpretation=I;W=I},get context(){return D.context},get inputs(){return A},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return L},set onprocessorerror(I){typeof L=="function"&&Y.removeEventListener("processorerror",L),L=typeof I=="function"?I:null,typeof L=="function"&&Y.addEventListener("processorerror",L)},get parameters(){return F},get port(){return g.port2},addEventListener(...I){return D.addEventListener(I[0],I[1],I[2])},connect:a.bind(null,V),disconnect:o.bind(null,V),dispatchEvent(...I){return D.dispatchEvent(I[0])},removeEventListener(...I){return D.removeEventListener(I[0],I[1],I[2])}},gt=new Map;g.port1.addEventListener=(I=>(...q)=>{if(q[0]==="message"){let vt=typeof q[1]=="function"?q[1]:typeof q[1]=="object"&&q[1]!==null&&typeof q[1].handleEvent=="function"?q[1].handleEvent:null;if(vt!==null){let ot=gt.get(q[1]);ot!==void 0?q[1]=ot:(q[1]=Q=>{u(p.currentTime,p.sampleRate,()=>vt(Q))},gt.set(vt,q[1]))}}return I.call(g.port1,q[0],q[1],q[2])})(g.port1.addEventListener),g.port1.removeEventListener=(I=>(...q)=>{if(q[0]==="message"){let vt=gt.get(q[1]);vt!==void 0&&(gt.delete(q[1]),q[1]=vt)}return I.call(g.port1,q[0],q[1],q[2])})(g.port1.removeEventListener);let tt=null;Object.defineProperty(g.port1,"onmessage",{get:()=>tt,set:I=>{typeof tt=="function"&&g.port1.removeEventListener("message",tt),tt=typeof I=="function"?I:null,typeof tt=="function"&&(g.port1.addEventListener("message",tt),g.port1.start())}}),_.prototype.port=g.port1;let Nt=null;Yh(p,Y,_,y).then(I=>Nt=I);let U=Ks(y.numberOfInputs,y.channelCount),he=Ks(y.numberOfOutputs,m),yn=_.parameterDescriptors===void 0?[]:_.parameterDescriptors.reduce((I,{name:q})=>({...I,[q]:new Float32Array(128)}),{}),j=!0,rt=()=>{y.numberOfOutputs>0&&D.disconnect(C);for(let I=0,q=0;I<y.numberOfOutputs;I+=1){let vt=E[I];for(let ot=0;ot<m[I];ot+=1)C.disconnect(vt,q+ot,ot);q+=m[I]}},bt=new Map;D.onaudioprocess=({inputBuffer:I,outputBuffer:q})=>{if(Nt!==null){let vt=h(Y);for(let ot=0;ot<M;ot+=128){for(let Q=0;Q<y.numberOfInputs;Q+=1)for(let ct=0;ct<y.channelCount;ct+=1)Xs(I,U[Q],ct,ct,ot);_.parameterDescriptors!==void 0&&_.parameterDescriptors.forEach(({name:Q},ct)=>{Xs(I,yn,Q,b+ct,ot)});for(let Q=0;Q<y.numberOfInputs;Q+=1)for(let ct=0;ct<m[Q];ct+=1)he[Q][ct].byteLength===0&&(he[Q][ct]=new Float32Array(128));try{let Q=U.map((Ht,Ie)=>{if(vt[Ie].size>0)return bt.set(Ie,M/128),Ht;let Ii=bt.get(Ie);return Ii===void 0?[]:(Ht.every(Kc=>Kc.every(Jc=>Jc===0))&&(Ii===1?bt.delete(Ie):bt.set(Ie,Ii-1)),Ht)});j=u(p.currentTime+ot/p.sampleRate,p.sampleRate,()=>Nt.process(Q,he,yn));for(let Ht=0,Ie=0;Ht<y.numberOfOutputs;Ht+=1){for(let is=0;is<m[Ht];is+=1)Do(q,he[Ht],is,Ie+is,ot);Ie+=m[Ht]}}catch(Q){j=!1,Y.dispatchEvent(new ErrorEvent("processorerror",{colno:Q.colno,filename:Q.filename,lineno:Q.lineno,message:Q.message}))}if(!j){for(let Q=0;Q<y.numberOfInputs;Q+=1){A[Q].disconnect(T[Q]);for(let ct=0;ct<y.channelCount;ct+=1)T[ot].disconnect(w,ct,Q*y.channelCount+ct)}if(_.parameterDescriptors!==void 0){let Q=_.parameterDescriptors.length;for(let ct=0;ct<Q;ct+=1){let Ht=O[ct];Ht.disconnect(w,0,b+ct),Ht.stop()}}w.disconnect(D),D.onaudioprocess=null,Ze?rt():Yr();break}}}};let Ze=!1,Xe=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Gr=()=>D.connect(Xe).connect(p.destination),Yr=()=>{D.disconnect(Xe),Xe.disconnect()},Zc=()=>{if(j){Yr(),y.numberOfOutputs>0&&D.connect(C);for(let I=0,q=0;I<y.numberOfOutputs;I+=1){let vt=E[I];for(let ot=0;ot<m[I];ot+=1)C.connect(vt,q+ot,ot);q+=m[I]}}Ze=!0},Xc=()=>{j&&(Gr(),rt()),Ze=!1};return Gr(),f(Y,Zc,Xc)},Po=(a,t)=>{let e=a.createBiquadFilter();return xt(e,t),ut(e,t,"Q"),ut(e,t,"detune"),ut(e,t,"frequency"),ut(e,t,"gain"),it(e,t,"type"),e},Hh=(a,t)=>(e,i)=>{let c=e.createChannelMerger(i.numberOfInputs);return a!==null&&a.name==="webkitAudioContext"&&t(e,c),xt(c,i),c},Zh=a=>{let t=a.numberOfOutputs;Object.defineProperty(a,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Tt()}}),Object.defineProperty(a,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw Tt()}}),Object.defineProperty(a,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw Tt()}})},ds=(a,t)=>{let e=a.createChannelSplitter(t.numberOfOutputs);return xt(e,t),Zh(e),e},Xh=(a,t,e,i,c)=>(l,r)=>{if(l.createConstantSource===void 0)return e(l,r);let s=l.createConstantSource();return xt(s,r),ut(s,r,"offset"),t(i,()=>i(l))||ar(s),t(c,()=>c(l))||cr(s),a(l,s),s},kn=(a,t)=>(a.connect=t.connect.bind(t),a.disconnect=t.disconnect.bind(t),a),Kh=(a,t,e,i)=>(c,{offset:l,...r})=>{let s=c.createBuffer(1,2,44100),n=t(c,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=e(c,{...r,gain:l}),u=s.getChannelData(0);u[0]=1,u[1]=1,n.buffer=s,n.loop=!0;let h={get bufferSize(){},get channelCount(){return o.channelCount},set channelCount(d){o.channelCount=d},get channelCountMode(){return o.channelCountMode},set channelCountMode(d){o.channelCountMode=d},get channelInterpretation(){return o.channelInterpretation},set channelInterpretation(d){o.channelInterpretation=d},get context(){return o.context},get inputs(){return[]},get numberOfInputs(){return n.numberOfInputs},get numberOfOutputs(){return o.numberOfOutputs},get offset(){return o.gain},get onended(){return n.onended},set onended(d){n.onended=d},addEventListener(...d){return n.addEventListener(d[0],d[1],d[2])},dispatchEvent(...d){return n.dispatchEvent(d[0])},removeEventListener(...d){return n.removeEventListener(d[0],d[1],d[2])},start(d=0){n.start.call(n,d)},stop(d=0){n.stop.call(n,d)}},f=()=>n.connect(o),p=()=>n.disconnect(o);return a(c,n),i(kn(h,o),f,p)},Jh=(a,t)=>(e,i)=>{let c=e.createConvolver();if(xt(c,i),i.disableNormalization===c.normalize&&(c.normalize=!i.disableNormalization),it(c,i,"buffer"),i.channelCount>2||(t(c,"channelCount",l=>()=>l.call(c),l=>r=>{if(r>2)throw a();return l.call(c,r)}),i.channelCountMode==="max"))throw a();return t(c,"channelCountMode",l=>()=>l.call(c),l=>r=>{if(r==="max")throw a();return l.call(c,r)}),c},jo=(a,t)=>{let e=a.createDelay(t.maxDelayTime);return xt(e,t),ut(e,t,"delayTime"),e},$h=a=>(t,e)=>{let i=t.createDynamicsCompressor();if(xt(i,e),e.channelCount>2||e.channelCountMode==="max")throw a();return ut(i,e,"attack"),ut(i,e,"knee"),ut(i,e,"ratio"),ut(i,e,"release"),ut(i,e,"threshold"),i},zt=(a,t)=>{let e=a.createGain();return xt(e,t),ut(e,t,"gain"),e},tf=a=>(t,e,i)=>{if(t.createIIRFilter===void 0)return a(t,e,i);let c=t.createIIRFilter(i.feedforward,i.feedback);return xt(c,i),c};function ef(a,t){let e=t[0]*t[0]+t[1]*t[1];return[(a[0]*t[0]+a[1]*t[1])/e,(a[1]*t[0]-a[0]*t[1])/e]}function nf(a,t){return[a[0]*t[0]-a[1]*t[1],a[0]*t[1]+a[1]*t[0]]}function Ro(a,t){let e=[0,0];for(let i=a.length-1;i>=0;i-=1)e=nf(e,t),e[0]+=a[i];return e}var sf=(a,t,e,i)=>(c,l,{channelCount:r,channelCountMode:s,channelInterpretation:n,feedback:o,feedforward:u})=>{let h=Io(l,c.sampleRate),f=o instanceof Float64Array?o:new Float64Array(o),p=u instanceof Float64Array?u:new Float64Array(u),d=f.length,_=p.length,y=Math.min(d,_);if(d===0||d>20)throw i();if(f[0]===0)throw t();if(_===0||_>20)throw i();if(p[0]===0)throw t();if(f[0]!==1){for(let O=0;O<_;O+=1)p[O]/=f[0];for(let O=1;O<d;O+=1)f[O]/=f[0]}let m=e(c,h,r,r);m.channelCount=r,m.channelCountMode=s,m.channelInterpretation=n;let b=32,k=[],x=[],g=[];for(let O=0;O<r;O+=1){k.push(0);let w=new Float32Array(b),M=new Float32Array(b);w.fill(0),M.fill(0),x.push(w),g.push(M)}m.onaudioprocess=O=>{let w=O.inputBuffer,M=O.outputBuffer,D=w.numberOfChannels;for(let C=0;C<D;C+=1){let E=w.getChannelData(C),F=M.getChannelData(C);k[C]=Mo(f,d,p,_,y,x[C],g[C],k[C],b,E,F)}};let A=c.sampleRate/2;return kn({get bufferSize(){return h},get channelCount(){return m.channelCount},set channelCount(O){m.channelCount=O},get channelCountMode(){return m.channelCountMode},set channelCountMode(O){m.channelCountMode=O},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(O){m.channelInterpretation=O},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},addEventListener(...O){return m.addEventListener(O[0],O[1],O[2])},dispatchEvent(...O){return m.dispatchEvent(O[0])},getFrequencyResponse(O,w,M){if(O.length!==w.length||w.length!==M.length)throw a();let D=O.length;for(let C=0;C<D;C+=1){let E=-Math.PI*(O[C]/A),F=[Math.cos(E),Math.sin(E)],W=Ro(p,F),L=Ro(f,F),V=ef(W,L);w[C]=Math.sqrt(V[0]*V[0]+V[1]*V[1]),M[C]=Math.atan2(V[1],V[0])}},removeEventListener(...O){return m.removeEventListener(O[0],O[1],O[2])}},m)},rf=(a,t)=>a.createMediaElementSource(t.mediaElement),of=(a,t)=>{let e=a.createMediaStreamDestination();return xt(e,t),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e},af=(a,{mediaStream:t})=>{let e=t.getAudioTracks();e.sort((l,r)=>l.id<r.id?-1:l.id>r.id?1:0);let i=e.slice(0,1),c=a.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(c,"mediaStream",{value:t}),c},cf=(a,t)=>(e,{mediaStreamTrack:i})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(i);let c=new MediaStream([i]),l=e.createMediaStreamSource(c);if(i.kind!=="audio")throw a();if(t(e))throw new TypeError;return l},uf=a=>a===null?null:a.hasOwnProperty("OfflineAudioContext")?a.OfflineAudioContext:a.hasOwnProperty("webkitOfflineAudioContext")?a.webkitOfflineAudioContext:null,lf=(a,t,e,i,c,l)=>(r,s)=>{let n=r.createOscillator();return xt(n,s),ut(n,s,"detune"),ut(n,s,"frequency"),s.periodicWave!==void 0?n.setPeriodicWave(s.periodicWave):it(n,s,"type"),t(e,()=>e(r))||ar(n),t(i,()=>i(r))||l(n,r),t(c,()=>c(r))||cr(n),a(r,n),n},hf=a=>(t,e)=>{let i=t.createPanner();return i.orientationX===void 0?a(t,e):(xt(i,e),ut(i,e,"orientationX"),ut(i,e,"orientationY"),ut(i,e,"orientationZ"),ut(i,e,"positionX"),ut(i,e,"positionY"),ut(i,e,"positionZ"),it(i,e,"coneInnerAngle"),it(i,e,"coneOuterAngle"),it(i,e,"coneOuterGain"),it(i,e,"distanceModel"),it(i,e,"maxDistance"),it(i,e,"panningModel"),it(i,e,"refDistance"),it(i,e,"rolloffFactor"),i)},ff=(a,t,e,i,c,l,r,s,n)=>(o,{coneInnerAngle:u,coneOuterAngle:h,coneOuterGain:f,distanceModel:p,maxDistance:d,orientationX:_,orientationY:y,orientationZ:m,panningModel:b,positionX:k,positionY:x,positionZ:g,refDistance:A,rolloffFactor:T,...O})=>{let w=o.createPanner();if(O.channelCount>2||O.channelCountMode==="max")throw r();xt(w,O);let M={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},D=e(o,{...M,channelInterpretation:"speakers",numberOfInputs:6}),C=i(o,{...O,gain:1}),E=i(o,{...M,gain:1}),F=i(o,{...M,gain:0}),W=i(o,{...M,gain:0}),L=i(o,{...M,gain:0}),V=i(o,{...M,gain:0}),Y=i(o,{...M,gain:0}),gt=c(o,256,6,1),tt=l(o,{...M,curve:new Float32Array([1,1]),oversample:"none"}),Nt=[_,y,m],It=[k,x,g];gt.onaudioprocess=({inputBuffer:j})=>{let rt=[j.getChannelData(0)[0],j.getChannelData(1)[0],j.getChannelData(2)[0]];rt.some((Ze,Xe)=>Ze!==Nt[Xe])&&(w.setOrientation(...rt),Nt=rt);let bt=[j.getChannelData(3)[0],j.getChannelData(4)[0],j.getChannelData(5)[0]];bt.some((Ze,Xe)=>Ze!==It[Xe])&&(w.setPosition(...bt),It=bt)},Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0});let U={get bufferSize(){},get channelCount(){return w.channelCount},set channelCount(j){if(j>2)throw r();C.channelCount=j,w.channelCount=j},get channelCountMode(){return w.channelCountMode},set channelCountMode(j){if(j==="max")throw r();C.channelCountMode=j,w.channelCountMode=j},get channelInterpretation(){return w.channelInterpretation},set channelInterpretation(j){C.channelInterpretation=j,w.channelInterpretation=j},get coneInnerAngle(){return w.coneInnerAngle},set coneInnerAngle(j){w.coneInnerAngle=j},get coneOuterAngle(){return w.coneOuterAngle},set coneOuterAngle(j){w.coneOuterAngle=j},get coneOuterGain(){return w.coneOuterGain},set coneOuterGain(j){if(j<0||j>1)throw t();w.coneOuterGain=j},get context(){return w.context},get distanceModel(){return w.distanceModel},set distanceModel(j){w.distanceModel=j},get inputs(){return[C]},get maxDistance(){return w.maxDistance},set maxDistance(j){if(j<0)throw new RangeError;w.maxDistance=j},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return F.gain},get orientationZ(){return W.gain},get panningModel(){return w.panningModel},set panningModel(j){w.panningModel=j},get positionX(){return L.gain},get positionY(){return V.gain},get positionZ(){return Y.gain},get refDistance(){return w.refDistance},set refDistance(j){if(j<0)throw new RangeError;w.refDistance=j},get rolloffFactor(){return w.rolloffFactor},set rolloffFactor(j){if(j<0)throw new RangeError;w.rolloffFactor=j},addEventListener(...j){return C.addEventListener(j[0],j[1],j[2])},dispatchEvent(...j){return C.dispatchEvent(j[0])},removeEventListener(...j){return C.removeEventListener(j[0],j[1],j[2])}};u!==U.coneInnerAngle&&(U.coneInnerAngle=u),h!==U.coneOuterAngle&&(U.coneOuterAngle=h),f!==U.coneOuterGain&&(U.coneOuterGain=f),p!==U.distanceModel&&(U.distanceModel=p),d!==U.maxDistance&&(U.maxDistance=d),_!==U.orientationX.value&&(U.orientationX.value=_),y!==U.orientationY.value&&(U.orientationY.value=y),m!==U.orientationZ.value&&(U.orientationZ.value=m),b!==U.panningModel&&(U.panningModel=b),k!==U.positionX.value&&(U.positionX.value=k),x!==U.positionY.value&&(U.positionY.value=x),g!==U.positionZ.value&&(U.positionZ.value=g),A!==U.refDistance&&(U.refDistance=A),T!==U.rolloffFactor&&(U.rolloffFactor=T),(Nt[0]!==1||Nt[1]!==0||Nt[2]!==0)&&w.setOrientation(...Nt),(It[0]!==0||It[1]!==0||It[2]!==0)&&w.setPosition(...It);let he=()=>{C.connect(w),a(C,tt,0,0),tt.connect(E).connect(D,0,0),tt.connect(F).connect(D,0,1),tt.connect(W).connect(D,0,2),tt.connect(L).connect(D,0,3),tt.connect(V).connect(D,0,4),tt.connect(Y).connect(D,0,5),D.connect(gt).connect(o.destination)},yn=()=>{C.disconnect(w),s(C,tt,0,0),tt.disconnect(E),E.disconnect(D),tt.disconnect(F),F.disconnect(D),tt.disconnect(W),W.disconnect(D),tt.disconnect(L),L.disconnect(D),tt.disconnect(V),V.disconnect(D),tt.disconnect(Y),Y.disconnect(D),D.disconnect(gt),gt.disconnect(o.destination)};return n(kn(U,w),he,yn)},pf=a=>(t,{disableNormalization:e,imag:i,real:c})=>{let l=i instanceof Float32Array?i:new Float32Array(i),r=c instanceof Float32Array?c:new Float32Array(c),s=t.createPeriodicWave(r,l,{disableNormalization:e});if(Array.from(i).length<2)throw a();return s},_s=(a,t,e,i)=>a.createScriptProcessor(t,e,i),df=(a,t)=>(e,i)=>{let c=i.channelCountMode;if(c==="clamped-max")throw t();if(e.createStereoPanner===void 0)return a(e,i);let l=e.createStereoPanner();return xt(l,i),ut(l,i,"pan"),Object.defineProperty(l,"channelCountMode",{get:()=>c,set:r=>{if(r!==c)throw t()}}),l},_f=(a,t,e,i,c,l)=>{let r=16385,s=new Float32Array([1,1]),n=Math.PI/2,o={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...o,oversample:"none"},h=(d,_,y,m)=>{let b=new Float32Array(r),k=new Float32Array(r);for(let w=0;w<r;w+=1){let M=w/(r-1)*n;b[w]=Math.cos(M),k[w]=Math.sin(M)}let x=e(d,{...o,gain:0}),g=i(d,{...u,curve:b}),A=i(d,{...u,curve:s}),T=e(d,{...o,gain:0}),O=i(d,{...u,curve:k});return{connectGraph(){_.connect(x),_.connect(A.inputs===void 0?A:A.inputs[0]),_.connect(T),A.connect(y),y.connect(g.inputs===void 0?g:g.inputs[0]),y.connect(O.inputs===void 0?O:O.inputs[0]),g.connect(x.gain),O.connect(T.gain),x.connect(m,0,0),T.connect(m,0,1)},disconnectGraph(){_.disconnect(x),_.disconnect(A.inputs===void 0?A:A.inputs[0]),_.disconnect(T),A.disconnect(y),y.disconnect(g.inputs===void 0?g:g.inputs[0]),y.disconnect(O.inputs===void 0?O:O.inputs[0]),g.disconnect(x.gain),O.disconnect(T.gain),x.disconnect(m,0,0),T.disconnect(m,0,1)}}},f=(d,_,y,m)=>{let b=new Float32Array(r),k=new Float32Array(r),x=new Float32Array(r),g=new Float32Array(r),A=Math.floor(r/2);for(let V=0;V<r;V+=1)if(V>A){let Y=(V-A)/(r-1-A)*n;b[V]=Math.cos(Y),k[V]=Math.sin(Y),x[V]=0,g[V]=1}else{let Y=V/(r-1-A)*n;b[V]=1,k[V]=0,x[V]=Math.cos(Y),g[V]=Math.sin(Y)}let T=t(d,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),O=e(d,{...o,gain:0}),w=i(d,{...u,curve:b}),M=e(d,{...o,gain:0}),D=i(d,{...u,curve:k}),C=i(d,{...u,curve:s}),E=e(d,{...o,gain:0}),F=i(d,{...u,curve:x}),W=e(d,{...o,gain:0}),L=i(d,{...u,curve:g});return{connectGraph(){_.connect(T),_.connect(C.inputs===void 0?C:C.inputs[0]),T.connect(O,0),T.connect(M,0),T.connect(E,1),T.connect(W,1),C.connect(y),y.connect(w.inputs===void 0?w:w.inputs[0]),y.connect(D.inputs===void 0?D:D.inputs[0]),y.connect(F.inputs===void 0?F:F.inputs[0]),y.connect(L.inputs===void 0?L:L.inputs[0]),w.connect(O.gain),D.connect(M.gain),F.connect(E.gain),L.connect(W.gain),O.connect(m,0,0),E.connect(m,0,0),M.connect(m,0,1),W.connect(m,0,1)},disconnectGraph(){_.disconnect(T),_.disconnect(C.inputs===void 0?C:C.inputs[0]),T.disconnect(O,0),T.disconnect(M,0),T.disconnect(E,1),T.disconnect(W,1),C.disconnect(y),y.disconnect(w.inputs===void 0?w:w.inputs[0]),y.disconnect(D.inputs===void 0?D:D.inputs[0]),y.disconnect(F.inputs===void 0?F:F.inputs[0]),y.disconnect(L.inputs===void 0?L:L.inputs[0]),w.disconnect(O.gain),D.disconnect(M.gain),F.disconnect(E.gain),L.disconnect(W.gain),O.disconnect(m,0,0),E.disconnect(m,0,0),M.disconnect(m,0,1),W.disconnect(m,0,1)}}},p=(d,_,y,m,b)=>{if(_===1)return h(d,y,m,b);if(_===2)return f(d,y,m,b);throw c()};return(d,{channelCount:_,channelCountMode:y,pan:m,...b})=>{if(y==="max")throw c();let k=a(d,{...b,channelCount:1,channelCountMode:y,numberOfInputs:2}),x=e(d,{...b,channelCount:_,channelCountMode:y,gain:1}),g=e(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:m}),{connectGraph:A,disconnectGraph:T}=p(d,_,x,g,k);Object.defineProperty(g.gain,"defaultValue",{get:()=>0}),Object.defineProperty(g.gain,"maxValue",{get:()=>1}),Object.defineProperty(g.gain,"minValue",{get:()=>-1});let O={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount(C){x.channelCount!==C&&(w&&T(),{connectGraph:A,disconnectGraph:T}=p(d,C,x,g,k),w&&A()),x.channelCount=C},get channelCountMode(){return x.channelCountMode},set channelCountMode(C){if(C==="clamped-max"||C==="max")throw c();x.channelCountMode=C},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation(C){x.channelInterpretation=C},get context(){return x.context},get inputs(){return[x]},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get pan(){return g.gain},addEventListener(...C){return x.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return x.dispatchEvent(C[0])},removeEventListener(...C){return x.removeEventListener(C[0],C[1],C[2])}},w=!1,M=()=>{A(),w=!0},D=()=>{T(),w=!1};return l(kn(O,k),M,D)}},mf=(a,t,e,i,c,l,r)=>(s,n)=>{let o=s.createWaveShaper();if(l!==null&&l.name==="webkitAudioContext"&&s.createGain().gain.automationRate===void 0)return e(s,n);xt(o,n);let u=n.curve===null||n.curve instanceof Float32Array?n.curve:new Float32Array(n.curve);if(u!==null&&u.length<2)throw t();it(o,{curve:u},"curve"),it(o,n,"oversample");let h=null,f=!1;return r(o,"curve",_=>()=>_.call(o),_=>y=>(_.call(o,y),f&&(i(y)&&h===null?h=a(s,o):!i(y)&&h!==null&&(h(),h=null)),y)),c(o,()=>{f=!0,i(o.curve)&&(h=a(s,o))},()=>{f=!1,h!==null&&(h(),h=null)})},yf=(a,t,e,i,c)=>(l,{curve:r,oversample:s,...n})=>{let o=l.createWaveShaper(),u=l.createWaveShaper();xt(o,n),xt(u,n);let h=e(l,{...n,gain:1}),f=e(l,{...n,gain:-1}),p=e(l,{...n,gain:1}),d=e(l,{...n,gain:-1}),_=null,y=!1,m=null,b={get bufferSize(){},get channelCount(){return o.channelCount},set channelCount(g){h.channelCount=g,f.channelCount=g,o.channelCount=g,p.channelCount=g,u.channelCount=g,d.channelCount=g},get channelCountMode(){return o.channelCountMode},set channelCountMode(g){h.channelCountMode=g,f.channelCountMode=g,o.channelCountMode=g,p.channelCountMode=g,u.channelCountMode=g,d.channelCountMode=g},get channelInterpretation(){return o.channelInterpretation},set channelInterpretation(g){h.channelInterpretation=g,f.channelInterpretation=g,o.channelInterpretation=g,p.channelInterpretation=g,u.channelInterpretation=g,d.channelInterpretation=g},get context(){return o.context},get curve(){return m},set curve(g){if(g!==null&&g.length<2)throw t();if(g===null)o.curve=g,u.curve=g;else{let A=g.length,T=new Float32Array(A+2-A%2),O=new Float32Array(A+2-A%2);T[0]=g[0],O[0]=-g[A-1];let w=Math.ceil((A+1)/2),M=(A+1)/2-1;for(let D=1;D<w;D+=1){let C=D/w*M,E=Math.floor(C),F=Math.ceil(C);T[D]=E===F?g[E]:(1-(C-E))*g[E]+(1-(F-C))*g[F],O[D]=E===F?-g[A-1-E]:-((1-(C-E))*g[A-1-E])-(1-(F-C))*g[A-1-F]}T[w]=A%2==1?g[w-1]:(g[w-2]+g[w-1])/2,o.curve=T,u.curve=O}m=g,y&&(i(m)&&_===null?_=a(l,h):_!==null&&(_(),_=null))},get inputs(){return[h]},get numberOfInputs(){return o.numberOfInputs},get numberOfOutputs(){return o.numberOfOutputs},get oversample(){return o.oversample},set oversample(g){o.oversample=g,u.oversample=g},addEventListener(...g){return h.addEventListener(g[0],g[1],g[2])},dispatchEvent(...g){return h.dispatchEvent(g[0])},removeEventListener(...g){return h.removeEventListener(g[0],g[1],g[2])}};r!==null&&(b.curve=r instanceof Float32Array?r:new Float32Array(r)),s!==b.oversample&&(b.oversample=s);let k=()=>{h.connect(o).connect(p),h.connect(f).connect(u).connect(d).connect(p),y=!0,i(m)&&(_=a(l,h))},x=()=>{h.disconnect(o),o.disconnect(p),h.disconnect(f),f.disconnect(u),u.disconnect(d),d.disconnect(p),y=!1,_!==null&&(_(),_=null)};return c(kn(b,p),k,x)},Ut=()=>new DOMException("","NotSupportedError"),gf={numberOfChannels:1},bf=(a,t,e,i,c)=>class extends a{constructor(r,s,n){let o;if(typeof r=="number"&&s!==void 0&&n!==void 0)o={length:s,numberOfChannels:r,sampleRate:n};else if(typeof r=="object")o=r;else throw new Error("The given parameters are not valid.");let{length:u,numberOfChannels:h,sampleRate:f}={...gf,...o},p=i(h,u,f);t(ps,()=>ps(p))||p.addEventListener("statechange",(()=>{let d=0,_=y=>{this._state==="running"&&(d>0?(p.removeEventListener("statechange",_),y.stopImmediatePropagation(),this._waitForThePromiseToSettle(y)):d+=1)};return _})()),super(p,h),this._length=u,this._nativeOfflineAudioContext=p,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",c(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,xo(this)}))}_waitForThePromiseToSettle(r){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(r):setTimeout(()=>this._waitForThePromiseToSettle(r))}},vf={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},wf=(a,t,e,i,c,l,r)=>class extends a{constructor(n,o){let u=c(n),h={...vf,...o},f=e(u,h),p=l(u),d=p?i():null,_=n.sampleRate/2;super(n,!1,f,d);this._detune=t(this,p,f.detune,153600,-153600),this._frequency=t(this,p,f.frequency,_,-_),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=d,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(n){let o=typeof n=="function"?r(this,n):null;this._nativeOscillatorNode.onended=o;let u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===o?n:u}get type(){return this._nativeOscillatorNode.type}set type(n){this._nativeOscillatorNode.type=n,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(n){this._nativeOscillatorNode.setPeriodicWave(n),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=n)}start(n=0){if(this._nativeOscillatorNode.start(n),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=n),this.context.state!=="closed"){On(this);let o=()=>{this._nativeOscillatorNode.removeEventListener("ended",o),ke(this)&&us(this)};this._nativeOscillatorNode.addEventListener("ended",o)}}stop(n=0){this._nativeOscillatorNode.stop(n),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=n)}},Sf=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=null,s=null,n=null,o=async(u,h,f)=>{let p=e(u),d=Rt(p,h);if(!d){let _={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:r===null?void 0:r,type:p.type};p=t(h,_),s!==null&&p.start(s),n!==null&&p.stop(n)}return l.set(h,p),d?(await a(h,u.detune,p.detune,f),await a(h,u.frequency,p.frequency,f)):(await i(h,u.detune,p.detune,f),await i(h,u.frequency,p.frequency,f)),await c(u,h,p,f),p};return{set periodicWave(u){r=u},set start(u){s=u},set stop(u){n=u},render(u,h,f){let p=l.get(h);return p!==void 0?Promise.resolve(p):o(u,h,f)}}},xf={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Of=(a,t,e,i,c,l,r)=>class extends a{constructor(n,o){let u=c(n),h={...xf,...o},f=e(u,h),p=l(u),d=p?i():null;super(n,!1,f,d);this._nativePannerNode=f,this._orientationX=t(this,p,f.orientationX,Vt,Bt),this._orientationY=t(this,p,f.orientationY,Vt,Bt),this._orientationZ=t(this,p,f.orientationZ,Vt,Bt),this._positionX=t(this,p,f.positionX,Vt,Bt),this._positionY=t(this,p,f.positionY,Vt,Bt),this._positionZ=t(this,p,f.positionZ,Vt,Bt),r(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(n){this._nativePannerNode.coneInnerAngle=n}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(n){this._nativePannerNode.coneOuterAngle=n}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(n){this._nativePannerNode.coneOuterGain=n}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(n){this._nativePannerNode.distanceModel=n}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(n){this._nativePannerNode.maxDistance=n}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(n){this._nativePannerNode.panningModel=n}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(n){this._nativePannerNode.refDistance=n}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(n){this._nativePannerNode.rolloffFactor=n}},Tf=(a,t,e,i,c,l,r,s,n,o)=>()=>{let u=new WeakMap,h=null,f=async(p,d,_)=>{let y=null,m=l(p),b={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},k={...b,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},x=Rt(m,d);if("bufferSize"in m)y=i(d,{...b,gain:1});else if(!x){let g={...k,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=c(d,g)}if(u.set(d,y===null?m:y),y!==null){if(h===null){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");let C=new r(6,p.context.length,d.sampleRate),E=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});E.connect(C.destination),h=(async()=>{let F=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(W,L)=>{let V=e(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:L===0?1:0});return await s(C,W,V.offset,_),V}));for(let W=0;W<6;W+=1)F[W].connect(E,0,W),F[W].start(0);return o(C)})()}let g=await h,A=i(d,{...b,gain:1});await n(p,d,A,_);let T=[];for(let C=0;C<g.numberOfChannels;C+=1)T.push(g.getChannelData(C));let O=[T[0][0],T[1][0],T[2][0]],w=[T[3][0],T[4][0],T[5][0]],M=i(d,{...b,gain:1}),D=c(d,{...k,orientationX:O[0],orientationY:O[1],orientationZ:O[2],positionX:w[0],positionY:w[1],positionZ:w[2]});A.connect(M).connect(D.inputs[0]),D.connect(y);for(let C=128;C<g.length;C+=128){let E=[T[0][C],T[1][C],T[2][C]],F=[T[3][C],T[4][C],T[5][C]];if(E.some((W,L)=>W!==O[L])||F.some((W,L)=>W!==w[L])){O=E,w=F;let W=C/d.sampleRate;M.gain.setValueAtTime(0,W),M=i(d,{...b,gain:0}),D=c(d,{...k,orientationX:O[0],orientationY:O[1],orientationZ:O[2],positionX:w[0],positionY:w[1],positionZ:w[2]}),M.gain.setValueAtTime(1,W),A.connect(M).connect(D.inputs[0]),D.connect(y)}}return y}return x?(await a(d,p.orientationX,m.orientationX,_),await a(d,p.orientationY,m.orientationY,_),await a(d,p.orientationZ,m.orientationZ,_),await a(d,p.positionX,m.positionX,_),await a(d,p.positionY,m.positionY,_),await a(d,p.positionZ,m.positionZ,_)):(await s(d,p.orientationX,m.orientationX,_),await s(d,p.orientationY,m.orientationY,_),await s(d,p.orientationZ,m.orientationZ,_),await s(d,p.positionX,m.positionX,_),await s(d,p.positionY,m.positionY,_),await s(d,p.positionZ,m.positionZ,_)),Tn(m)?await n(p,d,m.inputs[0],_):await n(p,d,m,_),m};return{render(p,d,_){let y=u.get(d);return y!==void 0?Promise.resolve(y):f(p,d,_)}}},kf={disableNormalization:!1},Af=(a,t,e,i)=>class Fo{constructor(l,r){let s=t(l),n=i({...kf,...r}),o=a(s,n);return e.add(o),o}static[Symbol.hasInstance](l){return l!==null&&typeof l=="object"&&Object.getPrototypeOf(l)===Fo.prototype||e.has(l)}},Cf=(a,t)=>(e,i,c,l)=>(a(i).replay(c),t(i,e,c,l)),Ef=(a,t,e)=>async(i,c,l,r)=>{let s=a(i),n=[...r,i];await Promise.all(s.activeInputs.map((o,u)=>Array.from(o).filter(([h])=>!n.includes(h)).map(async([h,f])=>{let d=await t(h).render(h,c,n),_=i.context.destination;!e(h)&&(i!==_||!e(i))&&d.connect(l,f,u)})).reduce((o,u)=>[...o,...u],[]))},Df=(a,t,e)=>async(i,c,l,r)=>{let s=t(i);await Promise.all(Array.from(s.activeInputs).map(async([n,o])=>{let h=await a(n).render(n,c,r);e(n)||h.connect(l,o)}))},Mf=(a,t,e,i)=>c=>a(ps,()=>ps(c))?Promise.resolve(a(i,i)).then(l=>{if(!l){let r=e(c,512,0,1);c.oncomplete=()=>{r.onaudioprocess=null,r.disconnect()},r.onaudioprocess=()=>c.currentTime,r.connect(c.destination)}return c.startRendering()}):new Promise(l=>{let r=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});c.oncomplete=s=>{r.disconnect(),l(s.renderedBuffer)},r.connect(c.destination),c.startRendering()}),Nf=a=>(t,e)=>{a.set(t,e)},If=a=>(t,e)=>a.set(t,e),Pf=(a,t,e,i,c,l,r,s)=>{let n=[];return(o,u)=>e(o).render(o,u,n).then(()=>Promise.all(Array.from(i(u)).map(h=>e(h).render(h,u,n)))).then(()=>c(u)).then(h=>(typeof h.copyFromChannel!="function"?(r(h),er(h)):t(l,()=>l(h))||s(h),a.add(h),h))},jf={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Rf=(a,t,e,i,c,l)=>class extends a{constructor(s,n){let o=c(s),u={...jf,...n},h=e(o,u),f=l(o),p=f?i():null;super(s,!1,h,p);this._pan=t(this,f,h.pan)}get pan(){return this._pan}},Ff=(a,t,e,i,c)=>()=>{let l=new WeakMap,r=async(s,n,o)=>{let u=e(s),h=Rt(u,n);if(!h){let f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=t(n,f)}return l.set(n,u),h?await a(n,s.pan,u.pan,o):await i(n,s.pan,u.pan,o),Tn(u)?await c(s,n,u.inputs[0],o):await c(s,n,u,o),u};return{render(s,n,o){let u=l.get(n);return u!==void 0?Promise.resolve(u):r(s,n,o)}}},qf=a=>()=>{if(a===null)return!1;try{new a({length:1,sampleRate:44100})}catch{return!1}return!0};var Vf=(a,t)=>async()=>{if(a===null)return!0;if(t===null)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new t(1,128,8e3),c=URL.createObjectURL(e),l=!1,r=!1;try{await i.audioWorklet.addModule(c);let s=new a(i,"a",{numberOfOutputs:0}),n=i.createOscillator();s.port.onmessage=()=>l=!0,s.onprocessorerror=()=>r=!0,n.connect(s),await i.startRendering()}catch{}finally{URL.revokeObjectURL(c)}return l&&!r};var Wf=(a,t)=>()=>{if(t===null)return Promise.resolve(!1);let e=new t(1,1,44100),i=a(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(c=>{e.oncomplete=()=>{i.disconnect(),c(e.currentTime!==0)},e.startRendering()})};var Lf=()=>new DOMException("","UnknownError"),Bf={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},zf=(a,t,e,i,c,l,r)=>class extends a{constructor(n,o){let u=c(n),h={...Bf,...o},f=e(u,h),d=l(u)?i():null;super(n,!0,f,d);this._isCurveNullified=!1,this._nativeWaveShaperNode=f,r(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(n){if(n===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(n.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=n}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(n){this._nativeWaveShaperNode.oversample=n}},Uf=(a,t,e)=>()=>{let i=new WeakMap,c=async(l,r,s)=>{let n=t(l);if(!Rt(n,r)){let u={channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,curve:n.curve,oversample:n.oversample};n=a(r,u)}return i.set(r,n),Tn(n)?await e(l,r,n.inputs[0],s):await e(l,r,n,s),n};return{render(l,r,s){let n=i.get(r);return n!==void 0?Promise.resolve(n):c(l,r,s)}}},Gf=()=>typeof window=="undefined"?null:window,Yf=(a,t)=>e=>{e.copyFromChannel=(i,c,l=0)=>{let r=a(l),s=a(c);if(s>=e.numberOfChannels)throw t();let n=e.length,o=e.getChannelData(s),u=i.length;for(let h=r<0?-r:0;h+r<n&&h<u;h+=1)i[h]=o[h+r]},e.copyToChannel=(i,c,l=0)=>{let r=a(l),s=a(c);if(s>=e.numberOfChannels)throw t();let n=e.length,o=e.getChannelData(s),u=i.length;for(let h=r<0?-r:0;h+r<n&&h<u;h+=1)o[h+r]=i[h]}},Qf=a=>t=>{t.copyFromChannel=(e=>(i,c,l=0)=>{let r=a(l),s=a(c);if(r<t.length)return e.call(t,i,s,r)})(t.copyFromChannel),t.copyToChannel=(e=>(i,c,l=0)=>{let r=a(l),s=a(c);if(r<t.length)return e.call(t,i,s,r)})(t.copyToChannel)},Hf=a=>(t,e)=>{let i=e.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=i),a(t,"buffer",c=>()=>{let l=c.call(t);return l===i?null:l},c=>l=>c.call(t,l===null?i:l))},Zf=(a,t)=>(e,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw a()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw a()}});let c=e.createBufferSource();t(i,()=>{let s=i.numberOfInputs;for(let n=0;n<s;n+=1)c.connect(i,0,n)},()=>c.disconnect(i))},qo=a=>{if(a===null)return!1;let t=a.length;return t%2!=0?a[Math.floor(t/2)]!==0:a[t/2-1]+a[t/2]!==0},ti=(a,t,e,i)=>{let c=Object.getPrototypeOf(a);for(;!c.hasOwnProperty(t);)c=Object.getPrototypeOf(c);let{get:l,set:r}=Object.getOwnPropertyDescriptor(c,t);Object.defineProperty(a,t,{get:e(l),set:i(r)})},Xf=a=>({...a,outputChannelCount:a.outputChannelCount!==void 0?a.outputChannelCount:a.numberOfInputs===1&&a.numberOfOutputs===1?[a.channelCount]:Array.from({length:a.numberOfOutputs},()=>1)}),Kf=a=>({...a,channelCount:a.numberOfOutputs}),Jf=a=>{let{imag:t,real:e}=a;return t===void 0?e===void 0?{...a,imag:[0,0],real:[0,0]}:{...a,imag:Array.from(e,()=>0),real:e}:e===void 0?{...a,imag:t,real:Array.from(t,()=>0)}:{...a,imag:t,real:e}},Vo=(a,t,e)=>{try{a.setValueAtTime(t,e)}catch(i){if(i.code!==9)throw i;Vo(a,t,e+1e-7)}},$f=a=>{let t=a.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},tp=a=>{let t=a.createBufferSource(),e=a.createBuffer(1,1,44100);t.buffer=e;try{t.start(0,1)}catch{return!1}return!0},ep=a=>{let t=a.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},ur=a=>{let t=a.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},Wo=a=>{let t=a.createBuffer(1,1,44100),e=a.createBufferSource();e.buffer=t,e.start(),e.stop();try{return e.stop(),!0}catch{return!1}},lr=a=>{let t=a.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1};var np=a=>{a.start=(t=>(e=0,i=0,c)=>{let l=a.buffer,r=l===null?i:Math.min(l.duration,i);l!==null&&r>l.duration-.5/a.context.sampleRate?t.call(a,e,0,0):t.call(a,e,r,c)})(a.start)},Lo=(a,t)=>{let e=t.createGain();a.connect(e);let i=(c=>()=>{c.call(a,e),a.removeEventListener("ended",i)})(a.disconnect);a.addEventListener("ended",i),kn(a,e),a.stop=(c=>{let l=!1;return(r=0)=>{if(l)try{c.call(a,r)}catch{e.gain.setValueAtTime(0,r)}else c.call(a,r),l=!0}})(a.stop)},An=(a,t)=>e=>{let i={value:a};return Object.defineProperties(e,{currentTarget:i,target:i}),typeof t=="function"?t.call(a,e):t.handleEvent.call(a,e)},sp=Su(en),ip=Cu(en),rp=Ll(zs),Bo=new WeakMap,op=rh(Bo),ie=ml(new Map,new WeakMap),de=Gf(),zo=jh(ie,pe),hr=ih(Wt),Dt=Ef(Wt,hr,nn),ap=Iu(zo,nt,Dt),et=ch(Bs),Ae=uf(de),Z=Th(Ae),Uo=new WeakMap,Go=Kl(An),ms=Vh(de),fr=wh(ms),pr=Sh(de),Yo=xh(de),dt=il(xu(ho),Au(sp,ip,Ys,rp,Qs,Wt,op,cs,nt,en,ke,nn,Hs),ie,mh(Ki,Qs,Wt,nt,fs,ke),pe,$s,Ut,Fl(Ys,Ki,Wt,nt,fs,et,ke,Z),Ul(Uo,Wt,se),Go,et,fr,pr,Yo,Z),cp=Nu(dt,ap,pe,zo,et,Z),dr=new WeakSet,Qo=Rh(de),Ho=El(new Uint32Array(1)),_r=Yf(Ho,pe),mr=Qf(Ho),up=ju(dr,ie,Ut,Qo,Ae,qf(Qo),_r,mr),ei=Eu(zt),Zo=Df(hr,ls,nn),_e=xl(Zo),Cn=qh(ei,ie,$f,tp,ep,ur,Wo,lr,np,Hf(ti),Lo),me=Cf(oh(ls),Zo),lp=qu(_e,Cn,nt,me,Dt),re=rl(Ou(fo),Uo,Xi,ol,mu,yu,gu,bu,vu,Gi,ro,ms,Vo),hp=Fu(dt,lp,re,Tt,Cn,et,Z,An),fp=Qu(dt,Hu,pe,Tt,Wh(zt,ti),et,Z,Dt),pp=_l(_e,Po,nt,me,Dt),sn=If(Bo),dp=dl(dt,re,pp,$s,Po,et,Z,sn),je=Ih(en,pr),_p=Zf(Tt,je),Re=Hh(ms,_p),mp=bl(Re,nt,Dt),yp=gl(dt,mp,Re,et,Z),gp=Sl(ds,nt,Dt),bp=wl(dt,gp,ds,et,Z,Kf),vp=Kh(ei,Cn,zt,je),En=Xh(ei,ie,vp,ur,lr),wp=Cl(_e,En,nt,me,Dt),Sp=Al(dt,re,wp,En,et,Z,An),Xo=Jh(Ut,ti),xp=Nl(Xo,nt,Dt),Op=Ml(dt,xp,Xo,et,Z,sn),Tp=Wl(_e,jo,nt,me,Dt),kp=Vl(dt,re,Tp,jo,et,Z,sn),Ko=$h(Ut),Ap=Hl(_e,Ko,nt,me,Dt),Cp=Ql(dt,re,Ap,Ko,Ut,et,Z,sn),Ep=nh(_e,zt,nt,me,Dt),Dp=eh(dt,re,Ep,zt,et,Z),Mp=sf($s,Tt,_s,Ut),ni=Mf(ie,zt,_s,Wf(zt,Ae)),Np=_h(Cn,nt,Ae,Dt,ni),Ip=tf(Mp),Pp=ph(dt,Ip,Np,et,Z,sn),jp=Zu(re,Re,En,_s,Z),Jo=new WeakMap,Rp=Nh(fp,jp,Go,Z,Jo,An),$o=lf(ei,ie,ur,Wo,lr,Lo),Fp=Sf(_e,$o,nt,me,Dt),qp=wf(dt,re,$o,Fp,et,Z,An),ta=Tl(Cn),Vp=yf(ta,Tt,zt,qo,je),si=mf(ta,Tt,Vp,qo,je,ms,ti),Wp=ff(Ys,Tt,Re,zt,_s,si,Ut,Qs,je),ea=hf(Wp),Lp=Tf(_e,Re,En,zt,ea,nt,Ae,me,Dt,ni),Bp=Of(dt,re,ea,Lp,et,Z,sn),zp=pf(pe),Up=Af(zp,et,new WeakSet,Jf),Gp=_f(Re,ds,zt,si,Ut,je),na=df(Gp,Ut),Yp=Ff(_e,na,nt,me,Dt),Qp=Rf(dt,re,na,Yp,et,Z),Hp=Uf(si,nt,Dt),Zp=zf(dt,Tt,si,Hp,et,Z,sn),sa=kh(de),yr=Jl(de),ia=new WeakMap,Xp=uh(ia,Ae),gr=Lh(de),Kp=sa?ku(ie,Ut,Xl(de),yr,$l(wu),et,Xp,Z,new WeakMap,new WeakMap,Vf(gr,Ae),de):void 0,Jp=Oh(fr,Z),$p=Rl(dr,ie,Pl,Zl,new WeakSet,et,Jp,Us,ps,_r,mr),ra=fl(Kp,cp,up,hp,dp,yp,bp,Sp,Op,$p,kp,Cp,Dp,Pp,Rp,qp,Bp,Up,Qp,Zp),td=Ah(dt,rf,et,Z),ed=Eh(dt,of,et,Z),nd=Dh(dt,af,et,Z),sd=cf(Tt,Z),id=Mh(dt,sd,et),rd=Yu(ra,Tt,Ut,Lf,td,ed,nd,id,ms),br=lh(Jo),od=Du(br),oa=Ol(pe),ad=Bl(br),aa=Gl(pe),ca=new WeakMap,cd=sh(ca,se),ud=Qh(oa,pe,Tt,Re,ds,En,zt,_s,Ut,aa,yr,cd,je),ld=zh(Tt,ud,zt,Ut,je),hd=hl(_e,oa,Cn,Re,ds,En,zt,ad,aa,yr,nt,gr,Ae,me,Dt,ni),fd=ah(ia),pd=Nf(ca),ua=sa?cl(od,dt,re,hd,ld,Wt,fd,et,Z,gr,Xf,pd,An):void 0,dd=Il(Ut,Ae),_d=Pf(dr,ie,hr,br,ni,Us,_r,mr),md=bf(ra,ie,Tt,dd,_d),yd=yh(Bs,fr),gd=gh(Zi,pr),bd=bh(Xi,Yo),vd=vh(Bs,Z);function B(a,t){if(!a)throw new Error(t)}function Fe(a,t,e=Infinity){if(!(t<=a&&a<=e))throw new RangeError(`Value must be within [${t}, ${e}], got: ${a}`)}function ha(a){!a.isOffline&&a.state!=="running"&&la('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var fa=console;function wd(...a){fa.log(...a)}function la(...a){fa.warn(...a)}function Kt(a){return typeof a=="undefined"}function G(a){return!Kt(a)}function Sd(a){return typeof a=="function"}function rn(a){return typeof a=="number"}function on(a){return Object.prototype.toString.call(a)==="[object Object]"&&a.constructor===Object}function xd(a){return typeof a=="boolean"}function oe(a){return Array.isArray(a)}function ye(a){return typeof a=="string"}function ii(a){return ye(a)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(a)}function Od(a){return new rd(a)}function Td(a,t,e){return new md(a,t,e)}var an=typeof self=="object"?self:null,kd=an&&(an.hasOwnProperty("AudioContext")||an.hasOwnProperty("webkitAudioContext"));function Ad(a,t,e){return B(G(ua),"This node only works in a secure context (https or localhost)"),new ua(a,t,e)}function ae(a,t,e,i){var c=arguments.length,l=c<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,t,e,i);else for(var s=a.length-1;s>=0;s--)(r=a[s])&&(l=(c<3?r(l):c>3?r(t,e,l):r(t,e))||l);return c>3&&l&&Object.defineProperty(t,e,l),l}function mt(a,t,e,i){function c(l){return l instanceof e?l:new e(function(r){r(l)})}return new(e||(e=Promise))(function(l,r){function s(u){try{o(i.next(u))}catch(h){r(h)}}function n(u){try{o(i.throw(u))}catch(h){r(h)}}function o(u){u.done?l(u.value):c(u.value).then(s,n)}o((i=i.apply(a,t||[])).next())})}var pa=class{constructor(t,e,i){this._callback=t,this._type=e,this._updateInterval=i,this._createClock()}_createWorker(){let t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),e=URL.createObjectURL(t),i=new Worker(e);i.onmessage=this._callback.bind(this),this._worker=i}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(t*1e3,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}};function cn(a){return bd(a)}function qe(a){return gd(a)}function ri(a){return vd(a)}function Dn(a){return yd(a)}function da(a){return a instanceof AudioBuffer}function Cd(a,t){return a==="value"||cn(t)||qe(t)||da(t)}function Mn(a,...t){if(!t.length)return a;let e=t.shift();if(on(a)&&on(e))for(let i in e)Cd(i,e[i])?a[i]=e[i]:on(e[i])?(a[i]||Object.assign(a,{[i]:{}}),Mn(a[i],e[i])):Object.assign(a,{[i]:e[i]});return Mn(a,...t)}function Ed(a,t){return a.length===t.length&&a.every((e,i)=>t[i]===e)}function N(a,t,e=[],i){let c={},l=Array.from(t);if(on(l[0])&&i&&!Reflect.has(l[0],i)&&(Object.keys(l[0]).some(s=>Reflect.has(a,s))||(Mn(c,{[i]:l[0]}),e.splice(e.indexOf(i),1),l.shift())),l.length===1&&on(l[0]))Mn(c,l[0]);else for(let r=0;r<e.length;r++)G(l[r])&&(c[e[r]]=l[r]);return Mn(a,c)}function Dd(a){return a.constructor.getDefaults()}function Nn(a,t){return Kt(a)?t:a}function _a(a,t){return t.forEach(e=>{Reflect.has(a,e)&&delete a[e]}),a}var ge=class{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||an&&this.toString()===an.TONE_DEBUG_CLASS)&&wd(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};ge.version=no;var vr=1e-6;function oi(a,t){return a>t+vr}function wr(a,t){return oi(a,t)||ce(a,t)}function ma(a,t){return a+vr<t}function ce(a,t){return Math.abs(a-t)<vr}function Md(a,t,e){return Math.max(Math.min(a,e),t)}var ue=class extends ge{constructor(){super();this.name="Timeline",this._timeline=[];let t=N(ue.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:Infinity,increasing:!1}}get length(){return this._timeline.length}add(t){if(B(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){let e=this._timeline[this.length-1];B(wr(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{let e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){let e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(t){let e=this._timeline.indexOf(t);return e!==-1&&this._timeline.splice(e,1),this}get(t,e="time"){let i=this._search(t,e);return i!==-1?this._timeline[i]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){let i=this._search(t,e);return i+1<this._timeline.length?this._timeline[i+1]:null}getBefore(t){let e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];let i=this._search(t);return i-1>=0?this._timeline[i-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(ce(this._timeline[e].time,t)){for(let i=e;i>=0&&ce(this._timeline[i].time,t);i--)e=i;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else this._timeline.length===1&&wr(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){let e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){let e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(this._timeline.length===0)return-1;let i=0,c=this._timeline.length,l=c;if(c>0&&this._timeline[c-1][e]<=t)return c-1;for(;i<l;){let r=Math.floor(i+(l-i)/2),s=this._timeline[r],n=this._timeline[r+1];if(ce(s[e],t)){for(let o=r;o<this._timeline.length;o++){let u=this._timeline[o];if(ce(u[e],t))r=o;else break}return r}else{if(ma(s[e],t)&&oi(n[e],t))return r;oi(s[e],t)?l=r:i=r+1}}return-1}_iterate(t,e=0,i=this._timeline.length-1){this._timeline.slice(e,i+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){let i=this._search(t);return i!==-1&&this._iterate(e,0,i),this}forEachAfter(t,e){let i=this._search(t);return this._iterate(e,i+1),this}forEachBetween(t,e,i){let c=this._search(t),l=this._search(e);return c!==-1&&l!==-1?(this._timeline[c].time!==t&&(c+=1),this._timeline[l].time===e&&(l-=1),this._iterate(i,c,l)):c===-1&&this._iterate(i,0,l),this}forEachFrom(t,e){let i=this._search(t);for(;i>=0&&this._timeline[i].time>=t;)i--;return this._iterate(e,i+1),this}forEachAtTime(t,e){let i=this._search(t);if(i!==-1&&ce(this._timeline[i].time,t)){let c=i;for(let l=i;l>=0&&ce(this._timeline[l].time,t);l--)c=l;this._iterate(l=>{e(l)},c,i)}return this}dispose(){return super.dispose(),this._timeline=[],this}},ya=[];function ai(a){ya.push(a)}function Nd(a){ya.forEach(t=>t(a))}var ga=[];function ci(a){ga.push(a)}function Id(a){ga.forEach(t=>t(a))}var In=class extends ge{constructor(){super(...arguments);this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(c=>{Kt(this._events)&&(this._events={}),this._events.hasOwnProperty(c)||(this._events[c]=[]),this._events[c].push(e)}),this}once(t,e){let i=(...c)=>{e(...c),this.off(t,i)};return this.on(t,i),this}off(t,e){return t.split(/\W+/).forEach(c=>{if(Kt(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Kt(e))this._events[t]=[];else{let l=this._events[t];for(let r=l.length-1;r>=0;r--)l[r]===e&&l.splice(r,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){let i=this._events[t].slice(0);for(let c=0,l=i.length;c<l;c++)i[c].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{let i=Object.getOwnPropertyDescriptor(In.prototype,e);Object.defineProperty(t.prototype,e,i)})}dispose(){return super.dispose(),this._events=void 0,this}},Sr=class extends In{constructor(){super(...arguments);this.isOffline=!1}toJSON(){return{}}},Pn=class extends Sr{constructor(){super();this.name="Context",this._constants=new Map,this._timeouts=new ue,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let t=N(Pn.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=Od({latencyHint:t.latencyHint}),this._ticker=new pa(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(Nd(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,i){return this._context.createBuffer(t,e,i)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,i){return this._context.createPeriodicWave(t,e,i)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return B(Dn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return B(Dn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return B(Dn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){B(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){B(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){B(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){B(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return Ad(this.rawContext,t,e)}addAudioWorkletModule(t,e){return mt(this,void 0,void 0,function*(){B(G(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)})}workletsAreReady(){return mt(this,void 0,void 0,function*(){let t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,ye(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25;break}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Dn(this._context)?this._context.resume():Promise.resolve()}close(){return mt(this,void 0,void 0,function*(){Dn(this._context)&&(yield this._context.close()),this._initialized&&Id(this)})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{let e=this._context.createBuffer(1,128,this._context.sampleRate),i=e.getChannelData(0);for(let l=0;l<i.length;l++)i[l]=t;let c=this._context.createBufferSource();return c.channelCount=1,c.channelCountMode="explicit",c.buffer=e,c.loop=!0,c.start(0),this._constants.set(t,c),c}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){let t=this.now(),e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;let i=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:i+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){let i=++this._timeoutIds,c=()=>{let l=this.now();this._timeouts.add({callback:()=>{t(),c()},id:i,time:l+e})};return c(),i}},ba=class extends Sr{constructor(){super(...arguments);this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,i){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,i){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return mt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};function lt(a,t){oe(t)?t.forEach(e=>lt(a,e)):Object.defineProperty(a,t,{enumerable:!0,writable:!1})}function va(a,t){oe(t)?t.forEach(e=>va(a,e)):Object.defineProperty(a,t,{writable:!0})}var J=()=>{},$=class extends ge{constructor(){super();this.name="ToneAudioBuffer",this.onload=J;let t=N($.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&da(t.url)||t.url instanceof $?this.set(t.url):ye(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:J,onload:J,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Jt().sampleRate}set(t){return t instanceof $?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return mt(this,void 0,void 0,function*(){let e=$.load(t).then(i=>{this.set(i),this.onload(this)});$.downloads.push(e);try{yield e}finally{let i=$.downloads.indexOf(e);$.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){let e=oe(t)&&t[0].length>0,i=e?t.length:1,c=e?t[0].length:t.length,l=Jt(),r=l.createBuffer(i,c,l.sampleRate),s=!e&&i===1?[t]:t;for(let n=0;n<i;n++)r.copyToChannel(s[n],n);return this._buffer=r,this}toMono(t){if(rn(t))this.fromArray(this.toArray(t));else{let e=new Float32Array(this.length),i=this.numberOfChannels;for(let c=0;c<i;c++){let l=this.toArray(c);for(let r=0;r<l.length;r++)e[r]+=l[r]}e=e.map(c=>c/i),this.fromArray(e)}return this}toArray(t){if(rn(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{let e=[];for(let i=0;i<this.numberOfChannels;i++)e[i]=this.getChannelData(i);return e}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){let i=Math.floor(t*this.sampleRate),c=Math.floor(e*this.sampleRate);B(i<c,"The start time must be less than the end time");let l=c-i,r=Jt().createBuffer(this.numberOfChannels,l,this.sampleRate);for(let s=0;s<this.numberOfChannels;s++)r.copyToChannel(this.getChannelData(s).subarray(i,c),s);return new $(r)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new $().fromArray(t)}static fromUrl(t){return mt(this,void 0,void 0,function*(){return yield new $().load(t)})}static load(t){return mt(this,void 0,void 0,function*(){let e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){let s=e[1].split("|"),n=s[0];for(let o of s)if($.supportsType(o)){n=o;break}t=t.replace(e[0],n)}let i=$.baseUrl===""||$.baseUrl.endsWith("/")?$.baseUrl:$.baseUrl+"/",c=yield fetch(i+t);if(!c.ok)throw new Error(`could not load url: ${t}`);let l=yield c.arrayBuffer();return yield Jt().decodeAudioData(l)})}static supportsType(t){let e=t.split("."),i=e[e.length-1];return document.createElement("audio").canPlayType("audio/"+i)!==""}static loaded(){return mt(this,void 0,void 0,function*(){for(yield Promise.resolve();$.downloads.length;)yield $.downloads[0]})}};$.baseUrl="";$.downloads=[];var ui=class extends Pn{constructor(){super({clockSource:"offline",context:ri(arguments[0])?arguments[0]:Td(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:ri(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]});this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=ri(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return mt(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;let i=Math.floor(this.sampleRate/128);t&&e%i==0&&(yield new Promise(c=>setTimeout(c,1)))}})}render(t=!0){return mt(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(t);let e=yield this._context.startRendering();return new $(e)})}close(){return Promise.resolve()}},wa=new ba,ys=wa;function Jt(){return ys===wa&&kd&&Pd(new Pn),ys}function Pd(a){Dn(a)?ys=new Pn(a):ri(a)?ys=new ui(a):ys=a}if(an&&!an.TONE_SILENCE_LOGGING){let t=` * Tone.js v${no} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function jd(a){return Math.pow(10,a/20)}function Rd(a){return 20*(Math.log(a)/Math.LN10)}function Sa(a){return Math.pow(2,a/12)}var li=440;function Fd(){return li}function qd(a){li=a}function xr(a){return Math.round(xa(a))}function xa(a){return 69+12*Math.log2(a/li)}function Vd(a){return li*Math.pow(2,(a-69)/12)}var hi=class extends ge{constructor(t,e,i){super();this.defaultUnits="s",this._val=e,this._units=i,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{let i=parseInt(t,10),c=e==="."?1.5:1;return i===1?this._beatsToUnits(this._getTimeSignature())*c:this._beatsToUnits(4/i)*c},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{let e=parseInt(t,10);return this._beatsToUnits(8/(Math.floor(e)*3))},regexp:/^(\d+)t$/i},tr:{method:(t,e,i)=>{let c=0;return t&&t!=="0"&&(c+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(c+=this._beatsToUnits(parseFloat(e))),i&&i!=="0"&&(c+=this._beatsToUnits(parseFloat(i)/4)),c},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof hi&&this.fromType(this._val),Kt(this._val))return this._noArg();if(ye(this._val)&&Kt(this._units)){for(let t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(on(this._val)){let t=0;for(let e in this._val)if(G(this._val[e])){let i=this._val[e];t+=new this.constructor(this.context,e).valueOf()*i}return t}if(G(this._units)){let t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}else return ye(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}},$t=class extends hi{constructor(){super(...arguments);this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{let e=new $t(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){let i=new this.constructor(this.context,t).valueOf(),c=this.valueOf(),s=Math.round(c/i)*i-c;return c+s*e}toNotation(){let t=this.toSeconds(),e=["1m"];for(let l=1;l<9;l++){let r=Math.pow(2,l);e.push(r+"n."),e.push(r+"n"),e.push(r+"t")}e.push("0");let i=e[0],c=new $t(this.context,e[0]).toSeconds();return e.forEach(l=>{let r=new $t(this.context,l).toSeconds();Math.abs(r-t)<Math.abs(c-t)&&(i=l,c=r)}),i}toBarsBeatsSixteenths(){let t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));let i=Math.floor(e/this._getTimeSignature()),c=e%1*4;e=Math.floor(e)%this._getTimeSignature();let l=c.toString();return l.length>3&&(c=parseFloat(parseFloat(l).toFixed(3))),[i,e,c].join(":")}toTicks(){let t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return xr(this.toFrequency())}_now(){return this.context.now()}};var Yt=class extends $t{constructor(){super(...arguments);this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Fd()}static set A4(t){qd(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return this.defaultUnits==="midi"?t:Yt.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){let c=Wd[t.toLowerCase()]+(parseInt(e,10)+1)*12;return this.defaultUnits==="midi"?c:Yt.mtof(c)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,i){let c=1;return t&&t!=="0"&&(c*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(c*=this._beatsToUnits(parseFloat(e))),i&&i!=="0"&&(c*=this._beatsToUnits(parseFloat(i)/4)),c}}})}transpose(t){return new Yt(this.context,this.valueOf()*Sa(t))}harmonize(t){return t.map(e=>this.transpose(e))}toMidi(){return xr(this.valueOf())}toNote(){let t=this.toFrequency(),e=Math.log2(t/Yt.A4),i=Math.round(12*e)+57,c=Math.floor(i/12);return c<0&&(i+=-12*c),Ld[i%12]+c.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(t*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return Vd(t)}static ftom(t){return xr(t)}},Wd={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Ld=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var jn=class extends $t{constructor(){super(...arguments);this.name="TransportTime"}_now(){return this.context.transport.seconds}};var Lt=class extends ge{constructor(){super();let t=N(Lt.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Jt()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new $t(this.context,t).toSeconds()}toFrequency(t){return new Yt(this.context,t).toFrequency()}toTicks(t){return new jn(this.context,t).toTicks()}_getPartialProperties(t){let e=this.get();return Object.keys(e).forEach(i=>{Kt(t[i])&&delete e[i]}),e}get(){let t=Dd(this);return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){let i=this[e];G(i)&&G(i.value)&&G(i.setValueAtTime)?t[e]=i.value:i instanceof Lt?t[e]=i._getPartialProperties(t[e]):oe(i)||rn(i)||ye(i)||xd(i)?t[e]=i:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&G(this[e])&&(this[e]&&G(this[e].value)&&G(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Lt?this[e].set(t[e]):this[e]=t[e])}),this}},fi=class extends ue{constructor(t="stopped"){super();this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){let e=this.get(t);return e!==null?e.state:this._initial}setStateAtTime(t,e,i){return Fe(e,0),this.add(Object.assign({},i,{state:t,time:e})),this}getLastState(t,e){let i=this._search(e);for(let c=i;c>=0;c--){let l=this._timeline[c];if(l.state===t)return l}}getNextState(t,e){let i=this._search(e);if(i!==-1)for(let c=i;c<this._timeline.length;c++){let l=this._timeline[c];if(l.state===t)return l}}},st=class extends Lt{constructor(){super(N(st.getDefaults(),arguments,["param","units","convert"]));this.name="Param",this.overridden=!1,this._minOutput=1e-7;let t=N(st.getDefaults(),arguments,["param","units","convert"]);for(B(G(t.param)&&(cn(t.param)||t.param instanceof st),"param must be an AudioParam");!cn(t.param);)t.param=t.param._param;this._swappable=G(t.swappable)?t.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new ue(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,G(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Lt.getDefaults(),{convert:!0,units:"number"})}get value(){let t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return G(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-Infinity:this._param.minValue}get maxValue(){return G(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return G(this.maxValue)&&G(this.minValue)&&Fe(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?jd(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&this.units==="decibels"?Rd(t):t}setValueAtTime(t,e){let i=this.toSeconds(e),c=this._fromType(t);return B(isFinite(c)&&isFinite(i),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(c),this.log(this.units,"setValueAtTime",t,i),this._events.add({time:i,type:"setValueAtTime",value:c}),this._param.setValueAtTime(c,i),this}getValueAtTime(t){let e=Math.max(this.toSeconds(t),0),i=this._events.getAfter(e),c=this._events.get(e),l=this._initialValue;if(c===null)l=this._initialValue;else if(c.type==="setTargetAtTime"&&(i===null||i.type==="setValueAtTime")){let r=this._events.getBefore(c.time),s;r===null?s=this._initialValue:s=r.value,c.type==="setTargetAtTime"&&(l=this._exponentialApproach(c.time,s,c.value,c.constant,e))}else if(i===null)l=c.value;else if(i.type==="linearRampToValueAtTime"||i.type==="exponentialRampToValueAtTime"){let r=c.value;if(c.type==="setTargetAtTime"){let s=this._events.getBefore(c.time);s===null?r=this._initialValue:r=s.value}i.type==="linearRampToValueAtTime"?l=this._linearInterpolate(c.time,r,i.time,i.value,e):l=this._exponentialInterpolate(c.time,r,i.time,i.value,e)}else l=c.value;return this._toType(l)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(e)===0&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){let i=this._fromType(t),c=this.toSeconds(e);return B(isFinite(i)&&isFinite(c),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this._events.add({time:c,type:"linearRampToValueAtTime",value:i}),this.log(this.units,"linearRampToValueAtTime",t,c),this._param.linearRampToValueAtTime(i,c),this}exponentialRampToValueAtTime(t,e){let i=this._fromType(t);i=ce(i,0)?this._minOutput:i,this._assertRange(i);let c=this.toSeconds(e);return B(isFinite(i)&&isFinite(c),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:c,type:"exponentialRampToValueAtTime",value:i}),this.log(this.units,"exponentialRampToValueAtTime",t,c),this._param.exponentialRampToValueAtTime(i,c),this}exponentialRampTo(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(t,i+this.toSeconds(e)),this}linearRampTo(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(t,i+this.toSeconds(e)),this}targetRampTo(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialApproachValueAtTime(t,i,e),this}exponentialApproachValueAtTime(t,e,i){e=this.toSeconds(e),i=this.toSeconds(i);let c=Math.log(i+1)/Math.log(200);return this.setTargetAtTime(t,e,c),this.cancelAndHoldAtTime(e+i*.9),this.linearRampToValueAtTime(t,e+i),this}setTargetAtTime(t,e,i){let c=this._fromType(t);B(isFinite(i)&&i>0,"timeConstant must be a number greater than 0");let l=this.toSeconds(e);return this._assertRange(c),B(isFinite(c)&&isFinite(l),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:i,time:l,type:"setTargetAtTime",value:c}),this.log(this.units,"setTargetAtTime",t,l,i),this._param.setTargetAtTime(c,l,i),this}setValueCurveAtTime(t,e,i,c=1){i=this.toSeconds(i),e=this.toSeconds(e);let l=this._fromType(t[0])*c;this.setValueAtTime(this._toType(l),e);let r=i/(t.length-1);for(let s=1;s<t.length;s++){let n=this._fromType(t[s])*c;this.linearRampToValueAtTime(this._toType(n),e+s*r)}return this}cancelScheduledValues(t){let e=this.toSeconds(t);return B(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){let e=this.toSeconds(t),i=this._fromType(this.getValueAtTime(e));B(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+i);let c=this._events.get(e),l=this._events.getAfter(e);return c&&ce(c.time,e)?l?(this._param.cancelScheduledValues(l.time),this._events.cancel(l.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):l&&(this._param.cancelScheduledValues(l.time),this._events.cancel(l.time),l.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(i),e):l.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(i),e)),this._events.add({time:e,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,e),this}rampTo(t,e=.1,i){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(t,e,i):this.linearRampTo(t,e,i),this}apply(t){let e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);let i=this._events.get(e);if(i&&i.type==="setTargetAtTime"){let c=this._events.getAfter(i.time),l=c?c.time:e+2,r=(l-e)/10;for(let s=e;s<l;s+=r)t.linearRampToValueAtTime(this.getValueAtTime(s),s)}return this._events.forEachAfter(this.context.currentTime,c=>{c.type==="cancelScheduledValues"?t.cancelScheduledValues(c.time):c.type==="setTargetAtTime"?t.setTargetAtTime(c.value,c.time,c.constant):t[c.type](c.value,c.time)}),this}setParam(t){B(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,i,c,l){return i+(e-i)*Math.exp(-(l-t)/c)}_linearInterpolate(t,e,i,c,l){return e+(c-e)*((l-t)/(i-t))}_exponentialInterpolate(t,e,i,c,l){return e*Math.pow(c/e,(l-t)/(i-t))}},z=class extends Lt{constructor(){super(...arguments);this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return G(this.input)?cn(this.input)||this.input instanceof st?1:this.input.numberOfInputs:0}get numberOfOutputs(){return G(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return G(t)&&(t instanceof z||qe(t))}_getInternalNodes(){let t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(i=>{i.channelCount=t.channelCount,i.channelCountMode=t.channelCountMode,i.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){let t=this._getInternalNodes();B(t.length>0,"ToneAudioNode does not have any internal nodes");let e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,i=0){return Rn(this,t,e,i),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return la("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,i=0){return Bd(this,t,e,i),this}chain(...t){return Or(this,...t),this}fan(...t){return t.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),G(this.input)&&(this.input instanceof z?this.input.dispose():qe(this.input)&&this.input.disconnect()),G(this.output)&&(this.output instanceof z?this.output.dispose():qe(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function Or(...a){let t=a.shift();a.reduce((e,i)=>(e instanceof z?e.connect(i):qe(e)&&Rn(e,i),i),t)}function Rn(a,t,e=0,i=0){for(B(G(a),"Cannot connect from undefined node"),B(G(t),"Cannot connect to undefined node"),(t instanceof z||qe(t))&&B(t.numberOfInputs>0,"Cannot connect to node with no inputs"),B(a.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof z||t instanceof st;)G(t.input)&&(t=t.input);for(;a instanceof z;)G(a.output)&&(a=a.output);cn(t)?a.connect(t,e):a.connect(t,e,i)}function Bd(a,t,e=0,i=0){if(G(t))for(;t instanceof z;)t=t.input;for(;!qe(a);)G(a.output)&&(a=a.output);cn(t)?a.disconnect(t,e):qe(t)?a.disconnect(t,e,i):a.disconnect()}var Ft=class extends z{constructor(){super(N(Ft.getDefaults(),arguments,["gain","units"]));this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let t=N(Ft.getDefaults(),arguments,["gain","units"]);this.gain=new st({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),lt(this,"gain")}static getDefaults(){return Object.assign(z.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}},un=class extends z{constructor(t){super(t);this.onended=J,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ft({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){let i=this.toSeconds(e);return this._startTime!==-1&&i>=this._startTime&&(this._stopTime===-1||i<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(z.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:J})}_startGain(t,e=1){B(this._startTime===-1,"Source cannot be started more than once");let i=this.toSeconds(this._fadeIn);return this._startTime=t+i,this._startTime=Math.max(this._startTime,this.context.currentTime),i>0?(this._gainNode.gain.setValueAtTime(0,t),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(e,t+i):this._gainNode.gain.exponentialApproachValueAtTime(e,t,i)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){B(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();let e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let i=this._curve==="exponential"?e*2:0;this._stopSource(this.now()+i),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==J&&(this.onended(this),this.onended=J,!this.context.isOffline)){let t=()=>this.dispose();typeof window.requestIdleCallback!="undefined"?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),B(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}},gs=class extends un{constructor(){super(N(gs.getDefaults(),arguments,["offset"]));this.name="ToneConstantSource",this._source=this.context.createConstantSource();let t=N(gs.getDefaults(),arguments,["offset"]);Rn(this._source,this._gainNode),this.offset=new st({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(un.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){let e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}},yt=class extends z{constructor(){super(N(yt.getDefaults(),arguments,["value","units"]));this.name="Signal",this.override=!0;let t=N(yt.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new gs({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(z.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,i=0){return Tr(this,t,e,i),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,i){return this._param.exponentialRampTo(t,e,i),this}linearRampTo(t,e,i){return this._param.linearRampTo(t,e,i),this}targetRampTo(t,e,i){return this._param.targetRampTo(t,e,i),this}exponentialApproachValueAtTime(t,e,i){return this._param.exponentialApproachValueAtTime(t,e,i),this}setTargetAtTime(t,e,i){return this._param.setTargetAtTime(t,e,i),this}setValueCurveAtTime(t,e,i,c){return this._param.setValueCurveAtTime(t,e,i,c),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,i){return this._param.rampTo(t,e,i),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}};function Tr(a,t,e,i){(t instanceof st||cn(t)||t instanceof yt&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof yt&&(t.overridden=!0)),Rn(a,t,e,i)}var bs=class extends st{constructor(){super(N(bs.getDefaults(),arguments,["value"]));this.name="TickParam",this._events=new ue(Infinity),this._multiplier=1;let t=N(bs.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(st.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,i){e=this.toSeconds(e),this.setRampPoint(e);let c=this._fromType(t),l=this._events.get(e),r=Math.round(Math.max(1/i,1));for(let s=0;s<=r;s++){let n=i*s+e,o=this._exponentialApproach(l.time,l.value,c,i,n);this.linearRampToValueAtTime(this._toType(o),n)}return this}setValueAtTime(t,e){let i=this.toSeconds(e);super.setValueAtTime(t,e);let c=this._events.get(i),l=this._events.previousEvent(c),r=this._getTicksUntilEvent(l,i);return c.ticks=Math.max(r,0),this}linearRampToValueAtTime(t,e){let i=this.toSeconds(e);super.linearRampToValueAtTime(t,e);let c=this._events.get(i),l=this._events.previousEvent(c),r=this._getTicksUntilEvent(l,i);return c.ticks=Math.max(r,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);let i=this._fromType(t),c=this._events.get(e),l=Math.round(Math.max((e-c.time)*10,1)),r=(e-c.time)/l;for(let s=0;s<=l;s++){let n=r*s+c.time,o=this._exponentialInterpolate(c.time,c.value,e,i,n);this.linearRampToValueAtTime(this._toType(o),n)}return this}_getTicksUntilEvent(t,e){if(t===null)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Kt(t.ticks)){let r=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(r,t.time)}let i=this._fromType(this.getValueAtTime(t.time)),c=this._fromType(this.getValueAtTime(e)),l=this._events.get(e);return l&&l.time===e&&l.type==="setValueAtTime"&&(c=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(i+c)+t.ticks}getTicksAtTime(t){let e=this.toSeconds(t),i=this._events.get(e);return Math.max(this._getTicksUntilEvent(i,e),0)}getDurationOfTicks(t,e){let i=this.toSeconds(e),c=this.getTicksAtTime(e);return this.getTimeOfTick(c+t)-i}getTimeOfTick(t){let e=this._events.get(t,"ticks"),i=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&i&&i.type==="linearRampToValueAtTime"&&e.value!==i.value){let c=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(i.time))-c)/(i.time-e.time),s=Math.sqrt(Math.pow(c,2)-2*r*(e.ticks-t)),n=(-c+s)/r,o=(-c-s)/r;return(n>0?n:o)+e.time}else return e?e.value===0?Infinity:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){let i=this.toSeconds(e),c=this.toSeconds(t),l=this.getTicksAtTime(i);return this.getTicksAtTime(i+c)-l}_fromType(t){return this.units==="bpm"&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units==="bpm"&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){let e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}},vs=class extends yt{constructor(){super(N(vs.getDefaults(),arguments,["value"]));this.name="TickSignal";let t=N(vs.getDefaults(),arguments,["value"]);this.input=this._param=new bs({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(yt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}},ws=class extends Lt{constructor(){super(N(ws.getDefaults(),arguments,["frequency"]));this.name="TickSource",this._state=new fi,this._tickOffset=new ue;let t=N(ws.getDefaults(),arguments,["frequency"]);this.frequency=new vs({context:this.context,units:t.units,value:t.frequency}),lt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Lt.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){let i=this.toSeconds(t);return this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),G(e)&&this.setTicksAtTime(e,i)),this}stop(t){let e=this.toSeconds(t);if(this._state.getValueAtTime(e)==="stopped"){let i=this._state.get(e);i&&i.time>0&&(this._tickOffset.cancel(i.time),this._state.cancel(i.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){let e=this.toSeconds(t),i=this._state.getLastState("stopped",e),c={state:"paused",time:e};this._state.add(c);let l=i,r=0;return this._state.forEachBetween(i.time,e+this.sampleTime,s=>{let n=l.time,o=this._tickOffset.get(s.time);o&&o.time>=l.time&&(r=o.ticks,n=o.time),l.state==="started"&&s.state!=="started"&&(r+=this.frequency.getTicksAtTime(s.time)-this.frequency.getTicksAtTime(n)),l=s}),this._state.remove(c),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){let e=this.now(),i=this.frequency.timeToTicks(t,e);this.setTicksAtTime(i,e)}getSecondsAtTime(t){t=this.toSeconds(t);let e=this._state.getLastState("stopped",t),i={state:"paused",time:t};this._state.add(i);let c=e,l=0;return this._state.forEachBetween(e.time,t+this.sampleTime,r=>{let s=c.time,n=this._tickOffset.get(r.time);n&&n.time>=c.time&&(l=n.seconds,s=n.time),c.state==="started"&&r.state!=="started"&&(l+=r.time-s),c=r}),this._state.remove(i),l}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){let i=this._tickOffset.get(e),c=this._state.get(e),l=Math.max(i.time,c.time),r=this.frequency.getTicksAtTime(l)+t-i.ticks;return this.frequency.getTimeOfTick(r)}forEachTickBetween(t,e,i){let c=this._state.get(t);this._state.forEachBetween(t,e,r=>{c&&c.state==="started"&&r.state!=="started"&&this.forEachTickBetween(Math.max(c.time,t),r.time-this.sampleTime,i),c=r});let l=null;if(c&&c.state==="started"){let r=Math.max(c.time,t),s=this.frequency.getTicksAtTime(r),n=this.frequency.getTicksAtTime(c.time),o=s-n,u=Math.ceil(o)-o;u=ce(u,1)?0:u;let h=this.frequency.getTimeOfTick(s+u);for(;h<e;){try{i(h,Math.round(this.getTicksAtTime(h)))}catch(f){l=f;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(l)throw l;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}},Fn=class extends Lt{constructor(){super(N(Fn.getDefaults(),arguments,["callback","frequency"]));this.name="Clock",this.callback=J,this._lastUpdate=0,this._state=new fi("stopped"),this._boundLoop=this._loop.bind(this);let t=N(Fn.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new ws({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,lt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Lt.getDefaults(),{callback:J,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){ha(this.context);let i=this.toSeconds(t);return this.log("start",i),this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),this._tickSource.start(i,e),i<this._lastUpdate&&this.emit("start",i,e)),this}stop(t){let e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){let i=this.toSeconds(e),c=this.getTicksAtTime(i);return this._tickSource.getTimeOfTick(c+t,i)}_loop(){let t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,i=>{switch(i.state){case"started":let c=this._tickSource.getTicksAtTime(i.time);this.emit("start",i.time,c);break;case"stopped":i.time!==0&&this.emit("stop",i.time);break;case"paused":this.emit("pause",i.time);break}}),this._tickSource.forEachTickBetween(t,e,(i,c)=>{this.callback(i,c)}))}getStateAtTime(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};In.mixin(Fn);var pi=class extends ge{constructor(){super();this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let t=N(pi.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;let i=t.urls[e];this.add(e,i,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:J,onload:J,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return B(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,i=J,c=J){return ye(e)?this._buffers.set(t.toString(),new $(this.baseUrl+e,i,c)):this._buffers.set(t.toString(),new $(e,i,c)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}};var be=class extends jn{constructor(){super(...arguments);this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};var Oa=class extends Lt{constructor(){super(...arguments);this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new ue,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){let t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){let e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}};ai(a=>{a.draw=new Oa({context:a})});ci(a=>{a.draw.dispose()});var Ta=class extends ge{constructor(){super(...arguments);this.name="IntervalTimeline",this._root=null,this._length=0}add(t){B(G(t.time),"Events must have a time property"),B(G(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new ka(t.time,t.time+t.duration,t);for(this._root===null?this._root=e:this._root.insert(e),this._length++;e!==null;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(this._root!==null){let e=[];this._root.search(t.time,e);for(let i of e)if(i.event===t){this._removeNode(i),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,e=>this.remove(e)),this}_setRoot(t){this._root=t,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(t,e){t.parent!==null?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(t.left===null&&t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{let e=t.getBalance(),i,c=null;if(e>0)if(t.left.right===null)i=t.left,i.right=t.right,c=i;else{for(i=t.left.right;i.right!==null;)i=i.right;i.parent&&(i.parent.right=i.left,c=i.parent,i.left=t.left,i.right=t.right)}else if(t.right.left===null)i=t.right,i.left=t.left,c=i;else{for(i=t.right.left;i.left!==null;)i=i.left;i.parent&&(i.parent.left=i.right,c=i.parent,i.left=t.left,i.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=i:t.parent.right=i:this._setRoot(i),c&&this._rebalance(c)}t.dispose()}_rotateLeft(t){let e=t.parent,i=t.isLeftChild(),c=t.right;c&&(t.right=c.left,c.left=t),e!==null?i?e.left=c:e.right=c:this._setRoot(c)}_rotateRight(t){let e=t.parent,i=t.isLeftChild(),c=t.left;c&&(t.left=c.right,c.right=t),e!==null?i?e.left=c:e.right=c:this._setRoot(c)}_rebalance(t){let e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){let e=[];if(this._root.search(t,e),e.length>0){let i=e[0];for(let c=1;c<e.length;c++)e[c].low>i.low&&(i=e[c]);return i.event}}return null}forEach(t){if(this._root!==null){let e=[];this._root.traverse(i=>e.push(i)),e.forEach(i=>{i.event&&t(i.event)})}return this}forEachAtTime(t,e){if(this._root!==null){let i=[];this._root.search(t,i),i.forEach(c=>{c.event&&e(c.event)})}return this}forEachFrom(t,e){if(this._root!==null){let i=[];this._root.searchAfter(t,i),i.forEach(c=>{c.event&&e(c.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(t=>t.dispose()),this._root=null,this}},ka=class{constructor(t,e,i){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(this.left!==null&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),!(this.low>t)&&this.right!==null&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),this.left!==null&&this.left.searchAfter(t,e)),this.right!==null&&this.right.searchAfter(t,e)}traverse(t){t(this),this.left!==null&&this.left.traverse(t),this.right!==null&&this.right.traverse(t)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null&&this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null&&(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}};var Ve=class extends z{constructor(){super(N(Ve.getDefaults(),arguments,["volume"]));this.name="Volume";let t=N(Ve.getDefaults(),arguments,["volume"]);this.input=this.output=new Ft({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,lt(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(z.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-Infinity}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-Infinity):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}},Ss=class extends z{constructor(){super(N(Ss.getDefaults(),arguments));this.name="Destination",this.input=new Ve({context:this.context}),this.output=new Ft({context:this.context}),this.volume=this.input.volume;let t=N(Ss.getDefaults(),arguments);Or(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(z.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Or(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};ai(a=>{a.destination=new Ss({context:a})});ci(a=>{a.destination.dispose()});var Aa=class extends ge{constructor(t){super();this.name="TimelineValue",this._timeline=new ue({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){let e=this._timeline.get(t);return e?e.value:this._initialValue}},Ce=class{constructor(t,e){this.id=Ce._eventId++;let i=Object.assign(Ce.getDefaults(),e);this.transport=t,this.callback=i.callback,this._once=i.once,this.time=i.time}static getDefaults(){return{callback:J,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}};Ce._eventId=0;var di=class extends Ce{constructor(t,e){super(t,e);this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let i=Object.assign(di.getDefaults(),e);this.duration=new be(t.context,i.duration).valueOf(),this._interval=new be(t.context,i.interval).valueOf(),this._nextTick=i.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Ce.getDefaults(),{duration:Infinity,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){let e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new be(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new be(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new be(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}},qn=class extends Lt{constructor(){super(N(qn.getDefaults(),arguments));this.name="Transport",this._loop=new Aa(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new ue,this._repeatedEvents=new Ta,this._syncedSignals=[],this._swingAmount=0;let t=N(qn.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Fn({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),lt(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Lt.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(this._swingTicks*2)!=0){let i=e%(this._swingTicks*2)/(this._swingTicks*2),c=Math.sin(i*Math.PI)*this._swingAmount;t+=new be(this.context,this._swingTicks*2/3).toSeconds()*c}this._timeline.forEachAtTime(e,i=>i.invoke(t))}schedule(t,e){let i=new Ce(this,{callback:t,time:new jn(this.context,e).toTicks()});return this._addEvent(i,this._timeline)}scheduleRepeat(t,e,i,c=Infinity){let l=new di(this,{callback:t,duration:new $t(this.context,c).toTicks(),interval:new $t(this.context,e).toTicks(),time:new jn(this.context,i).toTicks()});return this._addEvent(l,this._repeatedEvents)}scheduleOnce(t,e){let i=new Ce(this,{callback:t,once:!0,time:new jn(this.context,e).toTicks()});return this._addEvent(i,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){let e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){let e=this.toTicks(t);return this._timeline.forEachFrom(e,i=>this.clear(i.id)),this._repeatedEvents.forEachFrom(e,i=>this.clear(i.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new be(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let i;return G(e)&&(i=this.toTicks(e)),this._clock.start(t,i),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!=="started"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){oe(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new $t(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new $t(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new be(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){let t=this.now(),e=this._clock.getTicksAtTime(t);return new be(this.context,e).toBarsBeatsSixteenths()}set position(t){let e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){let e=this.now(),i=this._clock.frequency.timeToTicks(t,e);this.ticks=i}get progress(){if(this.loop){let t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){let e=this.now();if(this.state==="started"){let i=this._clock.getTicksAtTime(e),c=this._clock.frequency.getDurationOfTicks(Math.ceil(i)-i,e),l=e+c;this.emit("stop",l),this._clock.setTicksAtTime(t,l),this.emit("start",l,this._clock.getSecondsAtTime(l))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!=="started")return 0;{let e=this.now(),i=this.getTicksAtTime(e),c=t-i%t;return this._clock.nextTickTime(c,e)}}syncSignal(t,e){if(!e){let c=this.now();if(t.getValueAtTime(c)!==0){let l=this.bpm.getValueAtTime(c),r=1/(60/l/this.PPQ);e=t.getValueAtTime(c)/r}else e=0}let i=new Ft(e);return this.bpm.connect(i),i.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:i,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){let i=this._syncedSignals[e];i.signal===t&&(i.ratio.dispose(),i.signal.value=i.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),va(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};In.mixin(qn);ai(a=>{a.transport=new qn({context:a})});ci(a=>{a.transport.dispose()});var Gt=class extends z{constructor(t){super(t);this.input=void 0,this._state=new fi("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=J,this._syncedStop=J,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Ve({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,lt(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(z.getDefaults(),{mute:!1,onstop:J,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,i){let c=Kt(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(c=this._clampToCurrentTime(c),!this._synced&&this._state.getValueAtTime(c)==="started")B(oi(c,this._state.get(c).time),"Start time must be strictly greater than previous start time"),this._state.cancel(c),this._state.setStateAtTime("started",c),this.log("restart",c),this.restart(c,e,i);else if(this.log("start",c),this._state.setStateAtTime("started",c),this._synced){let l=this._state.get(c);l&&(l.offset=this.toSeconds(Nn(e,0)),l.duration=i?this.toSeconds(i):void 0);let r=this.context.transport.schedule(s=>{this._start(s,e,i)},c);this._scheduled.push(r),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>c&&this._syncedStart(this.now(),this.context.transport.seconds)}else ha(this.context),this._start(c,e,i);return this}stop(t){let e=Kt(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this._state.getValueAtTime(e)==="started"||G(this._state.getNextState("started",e))){if(this.log("stop",e),!this._synced)this._stop(e);else{let i=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(i)}this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,i){return t=this.toSeconds(t),this._state.getValueAtTime(t)==="started"&&(this._state.cancel(t),this._restart(t,e,i)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){let i=this._state.get(e);if(i&&i.state==="started"&&i.time!==e){let c=e-this.toSeconds(i.time),l;i.duration&&(l=this.toSeconds(i.duration)-c),this._start(t,this.toSeconds(i.offset)+c,l)}}},this._syncedStop=t=>{let e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)==="started"&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=J,this.unsync(),this._volume.dispose(),this._state.dispose(),this}},Vn=class extends un{constructor(){super(N(Vn.getDefaults(),arguments,["url","onload"]));this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let t=N(Vn.getDefaults(),arguments,["url","onload"]);Rn(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new st({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new $(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(un.getDefaults(),{url:new $,loop:!1,loopEnd:0,loopStart:0,onload:J,onerror:J,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,i,c=1){B(this.buffer.loaded,"buffer is either not set or not loaded");let l=this.toSeconds(t);this._startGain(l,c),this.loop?e=Nn(e,this.loopStart):e=Nn(e,0);let r=Math.max(this.toSeconds(e),0);if(this.loop){let s=this.toSeconds(this.loopEnd)||this.buffer.duration,n=this.toSeconds(this.loopStart),o=s-n;wr(r,s)&&(r=(r-n)%o+n),ce(r,this.buffer.duration)&&(r=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ma(r,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(l,r)),G(i)){let s=this.toSeconds(i);s=Math.max(s,0),this.stop(l+s)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}};var kg=44100*5;function ln(a,t){return mt(this,void 0,void 0,function*(){let e=t/a.context.sampleRate,i=new ui(1,e,a.context.sampleRate);return new a.constructor(Object.assign(a.get(),{frequency:2/e,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)})}var xs=class extends un{constructor(){super(N(xs.getDefaults(),arguments,["frequency","type"]));this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let t=N(xs.getDefaults(),arguments,["frequency","type"]);Rn(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new st({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new st({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),lt(this,["frequency","detune"])}static getDefaults(){return Object.assign(un.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){let e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}},ht=class extends Gt{constructor(){super(N(ht.getDefaults(),arguments,["frequency","type"]));this.name="Oscillator",this._oscillator=null;let t=N(ht.getDefaults(),arguments,["frequency","type"]);this.frequency=new yt({context:this.context,units:"frequency",value:t.frequency}),lt(this,"frequency"),this.detune=new yt({context:this.context,units:"cents",value:t.detune}),lt(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&t.type!=="custom"&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Gt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){let e=this.toSeconds(t),i=new xs({context:this.context,onended:()=>this.onstop(this)});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){let e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){let e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return ht._periodicWaveCache.find(e=>e.phase===this._phase&&Ed(e.partials,this._partials));{let t=ht._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;let e=["sine","square","sawtooth","triangle"].indexOf(t)!==-1;if(this._phase===0&&e)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=t);else{let i=this._getCachedPeriodicWave();if(G(i)){let{partials:c,wave:l}=i;this._wave=l,this._partials=c,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{let[c,l]=this._getRealImaginary(t,this._phase),r=this.context.createPeriodicWave(c,l);this._wave=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),ht._periodicWaveCache.push({imag:l,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:c,type:this._type,wave:this._wave}),ht._periodicWaveCache.length>100&&ht._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&this._type!=="custom"&&t!=="custom"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Fe(t,0);let e=this._type,i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(i&&(e=i[1]),this._type!=="custom")t===0?this.type=e:this.type=e+t.toString();else{let c=new Float32Array(t);this._partials.forEach((l,r)=>c[r]=l),this._partials=Array.from(c),this.type=this._type}}_getRealImaginary(t,e){let c=4096/2,l=new Float32Array(c),r=new Float32Array(c),s=1;if(t==="custom"){if(s=this._partials.length+1,this._partialCount=this._partials.length,c=s,this._partials.length===0)return[l,r]}else{let n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);n?(s=parseInt(n[2],10)+1,this._partialCount=parseInt(n[2],10),t=n[1],s=Math.max(s,2),c=s):this._partialCount=0,this._partials=[]}for(let n=1;n<c;++n){let o=2/(n*Math.PI),u;switch(t){case"sine":u=n<=s?1:0,this._partials[n-1]=u;break;case"square":u=n&1?2*o:0,this._partials[n-1]=u;break;case"sawtooth":u=o*(n&1?1:-1),this._partials[n-1]=u;break;case"triangle":n&1?u=2*(o*o)*(n-1>>1&1?-1:1):u=0,this._partials[n-1]=u;break;case"custom":u=this._partials[n-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}u!==0?(l[n]=-u*Math.sin(e*n),r[n]=u*Math.cos(e*n)):(l[n]=0,r[n]=0)}return[l,r]}_inverseFFT(t,e,i){let c=0,l=t.length;for(let r=0;r<l;r++)c+=t[r]*Math.cos(r*i)+e[r]*Math.sin(r*i);return c}getInitialValue(){let[t,e]=this._getRealImaginary(this._type,0),i=0,c=Math.PI*2,l=32;for(let r=0;r<l;r++)i=Math.max(this._inverseFFT(t,e,r/l*c),i);return Md(-this._inverseFFT(t,e,this._phase)/i,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};ht._periodicWaveCache=[];var Os=class extends z{constructor(){super(Object.assign(N(Os.getDefaults(),arguments,["context"])))}connect(t,e=0,i=0){return Tr(this,t,e,i),this}},Wn=class extends Os{constructor(){super(Object.assign(N(Wn.getDefaults(),arguments,["mapping","length"])));this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let t=N(Wn.getDefaults(),arguments,["mapping","length"]);oe(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):Sd(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(yt.getDefaults(),{length:1024})}setMap(t,e=1024){let i=new Float32Array(e);for(let c=0,l=e;c<l;c++){let r=c/(l-1)*2-1;i[c]=t(r,c)}return this.curve=i,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){let e=["none","2x","4x"].some(i=>i.includes(t));B(e,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}},Ca=class extends Os{constructor(){super(...arguments);this.name="AudioToGain",this._norm=new Wn({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}},We=class extends yt{constructor(){super(Object.assign(N(We.getDefaults(),arguments,["value"])));this.name="Multiply",this.override=!1;let t=N(We.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ft({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(yt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}},Ln=class extends Gt{constructor(){super(N(Ln.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="AMOscillator",this._modulationScale=new Ca({context:this.context}),this._modulationNode=new Ft({context:this.context});let t=N(Ln.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ht({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ht({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new We({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),lt(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ht.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}},Bn=class extends Gt{constructor(){super(N(Bn.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="FMOscillator",this._modulationNode=new Ft({context:this.context,gain:0});let t=N(Bn.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ht({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new yt({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ht({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new We({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new We({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),lt(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ht.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}},hn=class extends Gt{constructor(){super(N(hn.getDefaults(),arguments,["frequency","width"]));this.name="PulseOscillator",this._widthGate=new Ft({context:this.context,gain:0}),this._thresh=new Wn({context:this.context,mapping:e=>e<=0?-1:1});let t=N(hn.getDefaults(),arguments,["frequency","width"]);this.width=new yt({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ht({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),lt(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Gt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}},zn=class extends Gt{constructor(){super(N(zn.getDefaults(),arguments,["frequency","type","spread"]));this.name="FatOscillator",this._oscillators=[];let t=N(zn.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new yt({context:this.context,units:"frequency",value:t.frequency}),this.detune=new yt({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,lt(this,["frequency","detune"])}static getDefaults(){return Object.assign(ht.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){let e=-t/2,i=t/(this._oscillators.length-1);this._forEach((c,l)=>c.detune.value=e+i*l)}}get count(){return this._oscillators.length}set count(t){if(Fe(t,1),this._oscillators.length!==t){this._forEach(e=>e.dispose()),this._oscillators=[];for(let e=0;e<t;e++){let i=new ht({context:this.context,volume:-6-t*1.1,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:e===0?()=>this.onstop(this):J});this.type==="custom"&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[e]=i}this.spread=this._spread,this.state==="started"&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((e,i)=>e.phase=this._phase+i/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}},Un=class extends Gt{constructor(){super(N(Un.getDefaults(),arguments,["frequency","modulationFrequency"]));this.name="PWMOscillator",this.sourceType="pwm",this._scale=new We({context:this.context,value:2});let t=N(Un.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new hn({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ht({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),lt(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Gt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}},Ea={am:Ln,fat:zn,fm:Bn,oscillator:ht,pulse:hn,pwm:Un},Gn=class extends Gt{constructor(){super(N(Gn.getDefaults(),arguments,["frequency","type"]));this.name="OmniOscillator";let t=N(Gn.getDefaults(),arguments,["frequency","type"]);this.frequency=new yt({context:this.context,units:"frequency",value:t.frequency}),this.detune=new yt({context:this.context,units:"cents",value:t.detune}),lt(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ht.getDefaults(),Bn.getDefaults(),Ln.getDefaults(),zn.getDefaults(),hn.getDefaults(),Un.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):t==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;let e=Ea[t],i=this.now();if(this._oscillator){let c=this._oscillator;c.stop(i),this.context.setTimeout(()=>c.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(i)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(e=this._oscillator.type),t==="fm"?this.type="fm"+e:t==="am"?this.type="am"+e:t==="fat"?this.type="fat"+e:t==="oscillator"?this.type=e:t==="pulse"?this.type="pulse":t==="pwm"&&(this.type="pwm")}_getOscType(t,e){return t instanceof Ea[e]}get baseType(){return this._oscillator.baseType}set baseType(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&t!=="pulse"&&t!=="pwm"&&(this._oscillator.baseType=t)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(t){this._getOscType(this._oscillator,"fat")&&rn(t)&&(this._oscillator.count=t)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(t){this._getOscType(this._oscillator,"fat")&&rn(t)&&(this._oscillator.spread=t)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ye(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(t=1024){return mt(this,void 0,void 0,function*(){return ln(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}};function Da(a,t=Infinity){let e=new WeakMap;return function(i,c){Reflect.defineProperty(i,c,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(l){Fe(l,a,t),e.set(this,l)}})}}function Ee(a,t=Infinity){let e=new WeakMap;return function(i,c){Reflect.defineProperty(i,c,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(l){Fe(this.toSeconds(l),a,t),e.set(this,l)}})}}var Yn=class extends Gt{constructor(){super(N(Yn.getDefaults(),arguments,["url","onload"]));this.name="Player",this._activeSources=new Set;let t=N(Yn.getDefaults(),arguments,["url","onload"]);this._buffer=new $({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Gt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:J,onerror:J,playbackRate:1,reverse:!1})}load(t){return mt(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=J){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,i){return super.start(t,e,i),this}_start(t,e,i){this._loop?e=Nn(e,this._loopStart):e=Nn(e,0);let c=this.toSeconds(e),l=i;i=Nn(i,Math.max(this._buffer.duration-c,0));let r=this.toSeconds(i);r=r/this._playbackRate,t=this.toSeconds(t);let s=new Vn({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(t+r),this._state.setStateAtTime("stopped",t+r,{implicitEnd:!0})),this._activeSources.add(s),this._loop&&Kt(l)?s.start(t,c):s.start(t,c,r-this.toSeconds(this.fadeOut))}_stop(t){let e=this.toSeconds(t);this._activeSources.forEach(i=>i.stop(e))}restart(t,e,i){return super.restart(t,e,i),this}_restart(t,e,i){this._stop(t),this._start(t,e,i)}seek(t,e){let i=this.toSeconds(e);if(this._state.getValueAtTime(i)==="started"){let c=this.toSeconds(t);this._stop(i),this._start(i,c)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Fe(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Fe(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){let e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;let e=this.now(),i=this._state.getNextState("stopped",e);i&&i.implicitEnd&&(this._state.cancel(i.time),this._activeSources.forEach(c=>c.cancelStop())),this._activeSources.forEach(c=>{c.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}};ae([Ee(0)],Yn.prototype,"fadeIn",void 0);ae([Ee(0)],Yn.prototype,"fadeOut",void 0);var ve=class extends z{constructor(){super(N(ve.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="Envelope",this._sig=new yt({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let t=N(ve.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(z.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(ye(t))return t;{let i;for(i in _i)if(_i[i][e]===t)return i;return t}}_setCurve(t,e,i){if(ye(i)&&Reflect.has(_i,i)){let c=_i[i];on(c)?t!=="_decayCurve"&&(this[t]=c[e]):this[t]=c}else if(oe(i)&&t!=="_decayCurve")this[t]=i;else throw new Error("Envelope: invalid curve: "+i)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){B(["linear","exponential"].some(e=>e===t),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let c=this.toSeconds(this.attack),l=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0){let s=1/c;c=(1-r)/s}if(c<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if(this._attackCurve==="linear")this._sig.linearRampTo(e,c,t);else if(this._attackCurve==="exponential")this._sig.targetRampTo(e,c,t);else{this._sig.cancelAndHoldAtTime(t);let s=this._attackCurve;for(let n=1;n<s.length;n++)if(s[n-1]<=r&&r<=s[n]){s=this._attackCurve.slice(n),s[0]=r;break}this._sig.setValueCurveAtTime(s,t,c,e)}if(l&&this.sustain<1){let s=e*this.sustain,n=t+c;this.log("decay",n),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(s,l+n):this._sig.exponentialApproachValueAtTime(s,n,l)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);let e=this.getValueAtTime(t);if(e>0){let i=this.toSeconds(this.release);i<this.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve==="linear"?this._sig.linearRampTo(0,i,t):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,i,t):(B(oe(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,i,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,i=1){return e=this.toSeconds(e),this.triggerAttack(e,i),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,i=0){return Tr(this,t,e,i),this}asArray(t=1024){return mt(this,void 0,void 0,function*(){let e=t/this.context.sampleRate,i=new ui(1,e,this.context.sampleRate),c=this.toSeconds(this.attack)+this.toSeconds(this.decay),l=c+this.toSeconds(this.release),r=l*.1,s=l+r,n=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/s,decay:e*this.toSeconds(this.decay)/s,release:e*this.toSeconds(this.release)/s,context:i}));return n._sig.toDestination(),n.triggerAttackRelease(e*(c+r)/s,0),(yield i.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}};ae([Ee(0)],ve.prototype,"attack",void 0);ae([Ee(0)],ve.prototype,"decay",void 0);ae([Da(0,1)],ve.prototype,"sustain",void 0);ae([Ee(0)],ve.prototype,"release",void 0);var _i=(()=>{let a=128,t,e,i=[];for(t=0;t<a;t++)i[t]=Math.sin(t/(a-1)*(Math.PI/2));let c=[],l=6.4;for(t=0;t<a-1;t++){e=t/(a-1);let f=Math.sin(e*(Math.PI*2)*l-Math.PI/2)+1;c[t]=f/10+e*.83}c[a-1]=1;let r=[],s=5;for(t=0;t<a;t++)r[t]=Math.ceil(t/(a-1)*s)/s;let n=[];for(t=0;t<a;t++)e=t/(a-1),n[t]=.5*(1-Math.cos(Math.PI*e));let o=[];for(t=0;t<a;t++){e=t/(a-1);let f=Math.pow(e,3)*4+.2,p=Math.cos(f*Math.PI*2*e);o[t]=Math.abs(p*(1-e))}function u(f){let p=new Array(f.length);for(let d=0;d<f.length;d++)p[d]=1-f[d];return p}function h(f){return f.slice(0).reverse()}return{bounce:{In:u(o),Out:o},cosine:{In:i,Out:h(i)},exponential:"exponential",linear:"linear",ripple:{In:c,Out:u(c)},sine:{In:n,Out:u(n)},step:{In:r,Out:u(r)}}})(),Le=class extends z{constructor(){super(N(Le.getDefaults(),arguments));this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let t=N(Le.getDefaults(),arguments);this._volume=this.output=new Ve({context:this.context,volume:t.volume}),this.volume=this._volume.volume,lt(this,"volume")}static getDefaults(){return Object.assign(z.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){let i=this["_original_"+t]=this[t];this[t]=(...c)=>{let l=c[e],r=this.context.transport.schedule(s=>{c[e]=s,i.apply(this,c)},l);this._scheduledEvents.push(r)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,i,c){let l=this.toSeconds(i),r=this.toSeconds(e);return this.triggerAttack(t,l,c),this.triggerRelease(l+r),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}},Be=class extends Le{constructor(){super(N(Be.getDefaults(),arguments));let t=N(Be.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Le.getDefaults(),{detune:0,onsilence:J,portamento:0})}triggerAttack(t,e,i=1){this.log("triggerAttack",t,e,i);let c=this.toSeconds(e);return this._triggerEnvelopeAttack(c,i),this.setNote(t,c),this}triggerRelease(t){this.log("triggerRelease",t);let e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){let i=this.toSeconds(e),c=t instanceof Yt?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(i)>.05){let l=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(c,l,i)}else this.frequency.setValueAtTime(c,i);return this}};ae([Ee(0)],Be.prototype,"portamento",void 0);var mi=class extends ve{constructor(){super(N(mi.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="AmplitudeEnvelope",this._gainNode=new Ft({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}},ze=class extends Be{constructor(){super(N(ze.getDefaults(),arguments));this.name="Synth";let t=N(ze.getDefaults(),arguments);this.oscillator=new Gn(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new mi(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),lt(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Be.getDefaults(),{envelope:Object.assign(_a(ve.getDefaults(),Object.keys(z.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(_a(Gn.getDefaults(),[...Object.keys(Gt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),this.envelope.sustain===0){let i=this.toSeconds(this.envelope.attack),c=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+i+c)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}};var Qn=class extends ze{constructor(){super(N(Qn.getDefaults(),arguments));this.name="MembraneSynth",this.portamento=0;let t=N(Qn.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,lt(this,["oscillator","envelope"])}static getDefaults(){return Mn(Be.getDefaults(),ze.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){let i=this.toSeconds(e),c=this.toFrequency(t instanceof Yt?t.toFrequency():t),l=c*this.octaves;return this.oscillator.frequency.setValueAtTime(l,i),this.oscillator.frequency.exponentialRampToValueAtTime(c,i+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}};ae([Da(0)],Qn.prototype,"octaves",void 0);ae([Ee(0)],Qn.prototype,"pitchDecay",void 0);var Ma=new Set;function kr(a){Ma.add(a)}function Na(a,t){let e=`registerProcessor("${a}", ${t})`;Ma.add(e)}var zd=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;kr(zd);var Ud=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;kr(Ud);var Gd=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;kr(Gd);var Yd="feedback-comb-filter",Qd=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;Na(Yd,Qd);var Hn=class extends Le{constructor(){super(N(Hn.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"));this.name="Sampler",this._activeSources=new Map;let t=N(Hn.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(i=>{let c=parseInt(i,10);if(B(ii(i)||rn(c)&&isFinite(c),`url key is neither a note or midi pitch: ${i}`),ii(i)){let l=new Yt(this.context,i).toMidi();e[l]=t.urls[i]}else rn(c)&&isFinite(c)&&(e[c]=t.urls[c])}),this._buffers=new pi({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Le.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:J,onerror:J,release:.1,urls:{}})}_findClosest(t){let e=96,i=0;for(;i<e;){if(this._buffers.has(t+i))return-i;if(this._buffers.has(t-i))return i;i++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,i=1){return this.log("triggerAttack",t,e,i),Array.isArray(t)||(t=[t]),t.forEach(c=>{let l=xa(new Yt(this.context,c).toFrequency()),r=Math.round(l),s=l-r,n=this._findClosest(r),o=r-n,u=this._buffers.get(o),h=Sa(n+s),f=new Vn({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);f.start(e,0,u.duration/h,i),oe(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){let p=this._activeSources.get(r),d=p.indexOf(f);d!==-1&&p.splice(d,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(i=>{let c=new Yt(this.context,i).toMidi();if(this._activeSources.has(c)&&this._activeSources.get(c).length){let l=this._activeSources.get(c);e=this.toSeconds(e),l.forEach(r=>{r.stop(e)}),this._activeSources.set(c,[])}}),this}releaseAll(t){let e=this.toSeconds(t);return this._activeSources.forEach(i=>{for(;i.length;)i.shift().stop(e)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,i,c=1){let l=this.toSeconds(i);return this.triggerAttack(t,l,c),oe(e)?(B(oe(t),"notes must be an array when duration is array"),t.forEach((r,s)=>{let n=e[Math.min(s,e.length-1)];this.triggerRelease(r,l+this.toSeconds(n))})):this.triggerRelease(t,l+this.toSeconds(e)),this}add(t,e,i){if(B(ii(t)||isFinite(t),`note must be a pitch or midi: ${t}`),ii(t)){let c=new Yt(this.context,t).toMidi();this._buffers.add(c,e,i)}else this._buffers.add(t,e,i);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(e=>e.dispose())}),this._activeSources.clear(),this}};ae([Ee(0)],Hn.prototype,"attack",void 0);ae([Ee(0)],Hn.prototype,"release",void 0);var Ts=class extends z{constructor(){super(Object.assign(N(Ts.getDefaults(),arguments,["pan"])));this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let t=N(Ts.getDefaults(),arguments,["pan"]);this.pan=new st({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",lt(this,"pan")}static getDefaults(){return Object.assign(z.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}};var Hd="bit-crusher",Zd=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;Na(Hd,Zd);var Ag=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100];var Cg=[1687/25e3,1601/25e3,2053/25e3,2251/25e3];var ft=class extends z{constructor(){super(N(ft.getDefaults(),arguments,["solo"]));this.name="Solo";let t=N(ft.getDefaults(),arguments,["solo"]);this.input=this.output=new Ft({context:this.context}),ft._allSolos.has(this.context)||ft._allSolos.set(this.context,new Set),ft._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(z.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),ft._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){ft._soloed.has(this.context)||ft._soloed.set(this.context,new Set),ft._soloed.get(this.context).add(this)}_removeSolo(){ft._soloed.has(this.context)&&ft._soloed.get(this.context).delete(this)}_isSoloed(){return ft._soloed.has(this.context)&&ft._soloed.get(this.context).has(this)}_noSolos(){return!ft._soloed.has(this.context)||ft._soloed.has(this.context)&&ft._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ft._allSolos.get(this.context).delete(this),this._removeSolo(),this}};ft._allSolos=new Map;ft._soloed=new Map;var ks=class extends z{constructor(){super(N(ks.getDefaults(),arguments,["pan","volume"]));this.name="PanVol";let t=N(ks.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ts({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Ve({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,lt(this,["pan","volume"])}static getDefaults(){return Object.assign(z.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}},Ue=class extends z{constructor(){super(N(Ue.getDefaults(),arguments,["volume","pan"]));this.name="Channel";let t=N(Ue.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new ft({solo:t.solo,context:this.context}),this._panVol=this.output=new ks({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),lt(this,["pan","volume"])}static getDefaults(){return Object.assign(z.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return Ue.buses.has(t)||Ue.buses.set(t,new Ft({context:this.context})),Ue.buses.get(t)}send(t,e=0){let i=this._getBus(t),c=new Ft({context:this.context,units:"decibels",gain:e});return this.connect(c),c.connect(i),c}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}};Ue.buses=new Map;var Ia=class extends z{constructor(){super(...arguments);this.name="Listener",this.positionX=new st({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new st({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new st({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new st({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new st({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new st({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new st({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new st({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new st({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(z.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};ai(a=>{a.listener=new Ia({context:a})});ci(a=>{a.listener.dispose()});function Ar(){return Jt().now()}var Eg=Jt().transport;var Dg=Jt().destination,Mg=Jt().destination;var Ng=Jt().listener;var Ig=Jt().draw;var Pg=Jt();var Zn=[];function Xd(a,t=kt){let e,i=[];function c(s){if(At(a,s)&&(a=s,e)){let n=!Zn.length;for(let o=0;o<i.length;o+=1){let u=i[o];u[1](),Zn.push(u,a)}if(n){for(let o=0;o<Zn.length;o+=2)Zn[o][0](Zn[o+1]);Zn.length=0}}}function l(s){c(s(a))}function r(s,n=kt){let o=[s,n];return i.push(o),i.length===1&&(e=t(c)||kt),s(a),()=>{let u=i.indexOf(o);u!==-1&&i.splice(u,1),i.length===0&&(e(),e=null)}}return{set:c,update:l,subscribe:r}}function Pa(a){return Object.prototype.toString.call(a)==="[object Date]"}function Cr(a,t,e,i){if(typeof e=="number"||Pa(e)){let c=i-e,l=(e-t)/(a.dt||1/60),r=a.opts.stiffness*c,s=a.opts.damping*l,n=(r-s)*a.inv_mass,o=(l+n)*a.dt;return Math.abs(o)<a.opts.precision&&Math.abs(c)<a.opts.precision?i:(a.settled=!1,Pa(e)?new Date(e.getTime()+o):e+o)}else{if(Array.isArray(e))return e.map((c,l)=>Cr(a,t[l],e[l],i[l]));if(typeof e=="object"){let c={};for(let l in e)c[l]=Cr(a,t[l],e[l],i[l]);return c}else throw new Error(`Cannot spring ${typeof e} values`)}}function Xn(a,t={}){let e=Xd(a),{stiffness:i=.15,damping:c=.8,precision:l=.01}=t,r,s,n,o=a,u=a,h=1,f=0,p=!1;function d(y,m={}){u=y;let b=n={};if(a==null||m.hard||_.stiffness>=1&&_.damping>=1)return p=!0,r=Fi(),o=y,e.set(a=u),Promise.resolve();if(m.soft){let k=m.soft===!0?.5:+m.soft;f=1/(k*60),h=0}return s||(r=Fi(),p=!1,s=$r(k=>{if(p)return p=!1,s=null,!1;h=Math.min(h+f,1);let x={inv_mass:h,opts:_,settled:!0,dt:(k-r)*60/1e3},g=Cr(x,o,a,u);return r=k,o=a,e.set(a=g),x.settled&&(s=null),!x.settled})),new Promise(k=>{s.promise.then(()=>{b===n&&k()})})}let _={set:d,update:(y,m)=>d(y(u,a),m),subscribe:e.subscribe,stiffness:i,damping:c,precision:l};return _}var De=["red","yellow","green","blue","purple","pink"];function As(a){return a==="white"?"bg-white":`bg-${a}-100`}function Kd(a){let t,e,i=`0x${a[0].toString(16).padStart(2,"0")}`,c,l,r,s,n,o,u,h,f,p,d,_,y,m,b,k;return{c(){t=K("div"),e=K("div"),c=$e(i),r=Pt(),s=K("div"),n=K("div"),u=Pt(),h=K("div"),f=Pt(),p=K("div"),d=Pt(),_=K("div"),y=Pt(),m=K("div"),H(e,"class",l="absolute w-full h-full text-xs z-50 flex justify-center items-center "+(a[1]<=1&&a[2]?"":"invisible")),H(n,"class",o="absolute h-full w-full text-xs rounded-md border-2 border-gray-400 justify-end items-end bg-opacity-70 "+(a[1]>1?As(a[16]):"")),Et(n,"transform","scale("+a[5]+")"),Et(n,"z-index","10"),H(h,"class","absolute h-full w-full rounded-md border-2 border-blue-300"),Et(h,"transform","scale("+a[6]+")"),Et(h,"z-index","9"),H(p,"class","absolute h-full w-full rounded-md border-2 border-green-300"),Et(p,"transform","scale("+a[7]+")"),Et(p,"z-index","8"),H(_,"class","absolute h-full w-full rounded-md border-2 border-red-300"),Et(_,"transform","scale("+a[8]+")"),Et(_,"z-index","7"),H(m,"class","absolute h-full w-full rounded-md border-2 border-yellow-400"),Et(m,"transform","scale("+a[9]+")"),Et(m,"z-index","6"),H(s,"class","relative h-full w-full"),H(t,"class","relative h-9 w-9 self-center cursor-pointer rounded-md hover:bg-white")},m(x,g){Ot(x,t,g),X(t,e),X(e,c),X(t,r),X(t,s),X(s,n),X(s,u),X(s,h),X(s,f),X(s,p),X(s,d),X(s,_),X(s,y),X(s,m),b||(k=[Ct(window,"mouseup",a[21]),Ct(t,"mouseenter",a[22]),Ct(t,"mouseleave",a[23]),Ct(t,"mousedown",a[24]),Ct(t,"mouseup",function(){Ke(a[3]?a[18]:void 0)&&(a[3]?a[18]:void 0).apply(this,arguments)}),Ct(t,"mousemove",function(){Ke(a[3]?a[17]:void 0)&&(a[3]?a[17]:void 0).apply(this,arguments)})],b=!0)},p(x,[g]){a=x,g&1&&i!==(i=`0x${a[0].toString(16).padStart(2,"0")}`)&&qi(c,i),g&6&&l!==(l="absolute w-full h-full text-xs z-50 flex justify-center items-center "+(a[1]<=1&&a[2]?"":"invisible"))&&H(e,"class",l),g&2&&o!==(o="absolute h-full w-full text-xs rounded-md border-2 border-gray-400 justify-end items-end bg-opacity-70 "+(a[1]>1?As(a[16]):""))&&H(n,"class",o),g&32&&Et(n,"transform","scale("+a[5]+")"),g&64&&Et(h,"transform","scale("+a[6]+")"),g&128&&Et(p,"transform","scale("+a[7]+")"),g&256&&Et(_,"transform","scale("+a[8]+")"),g&512&&Et(m,"transform","scale("+a[9]+")")},i:kt,o:kt,d(x){x&&wt(t),b=!1,fe(k)}}}function Jd(a){return a===!1?1:a===!0?1.25:a}function $d(a,t,e){let i,c,l,r,s,{playing:n=!1}=t,{index:o}=t,{draggable:u=!1}=t,h=rs(),f=Xn(1,{stiffness:.09,damping:.125});ee(a,f,E=>e(5,i=E));let p=Xn(1,{stiffness:.08,damping:.125});ee(a,p,E=>e(6,c=E));let d=Xn(1,{stiffness:.07,damping:.125});ee(a,d,E=>e(7,l=E));let _=Xn(1,{stiffness:.06,damping:.125});ee(a,_,E=>e(8,r=E));let y=Xn(1,{stiffness:.05,damping:.125});ee(a,y,E=>e(9,s=E));let m=De[Math.floor(Math.random()*De.length)],b=[f,p,d,_,y],k=!1,x=!1,g=!1;function A(E){return x&&(g||(h("dragStart",{event:o}),e(4,g=!0))),E.preventDefault(),!1}function T(E){x&&(g&&h("dragEnd",{event:o}),h("play",{event:o}),e(4,g=!1),e(3,x=!1))}let O,w=()=>{g&&h("dragEnd",{event:o}),e(4,g=!1),e(3,x=!1)},M=()=>e(2,k=!0),D=()=>e(2,k=!1),C=E=>(e(3,x=!0),E.preventDefault(),!1);return a.$$set=E=>{"playing"in E&&e(19,n=E.playing),"index"in E&&e(0,o=E.index),"draggable"in E&&e(20,u=E.draggable)},a.$$.update=()=>{if(a.$$.dirty&524288){t:e(1,O=Jd(n))}if(a.$$.dirty&2){t:b.forEach(E=>E.set(O))}},[o,O,k,x,g,i,c,l,r,s,h,f,p,d,_,y,m,A,T,n,u,w,M,D,C]}var ja=class extends jt{constructor(t){super();qt(this,t,$d,Kd,At,{playing:19,index:0,draggable:20})}},Ra=ja;function Fa(a,t,e){let i=a.slice();return i[4]=t[e],i[6]=e,i}function qa(a,t,e){let i=a.slice();return i[4]=t[e],i[6]=e,i}function Va(a){let t,e=`0x${a[6].toString(16).padStart(2,"0")}`,i;return{c(){t=K("div"),i=$e(e),H(t,"class","text-xs z-50 flex justify-end items-end h-9 w-9 relative")},m(c,l){Ot(c,t,l),X(t,i)},p:kt,d(c){c&&wt(t)}}}function t_(a){let t,e=`0x${a[6].toString(16).padStart(2,"0")}`,i;return{c(){t=K("div"),i=$e(e),H(t,"class","text-xs z-50 flex justify-end items-end p-1  h-9 w-9 relative")},m(c,l){Ot(c,t,l),X(t,i)},d(c){c&&wt(t)}}}function Wa(a){let t,e,i,c=a[6]%16==0&&t_(a);return e=new Ra({props:{playing:a[4],index:a[6]}}),e.$on("dragStart",a[1]),e.$on("dragEnd",a[2]),e.$on("play",a[3]),{c(){c&&c.c(),t=Pt(),ne(e.$$.fragment)},m(l,r){c&&c.m(l,r),Ot(l,t,r),Zt(e,l,r),i=!0},p(l,r){let s={};r&1&&(s.playing=l[4]),e.$set(s)},i(l){i||(at(e.$$.fragment,l),i=!0)},o(l){St(e.$$.fragment,l),i=!1},d(l){c&&c.d(l),l&&wt(t),Xt(e,l)}}}function e_(a){let t,e,i,c,l,r,s=a[0].slice(0,16),n=[];for(let f=0;f<s.length;f+=1)n[f]=Va(qa(a,s,f));let o=a[0],u=[];for(let f=0;f<o.length;f+=1)u[f]=Wa(Fa(a,o,f));let h=f=>St(u[f],1,1,()=>{u[f]=null});return{c(){t=K("div"),e=K("div"),i=K("div"),i.textContent="<3",c=Pt();for(let f=0;f<n.length;f+=1)n[f].c();l=Pt();for(let f=0;f<u.length;f+=1)u[f].c();H(i,"class","text-xs z-50 flex justify-center items-end"),H(e,"class","grid grid-cols-17 grid-rows-9 gap-4")},m(f,p){Ot(f,t,p),X(t,e),X(e,i),X(e,c);for(let d=0;d<n.length;d+=1)n[d].m(e,null);X(e,l);for(let d=0;d<u.length;d+=1)u[d].m(e,null);r=!0},p(f,[p]){if(p&1){s=f[0].slice(0,16);let d;for(d=0;d<s.length;d+=1){let _=qa(f,s,d);n[d]?n[d].p(_,p):(n[d]=Va(_),n[d].c(),n[d].m(e,l))}for(;d<n.length;d+=1)n[d].d(1);n.length=s.length}if(p&1){o=f[0];let d;for(d=0;d<o.length;d+=1){let _=Fa(f,o,d);u[d]?(u[d].p(_,p),at(u[d],1)):(u[d]=Wa(_),u[d].c(),at(u[d],1),u[d].m(e,null))}for(vn(),d=o.length;d<u.length;d+=1)h(d);wn()}},i(f){if(!r){for(let p=0;p<o.length;p+=1)at(u[p]);r=!0}},o(f){u=u.filter(Boolean);for(let p=0;p<u.length;p+=1)St(u[p]);r=!1},d(f){f&&wt(t),Je(n,f),Je(u,f)}}}function n_(a,t,e){let{playing:i=new Array(128).fill(!1)}=t;function c(s){xe(a,s)}function l(s){xe(a,s)}function r(s){xe(a,s)}return a.$$set=s=>{"playing"in s&&e(0,i=s.playing)},[i,c,l,r]}var La=class extends jt{constructor(t){super();qt(this,t,n_,e_,At,{playing:0})}},Ba=La;function s_(a){let t,e,i,c;return{c(){t=K("div"),H(t,"class",e=a[7](a[0],a[1],a[2],a[3])+" outline-none "+za(a[0],a[1],a[2],a[3])),H(t,"contenteditable",""),a[5]===void 0&&bn(()=>a[17].call(t))},m(l,r){Ot(l,t,r),a[16](t),a[5]!==void 0&&(t.textContent=a[5]),i||(c=[Ct(window,"keydown",a[15]),Ct(t,"mouseup",function(){Ke(a[4]!==void 0?a[11](a[4]):void 0)&&(a[4]!==void 0?a[11](a[4]):void 0).apply(this,arguments)}),Ct(t,"focus",a[9]),Ct(t,"blur",a[8]),Ct(t,"keydown",a[10]),Ct(t,"input",a[17])],i=!0)},p(l,[r]){a=l,r&15&&e!==(e=a[7](a[0],a[1],a[2],a[3])+" outline-none "+za(a[0],a[1],a[2],a[3]))&&H(t,"class",e),r&32&&a[5]!==t.textContent&&(t.textContent=a[5])},i:kt,o:kt,d(l){l&&wt(t),a[16](null),i=!1,fe(c)}}}function yi(a){return a<0||a>127?"-":`0x${a.toString(16).padStart(2,"0")}`}function za(a,t,e,i){return a===i&&t===e?" border border-white ":" p-px "}function i_(a,t,e){let{event:i}=t,{col:c}=t,{row:l}=t,{activeRow:r}=t,{activeCol:s}=t,{rowCount:n}=t,{dragging:o=void 0}=t,u,h=rs(),f;function p(w,M,D,C){return w===C?M===D?As(u):"bg-gray-200":""}let d;function _(){try{let w=parseInt(f,16);isNaN(w)?y?(e(5,f=y),y=""):e(5,f=yi(i)):(e(5,f=yi(w)),h("setEvent",{event:parseInt(f,16),col:c,row:l,nextActive:d}))}catch{y?(e(5,f=y),y=""):e(5,f=yi(i))}d=void 0}let y="";function m(){f!=="-"&&(y=f),e(5,f=""),h("focus",{col:c,row:l})}function b(w){return w.key==="Enter"||w.key==="Tab"?(w.preventDefault(),w.shiftKey?w.key==="Enter"?d={row:l>0?l-1:n-1,col:c}:d={col:c>0?c-1:3,row:l}:w.key==="Enter"?d={row:(l+1)%n,col:c}:d={col:(c+1)%4,row:l},w.target?.blur()):d=void 0,w.stopPropagation(),w.key!=="Enter"}function k(w){h("drop",{col:c,row:l,event:w})}let x;function g(w,M,D,C,E){if(!(document.activeElement!=null&&document.activeElement!=document.body)){if(w.key===" ")return!1;if(w.key==="Shift")return!0;if(w.key==="Enter"||w.key==="Tab")return w.preventDefault(),!1;if(w.key!=="x"&&isNaN(parseInt(w.key))&&w.key!=="d")return!1;if(M===E&&D===C){if(w.key==="d")return y="",h("setEvent",{event:-1,col:M,row:D}),!1;x.focus()}return w.key!=="Enter"}}let A=w=>g(w,c,l,r,s);function T(w){as[w?"unshift":"push"](()=>{x=w,e(6,x)})}function O(){f=this.textContent,e(5,f),e(13,i)}a.$$set=w=>{"event"in w&&e(13,i=w.event),"col"in w&&e(0,c=w.col),"row"in w&&e(1,l=w.row),"activeRow"in w&&e(2,r=w.activeRow),"activeCol"in w&&e(3,s=w.activeCol),"rowCount"in w&&e(14,n=w.rowCount),"dragging"in w&&e(4,o=w.dragging)},a.$$.update=()=>{if(a.$$.dirty&8192){t:e(5,f=yi(i))}};t:u=De[Math.floor(Math.random()*De.length)];return[c,l,r,s,o,f,x,p,_,m,b,k,g,i,n,A,T,O]}var Ua=class extends jt{constructor(t){super();qt(this,t,i_,s_,At,{event:13,col:0,row:1,activeRow:2,activeCol:3,rowCount:14,dragging:4})}},Ga=Ua;function Ya(a,t,e){let i=a.slice();return i[9]=t[e],i[11]=e,i}function Qa(a,t,e){let i=a.slice();return i[12]=t[e],i[14]=e,i}function Ha(a){let t,e;return t=new Ga({props:{event:a[12],activeCol:a[2],activeRow:a[1],col:a[14],dragging:a[4],row:a[11],rowCount:a[0].length}}),t.$on("setEvent",a[6]),t.$on("focus",a[7]),t.$on("drop",a[8]),{c(){ne(t.$$.fragment)},m(i,c){Zt(t,i,c),e=!0},p(i,c){let l={};c&1&&(l.event=i[12]),c&4&&(l.activeCol=i[2]),c&2&&(l.activeRow=i[1]),c&16&&(l.dragging=i[4]),c&1&&(l.rowCount=i[0].length),t.$set(l)},i(i){e||(at(t.$$.fragment,i),e=!0)},o(i){St(t.$$.fragment,i),e=!1},d(i){Xt(t,i)}}}function Xa(a){let t,e,i,c,l=a[9],r=[];for(let n=0;n<l.length;n+=1)r[n]=Ha(Qa(a,l,n));let s=n=>St(r[n],1,1,()=>{r[n]=null});return{c(){t=K("div");for(let n=0;n<r.length;n+=1)r[n].c();e=Pt(),H(t,"class",i="grid grid-cols-4 grid-rows-1 gap-8 text-sm border-l-8 border-r-8 border-t "+Za(a[11],a[3],a[1])+" "+a[5](a[11],a[3]))},m(n,o){Ot(n,t,o);for(let u=0;u<r.length;u+=1)r[u].m(t,null);X(t,e),c=!0},p(n,o){if(o&23){l=n[9];let u;for(u=0;u<l.length;u+=1){let h=Qa(n,l,u);r[u]?(r[u].p(h,o),at(r[u],1)):(r[u]=Ha(h),r[u].c(),at(r[u],1),r[u].m(t,e))}for(vn(),u=l.length;u<r.length;u+=1)s(u);wn()}(!c||o&10&&i!==(i="grid grid-cols-4 grid-rows-1 gap-8 text-sm border-l-8 border-r-8 border-t "+Za(n[11],n[3],n[1])+" "+n[5](n[11],n[3])))&&H(t,"class",i)},i(n){if(!c){for(let o=0;o<l.length;o+=1)at(r[o]);c=!0}},o(n){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)St(r[o]);c=!1},d(n){n&&wt(t),Je(r,n)}}}function r_(a){let t,e,i,c,l,r=a[0],s=[];for(let o=0;o<r.length;o+=1)s[o]=Xa(Ya(a,r,o));let n=o=>St(s[o],1,1,()=>{s[o]=null});return{c(){t=K("div"),e=K("div"),e.innerHTML=`<div>track 1.</div> 
    <div>track 2.</div> 
    <div>track 3.</div> 
    <div>track 4.</div>`,i=Pt(),c=K("div");for(let o=0;o<s.length;o+=1)s[o].c();H(e,"class","grid grid-cols-4 grid-rows-1 border-b-2 gap-8 border-gray-500 py-1 text-sm"),H(c,"class","overflow-scroll"),H(t,"class","flex flex-col relative w-full h-full")},m(o,u){Ot(o,t,u),X(t,e),X(t,i),X(t,c);for(let h=0;h<s.length;h+=1)s[h].m(c,null);l=!0},p(o,[u]){if(u&63){r=o[0];let h;for(h=0;h<r.length;h+=1){let f=Ya(o,r,h);s[h]?(s[h].p(f,u),at(s[h],1)):(s[h]=Xa(f),s[h].c(),at(s[h],1),s[h].m(c,null))}for(vn(),h=r.length;h<s.length;h+=1)n(h);wn()}},i(o){if(!l){for(let u=0;u<r.length;u+=1)at(s[u]);l=!0}},o(o){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)St(s[u]);l=!1},d(o){o&&wt(t),Je(s,o)}}}function Za(a,t,e){let i="";return t!==void 0&&a<t&&(i+=" transition-all "),a===e?i+"bg-gray-200":i}function o_(a,t,e){let{tracker:i=[]}=t,{activeRow:c=0}=t,{activeCol:l=0}=t,{playingRow:r=void 0}=t,{dragging:s=void 0}=t;function n(f,p){return f===p?` border-${De[f%De.length]}-100 `:f===0?"border-gray-200":f%8==0?"border-t border-gray-500":f%4==0?"border-t border-gray-400":f%2==0?"border-t border-gray-300":"border-gray-200"}function o(f){xe(a,f)}function u(f){xe(a,f)}function h(f){xe(a,f)}return a.$$set=f=>{"tracker"in f&&e(0,i=f.tracker),"activeRow"in f&&e(1,c=f.activeRow),"activeCol"in f&&e(2,l=f.activeCol),"playingRow"in f&&e(3,r=f.playingRow),"dragging"in f&&e(4,s=f.dragging)},[i,c,l,r,s,n,o,u,h]}var Ka=class extends jt{constructor(t){super();qt(this,t,o_,r_,At,{tracker:0,activeRow:1,activeCol:2,playingRow:3,dragging:4})}},Ja=Ka;var Er=function(a,t){return Er=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var c in i)i.hasOwnProperty(c)&&(e[c]=i[c])},Er(a,t)};function Qt(a,t){Er(a,t);function e(){this.constructor=a}a.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Dr(a){return typeof a=="function"}var $a=!1,we={Promise:void 0,set useDeprecatedSynchronousErrorHandling(a){if(a){var t=new Error;""+t.stack}$a=a},get useDeprecatedSynchronousErrorHandling(){return $a}};function Kn(a){setTimeout(function(){throw a},0)}var gi={closed:!0,next:function(a){},error:function(a){if(we.useDeprecatedSynchronousErrorHandling)throw a;Kn(a)},complete:function(){}},Mr=function(){return Array.isArray||function(a){return a&&typeof a.length=="number"}}();function tc(a){return a!==null&&typeof a=="object"}var a_=function(){function a(t){return Error.call(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(e,i){return i+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t,this}return a.prototype=Object.create(Error.prototype),a}(),bi=a_,fn=function(){function a(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return a.prototype.unsubscribe=function(){var t;if(!this.closed){var e=this,i=e._parentOrParents,c=e._ctorUnsubscribe,l=e._unsubscribe,r=e._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof a)i.remove(this);else if(i!==null)for(var s=0;s<i.length;++s){var n=i[s];n.remove(this)}if(Dr(l)){c&&(this._unsubscribe=void 0);try{l.call(this)}catch(h){t=h instanceof bi?ec(h.errors):[h]}}if(Mr(r))for(var s=-1,o=r.length;++s<o;){var u=r[s];if(tc(u))try{u.unsubscribe()}catch(f){t=t||[],f instanceof bi?t=t.concat(ec(f.errors)):t.push(f)}}if(t)throw new bi(t)}},a.prototype.add=function(t){var e=t;if(!t)return a.EMPTY;switch(typeof t){case"function":e=new a(t);case"object":if(e===this||e.closed||typeof e.unsubscribe!="function")return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof a)){var i=e;e=new a,e._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var c=e._parentOrParents;if(c===null)e._parentOrParents=this;else if(c instanceof a){if(c===this)return e;e._parentOrParents=[c,this]}else if(c.indexOf(this)===-1)c.push(this);else return e;var l=this._subscriptions;return l===null?this._subscriptions=[e]:l.push(e),e},a.prototype.remove=function(t){var e=this._subscriptions;if(e){var i=e.indexOf(t);i!==-1&&e.splice(i,1)}},a.EMPTY=function(t){return t.closed=!0,t}(new a),a}();function ec(a){return a.reduce(function(t,e){return t.concat(e instanceof bi?e.errors:e)},[])}var vi=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Ge=function(a){Qt(t,a);function t(e,i,c){var l=a.call(this)||this;switch(l.syncErrorValue=null,l.syncErrorThrown=!1,l.syncErrorThrowable=!1,l.isStopped=!1,arguments.length){case 0:l.destination=gi;break;case 1:if(!e){l.destination=gi;break}if(typeof e=="object"){e instanceof t?(l.syncErrorThrowable=e.syncErrorThrowable,l.destination=e,e.add(l)):(l.syncErrorThrowable=!0,l.destination=new nc(l,e));break}default:l.syncErrorThrowable=!0,l.destination=new nc(l,e,i,c);break}return l}return t.prototype[vi]=function(){return this},t.create=function(e,i,c){var l=new t(e,i,c);return l.syncErrorThrowable=!1,l},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,a.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(fn),nc=function(a){Qt(t,a);function t(e,i,c,l){var r=a.call(this)||this;r._parentSubscriber=e;var s,n=r;return Dr(i)?s=i:i&&(s=i.next,c=i.error,l=i.complete,i!==gi&&(n=Object.create(i),Dr(n.unsubscribe)&&r.add(n.unsubscribe.bind(n)),n.unsubscribe=r.unsubscribe.bind(r))),r._context=n,r._next=s,r._error=c,r._complete=l,r}return t.prototype.next=function(e){if(!this.isStopped&&this._next){var i=this._parentSubscriber;!we.useDeprecatedSynchronousErrorHandling||!i.syncErrorThrowable?this.__tryOrUnsub(this._next,e):this.__tryOrSetError(i,this._next,e)&&this.unsubscribe()}},t.prototype.error=function(e){if(!this.isStopped){var i=this._parentSubscriber,c=we.useDeprecatedSynchronousErrorHandling;if(this._error)!c||!i.syncErrorThrowable?(this.__tryOrUnsub(this._error,e),this.unsubscribe()):(this.__tryOrSetError(i,this._error,e),this.unsubscribe());else if(i.syncErrorThrowable)c?(i.syncErrorValue=e,i.syncErrorThrown=!0):Kn(e),this.unsubscribe();else{if(this.unsubscribe(),c)throw e;Kn(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var i=this._parentSubscriber;if(this._complete){var c=function(){return e._complete.call(e._context)};!we.useDeprecatedSynchronousErrorHandling||!i.syncErrorThrowable?(this.__tryOrUnsub(c),this.unsubscribe()):(this.__tryOrSetError(i,c),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,i){try{e.call(this._context,i)}catch(c){if(this.unsubscribe(),we.useDeprecatedSynchronousErrorHandling)throw c;Kn(c)}},t.prototype.__tryOrSetError=function(e,i,c){if(!we.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{i.call(this._context,c)}catch(l){return we.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=l,e.syncErrorThrown=!0,!0):(Kn(l),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Ge);function c_(a){for(;a;){var t=a,e=t.closed,i=t.destination,c=t.isStopped;if(e||c)return!1;i&&i instanceof Ge?a=i:a=null}return!0}function u_(a,t,e){if(a){if(a instanceof Ge)return a;if(a[vi])return a[vi]()}return!a&&!t&&!e?new Ge(gi):new Ge(a,t,e)}var Nr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function l_(a){return a}function h_(a){return a.length===0?l_:a.length===1?a[0]:function(e){return a.reduce(function(i,c){return c(i)},e)}}var Jn=function(){function a(t){this._isScalar=!1,t&&(this._subscribe=t)}return a.prototype.lift=function(t){var e=new a;return e.source=this,e.operator=t,e},a.prototype.subscribe=function(t,e,i){var c=this.operator,l=u_(t,e,i);if(c?l.add(c.call(l,this.source)):l.add(this.source||we.useDeprecatedSynchronousErrorHandling&&!l.syncErrorThrowable?this._subscribe(l):this._trySubscribe(l)),we.useDeprecatedSynchronousErrorHandling&&l.syncErrorThrowable&&(l.syncErrorThrowable=!1,l.syncErrorThrown))throw l.syncErrorValue;return l},a.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){we.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),c_(t)?t.error(e):console.warn(e)}},a.prototype.forEach=function(t,e){var i=this;return e=sc(e),new e(function(c,l){var r;r=i.subscribe(function(s){try{t(s)}catch(n){l(n),r&&r.unsubscribe()}},l,c)})},a.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},a.prototype[Nr]=function(){return this},a.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length===0?this:h_(t)(this)},a.prototype.toPromise=function(t){var e=this;return t=sc(t),new t(function(i,c){var l;e.subscribe(function(r){return l=r},function(r){return c(r)},function(){return i(l)})})},a.create=function(t){return new a(t)},a}();function sc(a){if(a||(a=Promise),!a)throw new Error("no Promise impl found");return a}var f_=function(){function a(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return a.prototype=Object.create(Error.prototype),a}(),$n=f_,p_=function(a){Qt(t,a);function t(e,i){var c=a.call(this)||this;return c.subject=e,c.subscriber=i,c.closed=!1,c}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,i=e.observers;if(this.subject=null,!(!i||i.length===0||e.isStopped||e.closed)){var c=i.indexOf(this.subscriber);c!==-1&&i.splice(c,1)}}},t}(fn),d_=function(a){Qt(t,a);function t(e){var i=a.call(this,e)||this;return i.destination=e,i}return t}(Ge),rc=function(a){Qt(t,a);function t(){var e=a.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return t.prototype[vi]=function(){return new d_(this)},t.prototype.lift=function(e){var i=new ic(this,this);return i.operator=e,i},t.prototype.next=function(e){if(this.closed)throw new $n;if(!this.isStopped)for(var i=this.observers,c=i.length,l=i.slice(),r=0;r<c;r++)l[r].next(e)},t.prototype.error=function(e){if(this.closed)throw new $n;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var i=this.observers,c=i.length,l=i.slice(),r=0;r<c;r++)l[r].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new $n;this.isStopped=!0;for(var e=this.observers,i=e.length,c=e.slice(),l=0;l<i;l++)c[l].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(e){if(this.closed)throw new $n;return a.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){if(this.closed)throw new $n;return this.hasError?(e.error(this.thrownError),fn.EMPTY):this.isStopped?(e.complete(),fn.EMPTY):(this.observers.push(e),new p_(this,e))},t.prototype.asObservable=function(){var e=new Jn;return e.source=this,e},t.create=function(e,i){return new ic(e,i)},t}(Jn),ic=function(a){Qt(t,a);function t(e,i){var c=a.call(this)||this;return c.destination=e,c.source=i,c}return t.prototype.next=function(e){var i=this.destination;i&&i.next&&i.next(e)},t.prototype.error=function(e){var i=this.destination;i&&i.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){var i=this.source;return i?this.source.subscribe(e):fn.EMPTY},t}(rc),wi=function(a){Qt(t,a);function t(e){var i=a.call(this)||this;return i._value=e,i}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(e){var i=a.prototype._subscribe.call(this,e);return i&&!i.closed&&e.next(this._value),i},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $n;return this._value},t.prototype.next=function(e){a.prototype.next.call(this,this._value=e)},t}(rc),__=function(a){Qt(t,a);function t(e,i){return a.call(this)||this}return t.prototype.schedule=function(e,i){return this},t}(fn),m_=function(a){Qt(t,a);function t(e,i){var c=a.call(this,e,i)||this;return c.scheduler=e,c.work=i,c.pending=!1,c}return t.prototype.schedule=function(e,i){if(i===void 0&&(i=0),this.closed)return this;this.state=e;var c=this.id,l=this.scheduler;return c!=null&&(this.id=this.recycleAsyncId(l,c,i)),this.pending=!0,this.delay=i,this.id=this.id||this.requestAsyncId(l,this.id,i),this},t.prototype.requestAsyncId=function(e,i,c){return c===void 0&&(c=0),setInterval(e.flush.bind(e,this),c)},t.prototype.recycleAsyncId=function(e,i,c){if(c===void 0&&(c=0),c!==null&&this.delay===c&&this.pending===!1)return i;clearInterval(i)},t.prototype.execute=function(e,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var c=this._execute(e,i);if(c)return c;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,i){var c=!1,l=void 0;try{this.work(e)}catch(r){c=!0,l=!!r&&r||new Error(r)}if(c)return this.unsubscribe(),l},t.prototype._unsubscribe=function(){var e=this.id,i=this.scheduler,c=i.actions,l=c.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,l!==-1&&c.splice(l,1),e!=null&&(this.id=this.recycleAsyncId(i,e,null)),this.delay=null},t}(__),oc=function(){function a(t,e){e===void 0&&(e=a.now),this.SchedulerAction=t,this.now=e}return a.prototype.schedule=function(t,e,i){return e===void 0&&(e=0),new this.SchedulerAction(this,t).schedule(i,e)},a.now=function(){return Date.now()},a}(),y_=function(a){Qt(t,a);function t(e,i){i===void 0&&(i=oc.now);var c=a.call(this,e,function(){return t.delegate&&t.delegate!==c?t.delegate.now():i()})||this;return c.actions=[],c.active=!1,c.scheduled=void 0,c}return t.prototype.schedule=function(e,i,c){return i===void 0&&(i=0),t.delegate&&t.delegate!==this?t.delegate.schedule(e,i,c):a.prototype.schedule.call(this,e,i,c)},t.prototype.flush=function(e){var i=this.actions;if(this.active){i.push(e);return}var c;this.active=!0;do if(c=e.execute(e.state,e.delay))break;while(e=i.shift());if(this.active=!1,c){for(;e=i.shift();)e.unsubscribe();throw c}},t}(oc);function ac(a){return a&&typeof a.schedule=="function"}var cc=function(a){return function(t){for(var e=0,i=a.length;e<i&&!t.closed;e++)t.next(a[e]);t.complete()}};function uc(a,t){return new Jn(function(e){var i=new fn,c=0;return i.add(t.schedule(function(){if(c===a.length){e.complete();return}e.next(a[c++]),e.closed||i.add(this.schedule())})),i})}function lc(a,t){return t?uc(a,t):new Jn(cc(a))}function hc(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];var e=a[a.length-1];return ac(e)?(a.pop(),uc(a,e)):lc(a)}var g_=new y_(m_),fc=g_,b_=function(a){Qt(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.notifyNext=function(e,i,c,l,r){this.destination.next(i)},t.prototype.notifyError=function(e,i){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Ge),v_=function(a){Qt(t,a);function t(e,i,c){var l=a.call(this)||this;return l.parent=e,l.outerValue=i,l.outerIndex=c,l.index=0,l}return t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Ge),w_=function(a){return function(t){return a.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Kn),t}};function S_(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var pc=S_(),x_=function(a){return function(t){var e=a[pc]();do{var i=void 0;try{i=e.next()}catch(c){return t.error(c),t}if(i.done){t.complete();break}if(t.next(i.value),t.closed)break}while(!0);return typeof e.return=="function"&&t.add(function(){e.return&&e.return()}),t}},O_=function(a){return function(t){var e=a[Nr]();if(typeof e.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)}},T_=function(a){return a&&typeof a.length=="number"&&typeof a!="function"};function k_(a){return!!a&&typeof a.subscribe!="function"&&typeof a.then=="function"}var A_=function(a){if(!!a&&typeof a[Nr]=="function")return O_(a);if(T_(a))return cc(a);if(k_(a))return w_(a);if(!!a&&typeof a[pc]=="function")return x_(a);var t=tc(a)?"an invalid object":"'"+a+"'",e="You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(e)};function C_(a,t,e,i,c){if(c===void 0&&(c=new v_(a,e,i)),!c.closed)return t instanceof Jn?t.subscribe(c):A_(t)(c)}var dc={};function Ir(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];var e=void 0,i=void 0;return ac(a[a.length-1])&&(i=a.pop()),typeof a[a.length-1]=="function"&&(e=a.pop()),a.length===1&&Mr(a[0])&&(a=a[0]),lc(a,i).lift(new E_(e))}var E_=function(){function a(t){this.resultSelector=t}return a.prototype.call=function(t,e){return e.subscribe(new D_(t,this.resultSelector))},a}(),D_=function(a){Qt(t,a);function t(e,i){var c=a.call(this,e)||this;return c.resultSelector=i,c.active=0,c.values=[],c.observables=[],c}return t.prototype._next=function(e){this.values.push(dc),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,i=e.length;if(i===0)this.destination.complete();else{this.active=i,this.toRespond=i;for(var c=0;c<i;c++){var l=e[c];this.add(C_(this,l,void 0,c))}}},t.prototype.notifyComplete=function(e){(this.active-=1)===0&&this.destination.complete()},t.prototype.notifyNext=function(e,i,c){var l=this.values,r=l[c],s=this.toRespond?r===dc?--this.toRespond:this.toRespond:0;l[c]=i,s===0&&(this.resultSelector?this._tryResultSelector(l):this.destination.next(l.slice()))},t.prototype._tryResultSelector=function(e){var i;try{i=this.resultSelector.apply(this,e)}catch(c){this.destination.error(c);return}this.destination.next(i)},t}(b_);function M_(a){return!Mr(a)&&a-parseFloat(a)+1>=0}function _c(a,t){return a===void 0&&(a=0),t===void 0&&(t=fc),(!M_(a)||a<0)&&(a=0),(!t||typeof t.schedule!="function")&&(t=fc),new Jn(function(e){return e.add(t.schedule(N_,a,{subscriber:e,counter:0,period:a})),e})}function N_(a){var t=a.subscriber,e=a.counter,i=a.period;t.next(e),this.schedule({subscriber:t,counter:e+1,period:i},i)}var S=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function v(a,t,e){return e={path:t,exports:{},require:function(i,c){return I_(i,c??e.path)}},a(e,e.exports),e.exports}function I_(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Si=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return typeof i=="function"}t.isFunction=e}),le=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=!1;t.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(i){if(i){var c=new Error;console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+c.stack)}else e&&console.log("RxJS: Back to a better error behavior. Thank you. <3");e=i},get useDeprecatedSynchronousErrorHandling(){return e}}}),ts=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){setTimeout(function(){throw i},0)}t.hostReportError=e}),xi=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.empty={closed:!0,next:function(e){},error:function(e){if(le.config.useDeprecatedSynchronousErrorHandling)throw e;ts.hostReportError(e)},complete:function(){}}}),Me=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=function(){return Array.isArray||function(e){return e&&typeof e.length=="number"}}()}),mc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i!==null&&typeof i=="object"}t.isObject=e}),Oi=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function i(c){return Error.call(this),this.message=c?c.length+` errors occurred during unsubscription:
`+c.map(function(l,r){return r+1+") "+l.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=c,this}return i.prototype=Object.create(Error.prototype),i}();t.UnsubscriptionError=e}),_t=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function c(l){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,l&&(this._ctorUnsubscribe=!0,this._unsubscribe=l)}return c.prototype.unsubscribe=function(){var l;if(!this.closed){var r=this,s=r._parentOrParents,n=r._ctorUnsubscribe,o=r._unsubscribe,u=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof c)s.remove(this);else if(s!==null)for(var h=0;h<s.length;++h){var f=s[h];f.remove(this)}if(Si.isFunction(o)){n&&(this._unsubscribe=void 0);try{o.call(this)}catch(_){l=_ instanceof Oi.UnsubscriptionError?i(_.errors):[_]}}if(Me.isArray(u))for(var h=-1,p=u.length;++h<p;){var d=u[h];if(mc.isObject(d))try{d.unsubscribe()}catch(y){l=l||[],y instanceof Oi.UnsubscriptionError?l=l.concat(i(y.errors)):l.push(y)}}if(l)throw new Oi.UnsubscriptionError(l)}},c.prototype.add=function(l){var r=l;if(!l)return c.EMPTY;switch(typeof l){case"function":r=new c(l);case"object":if(r===this||r.closed||typeof r.unsubscribe!="function")return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof c)){var s=r;r=new c,r._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+l+" added to Subscription.")}var n=r._parentOrParents;if(n===null)r._parentOrParents=this;else if(n instanceof c){if(n===this)return r;r._parentOrParents=[n,this]}else if(n.indexOf(this)===-1)n.push(this);else return r;var o=this._subscriptions;return o===null?this._subscriptions=[r]:o.push(r),r},c.prototype.remove=function(l){var r=this._subscriptions;if(r){var s=r.indexOf(l);s!==-1&&r.splice(s,1)}},c.EMPTY=function(l){return l.closed=!0,l}(new c),c}();t.Subscription=e;function i(c){return c.reduce(function(l,r){return l.concat(r instanceof Oi.UnsubscriptionError?r.errors:r)},[])}}),Ti=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.rxSubscriber=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),t.$$rxSubscriber=t.rxSubscriber}),R=v(function(a,t){var e=S&&S.__extends||function(){var l=function(r,s){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var u in o)o.hasOwnProperty(u)&&(n[u]=o[u])},l(r,s)};return function(r,s){l(r,s);function n(){this.constructor=r}r.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(l){e(r,l);function r(s,n,o){var u=l.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=xi.empty;break;case 1:if(!s){u.destination=xi.empty;break}if(typeof s=="object"){s instanceof r?(u.syncErrorThrowable=s.syncErrorThrowable,u.destination=s,s.add(u)):(u.syncErrorThrowable=!0,u.destination=new c(u,s));break}default:u.syncErrorThrowable=!0,u.destination=new c(u,s,n,o);break}return u}return r.prototype[Ti.rxSubscriber]=function(){return this},r.create=function(s,n,o){var u=new r(s,n,o);return u.syncErrorThrowable=!1,u},r.prototype.next=function(s){this.isStopped||this._next(s)},r.prototype.error=function(s){this.isStopped||(this.isStopped=!0,this._error(s))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,l.prototype.unsubscribe.call(this))},r.prototype._next=function(s){this.destination.next(s)},r.prototype._error=function(s){this.destination.error(s),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var s=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=s,this},r}(_t.Subscription);t.Subscriber=i;var c=function(l){e(r,l);function r(s,n,o,u){var h=l.call(this)||this;h._parentSubscriber=s;var f,p=h;return Si.isFunction(n)?f=n:n&&(f=n.next,o=n.error,u=n.complete,n!==xi.empty&&(p=Object.create(n),Si.isFunction(p.unsubscribe)&&h.add(p.unsubscribe.bind(p)),p.unsubscribe=h.unsubscribe.bind(h))),h._context=p,h._next=f,h._error=o,h._complete=u,h}return r.prototype.next=function(s){if(!this.isStopped&&this._next){var n=this._parentSubscriber;!le.config.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?this.__tryOrUnsub(this._next,s):this.__tryOrSetError(n,this._next,s)&&this.unsubscribe()}},r.prototype.error=function(s){if(!this.isStopped){var n=this._parentSubscriber,o=le.config.useDeprecatedSynchronousErrorHandling;if(this._error)!o||!n.syncErrorThrowable?(this.__tryOrUnsub(this._error,s),this.unsubscribe()):(this.__tryOrSetError(n,this._error,s),this.unsubscribe());else if(n.syncErrorThrowable)o?(n.syncErrorValue=s,n.syncErrorThrown=!0):ts.hostReportError(s),this.unsubscribe();else{if(this.unsubscribe(),o)throw s;ts.hostReportError(s)}}},r.prototype.complete=function(){var s=this;if(!this.isStopped){var n=this._parentSubscriber;if(this._complete){var o=function(){return s._complete.call(s._context)};!le.config.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?(this.__tryOrUnsub(o),this.unsubscribe()):(this.__tryOrSetError(n,o),this.unsubscribe())}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(s,n){try{s.call(this._context,n)}catch(o){if(this.unsubscribe(),le.config.useDeprecatedSynchronousErrorHandling)throw o;ts.hostReportError(o)}},r.prototype.__tryOrSetError=function(s,n,o){if(!le.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,o)}catch(u){return le.config.useDeprecatedSynchronousErrorHandling?(s.syncErrorValue=u,s.syncErrorThrown=!0,!0):(ts.hostReportError(u),!0)}return!1},r.prototype._unsubscribe=function(){var s=this._parentSubscriber;this._context=null,this._parentSubscriber=null,s.unsubscribe()},r}(i);t.SafeSubscriber=c}),P_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){for(;i;){var c=i,l=c.closed,r=c.destination,s=c.isStopped;if(l||s)return!1;r&&r instanceof R.Subscriber?i=r:i=null}return!0}t.canReportError=e}),j_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c,l){if(i){if(i instanceof R.Subscriber)return i;if(i[Ti.rxSubscriber])return i[Ti.rxSubscriber]()}return!i&&!c&&!l?new R.Subscriber(xi.empty):new R.Subscriber(i,c,l)}t.toSubscriber=e}),Cs=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}()}),Es=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i}t.identity=e}),Pr=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return i(c)}t.pipe=e;function i(c){return c.length===0?Es.identity:c.length===1?c[0]:function(r){return c.reduce(function(s,n){return n(s)},r)}}t.pipeFromArray=i}),pt=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function c(l){this._isScalar=!1,l&&(this._subscribe=l)}return c.prototype.lift=function(l){var r=new c;return r.source=this,r.operator=l,r},c.prototype.subscribe=function(l,r,s){var n=this.operator,o=j_.toSubscriber(l,r,s);if(n?o.add(n.call(o,this.source)):o.add(this.source||le.config.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),le.config.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},c.prototype._trySubscribe=function(l){try{return this._subscribe(l)}catch(r){le.config.useDeprecatedSynchronousErrorHandling&&(l.syncErrorThrown=!0,l.syncErrorValue=r),P_.canReportError(l)?l.error(r):console.warn(r)}},c.prototype.forEach=function(l,r){var s=this;return r=i(r),new r(function(n,o){var u;u=s.subscribe(function(h){try{l(h)}catch(f){o(f),u&&u.unsubscribe()}},o,n)})},c.prototype._subscribe=function(l){var r=this.source;return r&&r.subscribe(l)},c.prototype[Cs.observable]=function(){return this},c.prototype.pipe=function(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return l.length===0?this:Pr.pipeFromArray(l)(this)},c.prototype.toPromise=function(l){var r=this;return l=i(l),new l(function(s,n){var o;r.subscribe(function(u){return o=u},function(u){return n(u)},function(){return s(o)})})},c.create=function(l){return new c(l)},c}();t.Observable=e;function i(c){if(c||(c=le.config.Promise||Promise),!c)throw new Error("no Promise impl found");return c}}),yc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToArray=function(e){return function(i){for(var c=0,l=e.length;c<l&&!i.closed;c++)i.next(e[c]);i.complete()}}}),R_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToPromise=function(e){return function(i){return e.then(function(c){i.closed||(i.next(c),i.complete())},function(c){return i.error(c)}).then(null,ts.hostReportError),i}}}),Ye=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}t.getSymbolIterator=e,t.iterator=e(),t.$$iterator=t.iterator}),F_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToIterable=function(e){return function(i){var c=e[Ye.iterator]();do{var l=void 0;try{l=c.next()}catch(r){return i.error(r),i}if(l.done){i.complete();break}if(i.next(l.value),i.closed)break}while(!0);return typeof c.return=="function"&&i.add(function(){c.return&&c.return()}),i}}}),q_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToObservable=function(e){return function(i){var c=e[Cs.observable]();if(typeof c.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return c.subscribe(i)}}}),gc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayLike=function(e){return e&&typeof e.length=="number"&&typeof e!="function"}}),bc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return!!i&&typeof i.subscribe!="function"&&typeof i.then=="function"}t.isPromise=e}),jr=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeTo=function(e){if(!!e&&typeof e[Cs.observable]=="function")return q_.subscribeToObservable(e);if(gc.isArrayLike(e))return yc.subscribeToArray(e);if(bc.isPromise(e))return R_.subscribeToPromise(e);if(!!e&&typeof e[Ye.iterator]=="function")return F_.subscribeToIterable(e);var i=mc.isObject(e)?"an invalid object":"'"+e+"'",c="You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(c)}}),P=v(function(a,t){var e=S&&S.__extends||function(){var n=function(o,u){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var p in f)f.hasOwnProperty(p)&&(h[p]=f[p])},n(o,u)};return function(o,u){n(o,u);function h(){this.constructor=o}o.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){e(o,n);function o(u){var h=n.call(this)||this;return h.parent=u,h}return o.prototype._next=function(u){this.parent.notifyNext(u)},o.prototype._error=function(u){this.parent.notifyError(u),this.unsubscribe()},o.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},o}(R.Subscriber);t.SimpleInnerSubscriber=i;var c=function(n){e(o,n);function o(u,h,f){var p=n.call(this)||this;return p.parent=u,p.outerValue=h,p.outerIndex=f,p}return o.prototype._next=function(u){this.parent.notifyNext(this.outerValue,u,this.outerIndex,this)},o.prototype._error=function(u){this.parent.notifyError(u),this.unsubscribe()},o.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},o}(R.Subscriber);t.ComplexInnerSubscriber=c;var l=function(n){e(o,n);function o(){return n!==null&&n.apply(this,arguments)||this}return o.prototype.notifyNext=function(u){this.destination.next(u)},o.prototype.notifyError=function(u){this.destination.error(u)},o.prototype.notifyComplete=function(){this.destination.complete()},o}(R.Subscriber);t.SimpleOuterSubscriber=l;var r=function(n){e(o,n);function o(){return n!==null&&n.apply(this,arguments)||this}return o.prototype.notifyNext=function(u,h,f,p){this.destination.next(h)},o.prototype.notifyError=function(u){this.destination.error(u)},o.prototype.notifyComplete=function(u){this.destination.complete()},o}(R.Subscriber);t.ComplexOuterSubscriber=r;function s(n,o){if(!o.closed)return n instanceof pt.Observable?n.subscribe(o):jr.subscribeTo(n)(o)}t.innerSubscribe=s}),vc=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(n){return n.lift(new c(r))}}t.audit=i;var c=function(){function r(s){this.durationSelector=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.durationSelector))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.durationSelector=o,u.hasValue=!1,u}return s.prototype._next=function(n){if(this.value=n,this.hasValue=!0,!this.throttled){var o=void 0;try{var u=this.durationSelector;o=u(n)}catch(f){return this.destination.error(f)}var h=P.innerSubscribe(o,new P.SimpleInnerSubscriber(this));!h||h.closed?this.clearThrottle():this.add(this.throttled=h)}},s.prototype.clearThrottle=function(){var n=this,o=n.value,u=n.hasValue,h=n.throttled;h&&(this.remove(h),this.throttled=void 0,h.unsubscribe()),u&&(this.value=void 0,this.hasValue=!1,this.destination.next(o))},s.prototype.notifyNext=function(){this.clearThrottle()},s.prototype.notifyComplete=function(){this.clearThrottle()},s}(P.SimpleOuterSubscriber)}),V_=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s){return c.call(this)||this}return l.prototype.schedule=function(r,s){return this},l}(_t.Subscription);t.Action=i}),Rr=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s){var n=c.call(this,r,s)||this;return n.scheduler=r,n.work=s,n.pending=!1,n}return l.prototype.schedule=function(r,s){if(s===void 0&&(s=0),this.closed)return this;this.state=r;var n=this.id,o=this.scheduler;return n!=null&&(this.id=this.recycleAsyncId(o,n,s)),this.pending=!0,this.delay=s,this.id=this.id||this.requestAsyncId(o,this.id,s),this},l.prototype.requestAsyncId=function(r,s,n){return n===void 0&&(n=0),setInterval(r.flush.bind(r,this),n)},l.prototype.recycleAsyncId=function(r,s,n){if(n===void 0&&(n=0),n!==null&&this.delay===n&&this.pending===!1)return s;clearInterval(s)},l.prototype.execute=function(r,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(r,s);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},l.prototype._execute=function(r,s){var n=!1,o=void 0;try{this.work(r)}catch(u){n=!0,o=!!u&&u||new Error(u)}if(n)return this.unsubscribe(),o},l.prototype._unsubscribe=function(){var r=this.id,s=this.scheduler,n=s.actions,o=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,o!==-1&&n.splice(o,1),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null},l}(V_.Action);t.AsyncAction=i}),wc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function i(c,l){l===void 0&&(l=i.now),this.SchedulerAction=c,this.now=l}return i.prototype.schedule=function(c,l,r){return l===void 0&&(l=0),new this.SchedulerAction(this,c).schedule(r,l)},i.now=function(){return Date.now()},i}();t.Scheduler=e}),Fr=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s){s===void 0&&(s=wc.Scheduler.now);var n=c.call(this,r,function(){return l.delegate&&l.delegate!==n?l.delegate.now():s()})||this;return n.actions=[],n.active=!1,n.scheduled=void 0,n}return l.prototype.schedule=function(r,s,n){return s===void 0&&(s=0),l.delegate&&l.delegate!==this?l.delegate.schedule(r,s,n):c.prototype.schedule.call(this,r,s,n)},l.prototype.flush=function(r){var s=this.actions;if(this.active){s.push(r);return}var n;this.active=!0;do if(n=r.execute(r.state,r.delay))break;while(r=s.shift());if(this.active=!1,n){for(;r=s.shift();)r.unsubscribe();throw n}},l}(wc.Scheduler);t.AsyncScheduler=i}),te=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.asyncScheduler=new Fr.AsyncScheduler(Rr.AsyncAction),t.async=t.asyncScheduler}),Ds=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return!Me.isArray(i)&&i-parseFloat(i)+1>=0}t.isNumeric=e}),Se=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i&&typeof i.schedule=="function"}t.isScheduler=e}),W_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l,r){c===void 0&&(c=0);var s=-1;return Ds.isNumeric(l)?s=Number(l)<1&&1||Number(l):Se.isScheduler(l)&&(r=l),Se.isScheduler(r)||(r=te.async),new pt.Observable(function(n){var o=Ds.isNumeric(c)?c:+c-r.now();return r.schedule(i,o,{index:0,period:s,subscriber:n})})}t.timer=e;function i(c){var l=c.index,r=c.period,s=c.subscriber;if(s.next(l),!s.closed){if(r===-1)return s.complete();c.index=l+1,this.schedule(c,r)}}}),L_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return c===void 0&&(c=te.async),vc.audit(function(){return W_.timer(i,c)})}t.auditTime=e}),B_=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(n){return n.lift(new c(r))}}t.buffer=i;var c=function(){function r(s){this.closingNotifier=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.closingNotifier))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.buffer=[],u.add(P.innerSubscribe(o,new P.SimpleInnerSubscriber(u))),u}return s.prototype._next=function(n){this.buffer.push(n)},s.prototype.notifyNext=function(){var n=this.buffer;this.buffer=[],this.destination.next(n)},s}(P.SimpleOuterSubscriber)}),z_=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n){return n===void 0&&(n=null),function(u){return u.lift(new c(s,n))}}t.bufferCount=i;var c=function(){function s(n,o){this.bufferSize=n,this.startBufferEvery=o,!o||n===o?this.subscriberClass=l:this.subscriberClass=r}return s.prototype.call=function(n,o){return o.subscribe(new this.subscriberClass(n,this.bufferSize,this.startBufferEvery))},s}(),l=function(s){e(n,s);function n(o,u){var h=s.call(this,o)||this;return h.bufferSize=u,h.buffer=[],h}return n.prototype._next=function(o){var u=this.buffer;u.push(o),u.length==this.bufferSize&&(this.destination.next(u),this.buffer=[])},n.prototype._complete=function(){var o=this.buffer;o.length>0&&this.destination.next(o),s.prototype._complete.call(this)},n}(R.Subscriber),r=function(s){e(n,s);function n(o,u,h){var f=s.call(this,o)||this;return f.bufferSize=u,f.startBufferEvery=h,f.buffers=[],f.count=0,f}return n.prototype._next=function(o){var u=this,h=u.bufferSize,f=u.startBufferEvery,p=u.buffers,d=u.count;this.count++,d%f==0&&p.push([]);for(var _=p.length;_--;){var y=p[_];y.push(o),y.length===h&&(p.splice(_,1),this.destination.next(y))}},n.prototype._complete=function(){for(var o=this,u=o.buffers,h=o.destination;u.length>0;){var f=u.shift();f.length>0&&h.next(f)}s.prototype._complete.call(this)},n}(R.Subscriber)}),U_=v(function(a,t){var e=S&&S.__extends||function(){var u=function(h,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var _ in d)d.hasOwnProperty(_)&&(p[_]=d[_])},u(h,f)};return function(h,f){u(h,f);function p(){this.constructor=h}h.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(u){var h=arguments.length,f=te.async;Se.isScheduler(arguments[arguments.length-1])&&(f=arguments[arguments.length-1],h--);var p=null;h>=2&&(p=arguments[1]);var d=Number.POSITIVE_INFINITY;return h>=3&&(d=arguments[2]),function(y){return y.lift(new c(u,p,d,f))}}t.bufferTime=i;var c=function(){function u(h,f,p,d){this.bufferTimeSpan=h,this.bufferCreationInterval=f,this.maxBufferSize=p,this.scheduler=d}return u.prototype.call=function(h,f){return f.subscribe(new r(h,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},u}(),l=function(){function u(){this.buffer=[]}return u}(),r=function(u){e(h,u);function h(f,p,d,_,y){var m=u.call(this,f)||this;m.bufferTimeSpan=p,m.bufferCreationInterval=d,m.maxBufferSize=_,m.scheduler=y,m.contexts=[];var b=m.openContext();if(m.timespanOnly=d==null||d<0,m.timespanOnly){var k={subscriber:m,context:b,bufferTimeSpan:p};m.add(b.closeAction=y.schedule(s,p,k))}else{var x={subscriber:m,context:b},g={bufferTimeSpan:p,bufferCreationInterval:d,subscriber:m,scheduler:y};m.add(b.closeAction=y.schedule(o,p,x)),m.add(y.schedule(n,d,g))}return m}return h.prototype._next=function(f){for(var p=this.contexts,d=p.length,_,y=0;y<d;y++){var m=p[y],b=m.buffer;b.push(f),b.length==this.maxBufferSize&&(_=m)}_&&this.onBufferFull(_)},h.prototype._error=function(f){this.contexts.length=0,u.prototype._error.call(this,f)},h.prototype._complete=function(){for(var f=this,p=f.contexts,d=f.destination;p.length>0;){var _=p.shift();d.next(_.buffer)}u.prototype._complete.call(this)},h.prototype._unsubscribe=function(){this.contexts=null},h.prototype.onBufferFull=function(f){this.closeContext(f);var p=f.closeAction;if(p.unsubscribe(),this.remove(p),!this.closed&&this.timespanOnly){f=this.openContext();var d=this.bufferTimeSpan,_={subscriber:this,context:f,bufferTimeSpan:d};this.add(f.closeAction=this.scheduler.schedule(s,d,_))}},h.prototype.openContext=function(){var f=new l;return this.contexts.push(f),f},h.prototype.closeContext=function(f){this.destination.next(f.buffer);var p=this.contexts,d=p?p.indexOf(f):-1;d>=0&&p.splice(p.indexOf(f),1)},h}(R.Subscriber);function s(u){var h=u.subscriber,f=u.context;f&&h.closeContext(f),h.closed||(u.context=h.openContext(),u.context.closeAction=this.schedule(u,u.bufferTimeSpan))}function n(u){var h=u.bufferCreationInterval,f=u.bufferTimeSpan,p=u.subscriber,d=u.scheduler,_=p.openContext(),y=this;p.closed||(p.add(_.closeAction=d.schedule(o,f,{subscriber:p,context:_})),y.schedule(u,h))}function o(u){var h=u.subscriber,f=u.context;h.closeContext(f)}}),G_=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s,n){var o=c.call(this)||this;return o.parent=r,o.outerValue=s,o.outerIndex=n,o.index=0,o}return l.prototype._next=function(r){this.parent.notifyNext(this.outerValue,r,this.outerIndex,this.index++,this)},l.prototype._error=function(r){this.parent.notifyError(r,this),this.unsubscribe()},l.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},l}(R.Subscriber);t.InnerSubscriber=i}),Ne=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c,l,r,s){if(s===void 0&&(s=new G_.InnerSubscriber(i,l,r)),!s.closed)return c instanceof pt.Observable?c.subscribe(s):jr.subscribeTo(c)(s)}t.subscribeToResult=e}),pn=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(){return c!==null&&c.apply(this,arguments)||this}return l.prototype.notifyNext=function(r,s,n,o,u){this.destination.next(s)},l.prototype.notifyError=function(r,s){this.destination.error(r)},l.prototype.notifyComplete=function(r){this.destination.complete()},l}(R.Subscriber);t.OuterSubscriber=i}),Y_=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(o){return o.lift(new c(r,s))}}t.bufferToggle=i;var c=function(){function r(s,n){this.openings=s,this.closingSelector=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.openings,this.closingSelector))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.closingSelector=u,h.contexts=[],h.add(Ne.subscribeToResult(h,o)),h}return s.prototype._next=function(n){for(var o=this.contexts,u=o.length,h=0;h<u;h++)o[h].buffer.push(n)},s.prototype._error=function(n){for(var o=this.contexts;o.length>0;){var u=o.shift();u.subscription.unsubscribe(),u.buffer=null,u.subscription=null}this.contexts=null,r.prototype._error.call(this,n)},s.prototype._complete=function(){for(var n=this.contexts;n.length>0;){var o=n.shift();this.destination.next(o.buffer),o.subscription.unsubscribe(),o.buffer=null,o.subscription=null}this.contexts=null,r.prototype._complete.call(this)},s.prototype.notifyNext=function(n,o){n?this.closeBuffer(n):this.openBuffer(o)},s.prototype.notifyComplete=function(n){this.closeBuffer(n.context)},s.prototype.openBuffer=function(n){try{var o=this.closingSelector,u=o.call(this,n);u&&this.trySubscribe(u)}catch(h){this._error(h)}},s.prototype.closeBuffer=function(n){var o=this.contexts;if(o&&n){var u=n.buffer,h=n.subscription;this.destination.next(u),o.splice(o.indexOf(n),1),this.remove(h),h.unsubscribe()}},s.prototype.trySubscribe=function(n){var o=this.contexts,u=[],h=new _t.Subscription,f={buffer:u,subscription:h};o.push(f);var p=Ne.subscribeToResult(this,n,f);!p||p.closed?this.closeBuffer(f):(p.context=f,this.add(p),h.add(p))},s}(pn.OuterSubscriber)}),Q_=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.bufferWhen=i;var c=function(){function r(s){this.closingSelector=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.closingSelector))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.closingSelector=o,u.subscribing=!1,u.openBuffer(),u}return s.prototype._next=function(n){this.buffer.push(n)},s.prototype._complete=function(){var n=this.buffer;n&&this.destination.next(n),r.prototype._complete.call(this)},s.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},s.prototype.notifyNext=function(){this.openBuffer()},s.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},s.prototype.openBuffer=function(){var n=this.closingSubscription;n&&(this.remove(n),n.unsubscribe());var o=this.buffer;this.buffer&&this.destination.next(o),this.buffer=[];var u;try{var h=this.closingSelector;u=h()}catch(f){return this.error(f)}n=new _t.Subscription,this.closingSubscription=n,this.add(n),this.subscribing=!0,n.add(P.innerSubscribe(u,new P.SimpleInnerSubscriber(this))),this.subscribing=!1},s}(P.SimpleOuterSubscriber)}),H_=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(n){var o=new c(r),u=n.lift(o);return o.caught=u}}t.catchError=i;var c=function(){function r(s){this.selector=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.selector,this.caught))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.selector=o,h.caught=u,h}return s.prototype.error=function(n){if(!this.isStopped){var o=void 0;try{o=this.selector(n,this.caught)}catch(f){r.prototype.error.call(this,f);return}this._unsubscribeAndRecycle();var u=new P.SimpleInnerSubscriber(this);this.add(u);var h=P.innerSubscribe(o,u);h!==u&&this.add(h)}},s}(P.SimpleOuterSubscriber)}),qr=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return new pt.Observable(function(l){var r=new _t.Subscription,s=0;return r.add(c.schedule(function(){if(s===i.length){l.complete();return}l.next(i[s++]),l.closed||r.add(this.schedule())})),r})}t.scheduleArray=e}),Ms=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return c?qr.scheduleArray(i,c):new pt.Observable(yc.subscribeToArray(i))}t.fromArray=e}),Sc=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});var i={};function c(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];var o=void 0,u=void 0;return Se.isScheduler(s[s.length-1])&&(u=s.pop()),typeof s[s.length-1]=="function"&&(o=s.pop()),s.length===1&&Me.isArray(s[0])&&(s=s[0]),Ms.fromArray(s,u).lift(new l(o))}t.combineLatest=c;var l=function(){function s(n){this.resultSelector=n}return s.prototype.call=function(n,o){return o.subscribe(new r(n,this.resultSelector))},s}();t.CombineLatestOperator=l;var r=function(s){e(n,s);function n(o,u){var h=s.call(this,o)||this;return h.resultSelector=u,h.active=0,h.values=[],h.observables=[],h}return n.prototype._next=function(o){this.values.push(i),this.observables.push(o)},n.prototype._complete=function(){var o=this.observables,u=o.length;if(u===0)this.destination.complete();else{this.active=u,this.toRespond=u;for(var h=0;h<u;h++){var f=o[h];this.add(Ne.subscribeToResult(this,f,void 0,h))}}},n.prototype.notifyComplete=function(o){(this.active-=1)===0&&this.destination.complete()},n.prototype.notifyNext=function(o,u,h){var f=this.values,p=f[h],d=this.toRespond?p===i?--this.toRespond:this.toRespond:0;f[h]=u,d===0&&(this.resultSelector?this._tryResultSelector(f):this.destination.next(f.slice()))},n.prototype._tryResultSelector=function(o){var u;try{u=this.resultSelector.apply(this,o)}catch(h){this.destination.error(h);return}this.destination.next(u)},n}(pn.OuterSubscriber);t.CombineLatestSubscriber=r}),Z_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return function(c){return c.lift(new Sc.CombineLatestOperator(i))}}t.combineAll=e}),X_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return new pt.Observable(function(l){var r=new _t.Subscription;return r.add(c.schedule(function(){var s=i[Cs.observable]();r.add(s.subscribe({next:function(n){r.add(c.schedule(function(){return l.next(n)}))},error:function(n){r.add(c.schedule(function(){return l.error(n)}))},complete:function(){r.add(c.schedule(function(){return l.complete()}))}}))})),r})}t.scheduleObservable=e}),K_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return new pt.Observable(function(l){var r=new _t.Subscription;return r.add(c.schedule(function(){return i.then(function(s){r.add(c.schedule(function(){l.next(s),r.add(c.schedule(function(){return l.complete()}))}))},function(s){r.add(c.schedule(function(){return l.error(s)}))})})),r})}t.schedulePromise=e}),J_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){if(!i)throw new Error("Iterable cannot be null");return new pt.Observable(function(l){var r=new _t.Subscription,s;return r.add(function(){s&&typeof s.return=="function"&&s.return()}),r.add(c.schedule(function(){s=i[Ye.iterator](),r.add(c.schedule(function(){if(!l.closed){var n,o;try{var u=s.next();n=u.value,o=u.done}catch(h){l.error(h);return}o?l.complete():(l.next(n),this.schedule())}}))})),r})}t.scheduleIterable=e}),$_=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i&&typeof i[Cs.observable]=="function"}t.isInteropObservable=e}),tm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i&&typeof i[Ye.iterator]=="function"}t.isIterable=e}),em=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){if(i!=null){if($_.isInteropObservable(i))return X_.scheduleObservable(i,c);if(bc.isPromise(i))return K_.schedulePromise(i,c);if(gc.isArrayLike(i))return qr.scheduleArray(i,c);if(tm.isIterable(i)||typeof i=="string")return J_.scheduleIterable(i,c)}throw new TypeError((i!==null&&typeof i||i)+" is not observable")}t.scheduled=e}),es=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return c?em.scheduled(i,c):i instanceof pt.Observable?i:new pt.Observable(jr.subscribeTo(i))}t.from=e}),nm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];var l=null;return typeof i[i.length-1]=="function"&&(l=i.pop()),i.length===1&&Me.isArray(i[0])&&(i=i[0].slice()),function(r){return r.lift.call(es.from([r].concat(i)),new Sc.CombineLatestOperator(l))}}t.combineLatest=e}),Vr=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];var l=i[i.length-1];return Se.isScheduler(l)?(i.pop(),qr.scheduleArray(i,l)):Ms.fromArray(i)}t.of=e}),dn=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(o){if(typeof r!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return o.lift(new c(r,s))}}t.map=i;var c=function(){function r(s,n){this.project=s,this.thisArg=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.project,this.thisArg))},r}();t.MapOperator=c;var l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.project=o,h.count=0,h.thisArg=u||h,h}return s.prototype._next=function(n){var o;try{o=this.project.call(this.thisArg,n,this.count++)}catch(u){this.destination.error(u);return}this.destination.next(o)},s}(R.Subscriber)}),ns=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s,n){return n===void 0&&(n=Number.POSITIVE_INFINITY),typeof s=="function"?function(o){return o.pipe(i(function(u,h){return es.from(r(u,h)).pipe(dn.map(function(f,p){return s(u,f,h,p)}))},n))}:(typeof s=="number"&&(n=s),function(o){return o.lift(new c(r,n))})}t.mergeMap=i;var c=function(){function r(s,n){n===void 0&&(n=Number.POSITIVE_INFINITY),this.project=s,this.concurrent=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.project,this.concurrent))},r}();t.MergeMapOperator=c;var l=function(r){e(s,r);function s(n,o,u){u===void 0&&(u=Number.POSITIVE_INFINITY);var h=r.call(this,n)||this;return h.project=o,h.concurrent=u,h.hasCompleted=!1,h.buffer=[],h.active=0,h.index=0,h}return s.prototype._next=function(n){this.active<this.concurrent?this._tryNext(n):this.buffer.push(n)},s.prototype._tryNext=function(n){var o,u=this.index++;try{o=this.project(n,u)}catch(h){this.destination.error(h);return}this.active++,this._innerSub(o)},s.prototype._innerSub=function(n){var o=new P.SimpleInnerSubscriber(this),u=this.destination;u.add(o);var h=P.innerSubscribe(n,o);h!==o&&u.add(h)},s.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(n){this.destination.next(n)},s.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n.length>0?this._next(n.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},s}(P.SimpleOuterSubscriber);t.MergeMapSubscriber=l,t.flatMap=i}),Wr=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i===void 0&&(i=Number.POSITIVE_INFINITY),ns.mergeMap(Es.identity,i)}t.mergeAll=e}),xc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){return Wr.mergeAll(1)}t.concatAll=e}),ki=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return xc.concatAll()(Vr.of.apply(void 0,i))}t.concat=e}),sm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return function(l){return l.lift.call(ki.concat.apply(void 0,[l].concat(i)))}}t.concat=e}),Oc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return ns.mergeMap(i,c,1)}t.concatMap=e}),im=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return Oc.concatMap(function(){return i},c)}t.concatMapTo=e}),rm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r,s))}}t.count=i;var c=function(){function r(s,n){this.predicate=s,this.source=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate,this.source))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.predicate=o,h.source=u,h.count=0,h.index=0,h}return s.prototype._next=function(n){this.predicate?this._tryPredicate(n):this.count++},s.prototype._tryPredicate=function(n){var o;try{o=this.predicate(n,this.index++,this.source)}catch(u){this.destination.error(u);return}o&&this.count++},s.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},s}(R.Subscriber)}),om=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.debounce=i;var c=function(){function r(s){this.durationSelector=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.durationSelector))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.durationSelector=o,u.hasValue=!1,u}return s.prototype._next=function(n){try{var o=this.durationSelector.call(this,n);o&&this._tryNext(n,o)}catch(u){this.destination.error(u)}},s.prototype._complete=function(){this.emitValue(),this.destination.complete()},s.prototype._tryNext=function(n,o){var u=this.durationSubscription;this.value=n,this.hasValue=!0,u&&(u.unsubscribe(),this.remove(u)),u=P.innerSubscribe(o,new P.SimpleInnerSubscriber(this)),u&&!u.closed&&this.add(this.durationSubscription=u)},s.prototype.notifyNext=function(){this.emitValue()},s.prototype.notifyComplete=function(){this.emitValue()},s.prototype.emitValue=function(){if(this.hasValue){var n=this.value,o=this.durationSubscription;o&&(this.durationSubscription=void 0,o.unsubscribe(),this.remove(o)),this.value=void 0,this.hasValue=!1,r.prototype._next.call(this,n)}},s}(P.SimpleOuterSubscriber)}),am=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n){return n===void 0&&(n=te.async),function(o){return o.lift(new c(s,n))}}t.debounceTime=i;var c=function(){function s(n,o){this.dueTime=n,this.scheduler=o}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.dueTime,this.scheduler))},s}(),l=function(s){e(n,s);function n(o,u,h){var f=s.call(this,o)||this;return f.dueTime=u,f.scheduler=h,f.debouncedSubscription=null,f.lastValue=null,f.hasValue=!1,f}return n.prototype._next=function(o){this.clearDebounce(),this.lastValue=o,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(r,this.dueTime,this))},n.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},n.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var o=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(o)}},n.prototype.clearDebounce=function(){var o=this.debouncedSubscription;o!==null&&(this.remove(o),o.unsubscribe(),this.debouncedSubscription=null)},n}(R.Subscriber);function r(s){s.debouncedNext()}}),Ns=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return r===void 0&&(r=null),function(s){return s.lift(new c(r))}}t.defaultIfEmpty=i;var c=function(){function r(s){this.defaultValue=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.defaultValue))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.defaultValue=o,u.isEmpty=!0,u}return s.prototype._next=function(n){this.isEmpty=!1,this.destination.next(n)},s.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},s}(R.Subscriber)}),Tc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i instanceof Date&&!isNaN(+i)}t.isDate=e}),Is=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY=new pt.Observable(function(c){return c.complete()});function e(c){return c?i(c):t.EMPTY}t.empty=e;function i(c){return new pt.Observable(function(l){return c.schedule(function(){return l.complete()})})}}),kc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l){return l?new pt.Observable(function(r){return l.schedule(i,0,{error:c,subscriber:r})}):new pt.Observable(function(r){return r.error(c)})}t.throwError=e;function i(c){var l=c.error,r=c.subscriber;r.error(l)}}),Qe=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),function(i){i.NEXT="N",i.ERROR="E",i.COMPLETE="C"}(t.NotificationKind||(t.NotificationKind={}));var e=function(){function i(c,l,r){this.kind=c,this.value=l,this.error=r,this.hasValue=c==="N"}return i.prototype.observe=function(c){switch(this.kind){case"N":return c.next&&c.next(this.value);case"E":return c.error&&c.error(this.error);case"C":return c.complete&&c.complete()}},i.prototype.do=function(c,l,r){var s=this.kind;switch(s){case"N":return c&&c(this.value);case"E":return l&&l(this.error);case"C":return r&&r()}},i.prototype.accept=function(c,l,r){return c&&typeof c.next=="function"?this.observe(c):this.do(c,l,r)},i.prototype.toObservable=function(){var c=this.kind;switch(c){case"N":return Vr.of(this.value);case"E":return kc.throwError(this.error);case"C":return Is.empty()}throw new Error("unexpected notification kind value")},i.createNext=function(c){return typeof c!="undefined"?new i("N",c):i.undefinedValueNotification},i.createError=function(c){return new i("E",void 0,c)},i.createComplete=function(){return i.completeNotification},i.completeNotification=new i("C"),i.undefinedValueNotification=new i("N",void 0),i}();t.Notification=e}),cm=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n){n===void 0&&(n=te.async);var o=Tc.isDate(s),u=o?+s-n.now():Math.abs(s);return function(h){return h.lift(new c(u,n))}}t.delay=i;var c=function(){function s(n,o){this.delay=n,this.scheduler=o}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.delay,this.scheduler))},s}(),l=function(s){e(n,s);function n(o,u,h){var f=s.call(this,o)||this;return f.delay=u,f.scheduler=h,f.queue=[],f.active=!1,f.errored=!1,f}return n.dispatch=function(o){for(var u=o.source,h=u.queue,f=o.scheduler,p=o.destination;h.length>0&&h[0].time-f.now()<=0;)h.shift().notification.observe(p);if(h.length>0){var d=Math.max(0,h[0].time-f.now());this.schedule(o,d)}else this.unsubscribe(),u.active=!1},n.prototype._schedule=function(o){this.active=!0;var u=this.destination;u.add(o.schedule(n.dispatch,this.delay,{source:this,destination:this.destination,scheduler:o}))},n.prototype.scheduleNotification=function(o){if(this.errored!==!0){var u=this.scheduler,h=new r(u.now()+this.delay,o);this.queue.push(h),this.active===!1&&this._schedule(u)}},n.prototype._next=function(o){this.scheduleNotification(Qe.Notification.createNext(o))},n.prototype._error=function(o){this.errored=!0,this.queue=[],this.destination.error(o),this.unsubscribe()},n.prototype._complete=function(){this.scheduleNotification(Qe.Notification.createComplete()),this.unsubscribe()},n}(R.Subscriber),r=function(){function s(n,o){this.time=n,this.notification=o}return s}()}),um=v(function(a,t){var e=S&&S.__extends||function(){var n=function(o,u){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var p in f)f.hasOwnProperty(p)&&(h[p]=f[p])},n(o,u)};return function(o,u){n(o,u);function h(){this.constructor=o}o.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(n,o){return o?function(u){return new r(u,o).lift(new c(n))}:function(u){return u.lift(new c(n))}}t.delayWhen=i;var c=function(){function n(o){this.delayDurationSelector=o}return n.prototype.call=function(o,u){return u.subscribe(new l(o,this.delayDurationSelector))},n}(),l=function(n){e(o,n);function o(u,h){var f=n.call(this,u)||this;return f.delayDurationSelector=h,f.completed=!1,f.delayNotifierSubscriptions=[],f.index=0,f}return o.prototype.notifyNext=function(u,h,f,p,d){this.destination.next(u),this.removeSubscription(d),this.tryComplete()},o.prototype.notifyError=function(u,h){this._error(u)},o.prototype.notifyComplete=function(u){var h=this.removeSubscription(u);h&&this.destination.next(h),this.tryComplete()},o.prototype._next=function(u){var h=this.index++;try{var f=this.delayDurationSelector(u,h);f&&this.tryDelay(f,u)}catch(p){this.destination.error(p)}},o.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},o.prototype.removeSubscription=function(u){u.unsubscribe();var h=this.delayNotifierSubscriptions.indexOf(u);return h!==-1&&this.delayNotifierSubscriptions.splice(h,1),u.outerValue},o.prototype.tryDelay=function(u,h){var f=Ne.subscribeToResult(this,u,h);if(f&&!f.closed){var p=this.destination;p.add(f),this.delayNotifierSubscriptions.push(f)}},o.prototype.tryComplete=function(){this.completed&&this.delayNotifierSubscriptions.length===0&&this.destination.complete()},o}(pn.OuterSubscriber),r=function(n){e(o,n);function o(u,h){var f=n.call(this)||this;return f.source=u,f.subscriptionDelay=h,f}return o.prototype._subscribe=function(u){this.subscriptionDelay.subscribe(new s(u,this.source))},o}(pt.Observable),s=function(n){e(o,n);function o(u,h){var f=n.call(this)||this;return f.parent=u,f.source=h,f.sourceSubscribed=!1,f}return o.prototype._next=function(u){this.subscribeToSource()},o.prototype._error=function(u){this.unsubscribe(),this.parent.error(u)},o.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},o.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},o}(R.Subscriber)}),lm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(s){return s.lift(new c)}}t.dematerialize=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}(),l=function(r){e(s,r);function s(n){return r.call(this,n)||this}return s.prototype._next=function(n){n.observe(this.destination)},s}(R.Subscriber)}),hm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(n){return n.lift(new c(r,s))}}t.distinct=i;var c=function(){function r(s,n){this.keySelector=s,this.flushes=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.keySelector,this.flushes))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.keySelector=o,h.values=new Set,u&&h.add(P.innerSubscribe(u,new P.SimpleInnerSubscriber(h))),h}return s.prototype.notifyNext=function(){this.values.clear()},s.prototype.notifyError=function(n){this._error(n)},s.prototype._next=function(n){this.keySelector?this._useKeySelector(n):this._finalizeNext(n,n)},s.prototype._useKeySelector=function(n){var o,u=this.destination;try{o=this.keySelector(n)}catch(h){u.error(h);return}this._finalizeNext(o,n)},s.prototype._finalizeNext=function(n,o){var u=this.values;u.has(n)||(u.add(n),this.destination.next(o))},s}(P.SimpleOuterSubscriber);t.DistinctSubscriber=l}),Ac=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(n){return n.lift(new c(r,s))}}t.distinctUntilChanged=i;var c=function(){function r(s,n){this.compare=s,this.keySelector=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.compare,this.keySelector))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.keySelector=u,h.hasKey=!1,typeof o=="function"&&(h.compare=o),h}return s.prototype.compare=function(n,o){return n===o},s.prototype._next=function(n){var o;try{var u=this.keySelector;o=u?u(n):n}catch(p){return this.destination.error(p)}var h=!1;if(this.hasKey)try{var f=this.compare;h=f(this.key,o)}catch(p){return this.destination.error(p)}else this.hasKey=!0;h||(this.key=o,this.destination.next(n))},s}(R.Subscriber)}),fm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return Ac.distinctUntilChanged(function(l,r){return c?c(l[i],r[i]):l[i]===r[i]})}t.distinctUntilKeyChanged=e}),Ps=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function i(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return i.prototype=Object.create(Error.prototype),i}();t.ArgumentOutOfRangeError=e}),ss=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(o){return o.lift(new c(r,s))}}t.filter=i;var c=function(){function r(s,n){this.predicate=s,this.thisArg=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate,this.thisArg))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.predicate=o,h.thisArg=u,h.count=0,h}return s.prototype._next=function(n){var o;try{o=this.predicate.call(this.thisArg,n,this.count++)}catch(u){this.destination.error(u);return}o&&this.destination.next(n)},s}(R.Subscriber)}),Ai=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function i(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return i.prototype=Object.create(Error.prototype),i}();t.EmptyError=e}),Ci=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s){return s===void 0&&(s=r),function(n){return n.lift(new c(s))}}t.throwIfEmpty=i;var c=function(){function s(n){this.errorFactory=n}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.errorFactory))},s}(),l=function(s){e(n,s);function n(o,u){var h=s.call(this,o)||this;return h.errorFactory=u,h.hasValue=!1,h}return n.prototype._next=function(o){this.hasValue=!0,this.destination.next(o)},n.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var o=void 0;try{o=this.errorFactory()}catch(u){o=u}this.destination.error(o)},n}(R.Subscriber);function r(){return new Ai.EmptyError}}),Lr=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return r===0?Is.empty():s.lift(new c(r))}}t.take=i;var c=function(){function r(s){if(this.total=s,this.total<0)throw new Ps.ArgumentOutOfRangeError}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.total))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.total=o,u.count=0,u}return s.prototype._next=function(n){var o=this.total,u=++this.count;u<=o&&(this.destination.next(n),u===o&&(this.destination.complete(),this.unsubscribe()))},s}(R.Subscriber)}),pm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){if(i<0)throw new Ps.ArgumentOutOfRangeError;var l=arguments.length>=2;return function(r){return r.pipe(ss.filter(function(s,n){return n===i}),Lr.take(1),l?Ns.defaultIfEmpty(c):Ci.throwIfEmpty(function(){return new Ps.ArgumentOutOfRangeError}))}}t.elementAt=e}),dm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return function(l){return ki.concat(l,Vr.of.apply(void 0,i))}}t.endWith=e}),_m=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(n){return n.lift(new c(r,s,n))}}t.every=i;var c=function(){function r(s,n,o){this.predicate=s,this.thisArg=n,this.source=o}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate,this.thisArg,this.source))},r}(),l=function(r){e(s,r);function s(n,o,u,h){var f=r.call(this,n)||this;return f.predicate=o,f.thisArg=u,f.source=h,f.index=0,f.thisArg=u||f,f}return s.prototype.notifyComplete=function(n){this.destination.next(n),this.destination.complete()},s.prototype._next=function(n){var o=!1;try{o=this.predicate.call(this.thisArg,n,this.index++,this.source)}catch(u){this.destination.error(u);return}o||this.notifyComplete(!1)},s.prototype._complete=function(){this.notifyComplete(!0)},s}(R.Subscriber)}),mm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(r){return r.lift(new c)}}t.exhaust=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}(),l=function(r){e(s,r);function s(n){var o=r.call(this,n)||this;return o.hasCompleted=!1,o.hasSubscription=!1,o}return s.prototype._next=function(n){this.hasSubscription||(this.hasSubscription=!0,this.add(P.innerSubscribe(n,new P.SimpleInnerSubscriber(this))))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},s.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},s}(P.SimpleOuterSubscriber)}),ym=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return s?function(n){return n.pipe(i(function(o,u){return es.from(r(o,u)).pipe(dn.map(function(h,f){return s(o,h,u,f)}))}))}:function(n){return n.lift(new c(r))}}t.exhaustMap=i;var c=function(){function r(s){this.project=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.project))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.project=o,u.hasSubscription=!1,u.hasCompleted=!1,u.index=0,u}return s.prototype._next=function(n){this.hasSubscription||this.tryNext(n)},s.prototype.tryNext=function(n){var o,u=this.index++;try{o=this.project(n,u)}catch(h){this.destination.error(h);return}this.hasSubscription=!0,this._innerSub(o)},s.prototype._innerSub=function(n){var o=new P.SimpleInnerSubscriber(this),u=this.destination;u.add(o);var h=P.innerSubscribe(n,o);h!==o&&u.add(h)},s.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(n){this.destination.next(n)},s.prototype.notifyError=function(n){this.destination.error(n)},s.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},s}(P.SimpleOuterSubscriber)}),gm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s,n){return s===void 0&&(s=Number.POSITIVE_INFINITY),s=(s||0)<1?Number.POSITIVE_INFINITY:s,function(o){return o.lift(new c(r,s,n))}}t.expand=i;var c=function(){function r(s,n,o){this.project=s,this.concurrent=n,this.scheduler=o}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.project,this.concurrent,this.scheduler))},r}();t.ExpandOperator=c;var l=function(r){e(s,r);function s(n,o,u,h){var f=r.call(this,n)||this;return f.project=o,f.concurrent=u,f.scheduler=h,f.index=0,f.active=0,f.hasCompleted=!1,u<Number.POSITIVE_INFINITY&&(f.buffer=[]),f}return s.dispatch=function(n){var o=n.subscriber,u=n.result,h=n.value,f=n.index;o.subscribeToProjection(u,h,f)},s.prototype._next=function(n){var o=this.destination;if(o.closed){this._complete();return}var u=this.index++;if(this.active<this.concurrent){o.next(n);try{var h=this.project,f=h(n,u);if(!this.scheduler)this.subscribeToProjection(f,n,u);else{var p={subscriber:this,result:f,value:n,index:u},d=this.destination;d.add(this.scheduler.schedule(s.dispatch,0,p))}}catch(_){o.error(_)}}else this.buffer.push(n)},s.prototype.subscribeToProjection=function(n,o,u){this.active++;var h=this.destination;h.add(P.innerSubscribe(n,new P.SimpleInnerSubscriber(this)))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&this.active===0&&this.destination.complete(),this.unsubscribe()},s.prototype.notifyNext=function(n){this._next(n)},s.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n&&n.length>0&&this._next(n.shift()),this.hasCompleted&&this.active===0&&this.destination.complete()},s}(P.SimpleOuterSubscriber);t.ExpandSubscriber=l}),bm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.finalize=i;var c=function(){function r(s){this.callback=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.callback))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.add(new _t.Subscription(o)),u}return s}(R.Subscriber)}),Cc=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){if(typeof r!="function")throw new TypeError("predicate is not a function");return function(n){return n.lift(new c(r,n,!1,s))}}t.find=i;var c=function(){function r(s,n,o,u){this.predicate=s,this.source=n,this.yieldIndex=o,this.thisArg=u}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate,this.source,this.yieldIndex,this.thisArg))},r}();t.FindValueOperator=c;var l=function(r){e(s,r);function s(n,o,u,h,f){var p=r.call(this,n)||this;return p.predicate=o,p.source=u,p.yieldIndex=h,p.thisArg=f,p.index=0,p}return s.prototype.notifyComplete=function(n){var o=this.destination;o.next(n),o.complete(),this.unsubscribe()},s.prototype._next=function(n){var o=this,u=o.predicate,h=o.thisArg,f=this.index++;try{var p=u.call(h||this,n,f,this.source);p&&this.notifyComplete(this.yieldIndex?f:n)}catch(d){this.destination.error(d)}},s.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},s}(R.Subscriber);t.FindValueSubscriber=l}),vm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return function(l){return l.lift(new Cc.FindValueOperator(i,l,!0,c))}}t.findIndex=e}),wm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){var l=arguments.length>=2;return function(r){return r.pipe(i?ss.filter(function(s,n){return i(s,n,r)}):Es.identity,Lr.take(1),l?Ns.defaultIfEmpty(c):Ci.throwIfEmpty(function(){return new Ai.EmptyError}))}}t.first=e}),_n=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function i(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return i.prototype=Object.create(Error.prototype),i}();t.ObjectUnsubscribedError=e}),Ec=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s){var n=c.call(this)||this;return n.subject=r,n.subscriber=s,n.closed=!1,n}return l.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var r=this.subject,s=r.observers;if(this.subject=null,!(!s||s.length===0||r.isStopped||r.closed)){var n=s.indexOf(this.subscriber);n!==-1&&s.splice(n,1)}}},l}(_t.Subscription);t.SubjectSubscription=i}),Mt=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){e(s,r);function s(n){var o=r.call(this,n)||this;return o.destination=n,o}return s}(R.Subscriber);t.SubjectSubscriber=i;var c=function(r){e(s,r);function s(){var n=r.call(this)||this;return n.observers=[],n.closed=!1,n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return s.prototype[Ti.rxSubscriber]=function(){return new i(this)},s.prototype.lift=function(n){var o=new l(this,this);return o.operator=n,o},s.prototype.next=function(n){if(this.closed)throw new _n.ObjectUnsubscribedError;if(!this.isStopped)for(var o=this.observers,u=o.length,h=o.slice(),f=0;f<u;f++)h[f].next(n)},s.prototype.error=function(n){if(this.closed)throw new _n.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=n,this.isStopped=!0;for(var o=this.observers,u=o.length,h=o.slice(),f=0;f<u;f++)h[f].error(n);this.observers.length=0},s.prototype.complete=function(){if(this.closed)throw new _n.ObjectUnsubscribedError;this.isStopped=!0;for(var n=this.observers,o=n.length,u=n.slice(),h=0;h<o;h++)u[h].complete();this.observers.length=0},s.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},s.prototype._trySubscribe=function(n){if(this.closed)throw new _n.ObjectUnsubscribedError;return r.prototype._trySubscribe.call(this,n)},s.prototype._subscribe=function(n){if(this.closed)throw new _n.ObjectUnsubscribedError;return this.hasError?(n.error(this.thrownError),_t.Subscription.EMPTY):this.isStopped?(n.complete(),_t.Subscription.EMPTY):(this.observers.push(n),new Ec.SubjectSubscription(this,n))},s.prototype.asObservable=function(){var n=new pt.Observable;return n.source=this,n},s.create=function(n,o){return new l(n,o)},s}(pt.Observable);t.Subject=c;var l=function(r){e(s,r);function s(n,o){var u=r.call(this)||this;return u.destination=n,u.source=o,u}return s.prototype.next=function(n){var o=this.destination;o&&o.next&&o.next(n)},s.prototype.error=function(n){var o=this.destination;o&&o.error&&this.destination.error(n)},s.prototype.complete=function(){var n=this.destination;n&&n.complete&&this.destination.complete()},s.prototype._subscribe=function(n){var o=this.source;return o?this.source.subscribe(n):_t.Subscription.EMPTY},s}(c);t.AnonymousSubject=l}),Sm=v(function(a,t){var e=S&&S.__extends||function(){var o=function(u,h){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var d in p)p.hasOwnProperty(d)&&(f[d]=p[d])},o(u,h)};return function(u,h){o(u,h);function f(){this.constructor=u}u.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(o,u,h,f){return function(p){return p.lift(new c(o,u,h,f))}}t.groupBy=i;var c=function(){function o(u,h,f,p){this.keySelector=u,this.elementSelector=h,this.durationSelector=f,this.subjectSelector=p}return o.prototype.call=function(u,h){return h.subscribe(new l(u,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},o}(),l=function(o){e(u,o);function u(h,f,p,d,_){var y=o.call(this,h)||this;return y.keySelector=f,y.elementSelector=p,y.durationSelector=d,y.subjectSelector=_,y.groups=null,y.attemptedToUnsubscribe=!1,y.count=0,y}return u.prototype._next=function(h){var f;try{f=this.keySelector(h)}catch(p){this.error(p);return}this._group(h,f)},u.prototype._group=function(h,f){var p=this.groups;p||(p=this.groups=new Map);var d=p.get(f),_;if(this.elementSelector)try{_=this.elementSelector(h)}catch(b){this.error(b)}else _=h;if(!d){d=this.subjectSelector?this.subjectSelector():new Mt.Subject,p.set(f,d);var y=new s(f,d,this);if(this.destination.next(y),this.durationSelector){var m=void 0;try{m=this.durationSelector(new s(f,d))}catch(b){this.error(b);return}this.add(m.subscribe(new r(f,d,this)))}}d.closed||d.next(_)},u.prototype._error=function(h){var f=this.groups;f&&(f.forEach(function(p,d){p.error(h)}),f.clear()),this.destination.error(h)},u.prototype._complete=function(){var h=this.groups;h&&(h.forEach(function(f,p){f.complete()}),h.clear()),this.destination.complete()},u.prototype.removeGroup=function(h){this.groups.delete(h)},u.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&o.prototype.unsubscribe.call(this))},u}(R.Subscriber),r=function(o){e(u,o);function u(h,f,p){var d=o.call(this,f)||this;return d.key=h,d.group=f,d.parent=p,d}return u.prototype._next=function(h){this.complete()},u.prototype._unsubscribe=function(){var h=this,f=h.parent,p=h.key;this.key=this.parent=null,f&&f.removeGroup(p)},u}(R.Subscriber),s=function(o){e(u,o);function u(h,f,p){var d=o.call(this)||this;return d.key=h,d.groupSubject=f,d.refCountSubscription=p,d}return u.prototype._subscribe=function(h){var f=new _t.Subscription,p=this,d=p.refCountSubscription,_=p.groupSubject;return d&&!d.closed&&f.add(new n(d)),f.add(_.subscribe(h)),f},u}(pt.Observable);t.GroupedObservable=s;var n=function(o){e(u,o);function u(h){var f=o.call(this)||this;return f.parent=h,h.count++,f}return u.prototype.unsubscribe=function(){var h=this.parent;!h.closed&&!this.closed&&(o.prototype.unsubscribe.call(this),h.count-=1,h.count===0&&h.attemptedToUnsubscribe&&h.unsubscribe())},u}(_t.Subscription)}),xm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(s){return s.lift(new c)}}t.ignoreElements=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}(),l=function(r){e(s,r);function s(){return r!==null&&r.apply(this,arguments)||this}return s.prototype._next=function(n){},s}(R.Subscriber)}),Om=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(r){return r.lift(new c)}}t.isEmpty=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}(),l=function(r){e(s,r);function s(n){return r.call(this,n)||this}return s.prototype.notifyComplete=function(n){var o=this.destination;o.next(n),o.complete()},s.prototype._next=function(n){this.notifyComplete(!1)},s.prototype._complete=function(){this.notifyComplete(!0)},s}(R.Subscriber)}),Ei=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(n){return r===0?Is.empty():n.lift(new c(r))}}t.takeLast=i;var c=function(){function r(s){if(this.total=s,this.total<0)throw new Ps.ArgumentOutOfRangeError}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.total))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.total=o,u.ring=new Array,u.count=0,u}return s.prototype._next=function(n){var o=this.ring,u=this.total,h=this.count++;if(o.length<u)o.push(n);else{var f=h%u;o[f]=n}},s.prototype._complete=function(){var n=this.destination,o=this.count;if(o>0)for(var u=this.count>=this.total?this.total:this.count,h=this.ring,f=0;f<u;f++){var p=o++%u;n.next(h[p])}n.complete()},s}(R.Subscriber)}),Tm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){var l=arguments.length>=2;return function(r){return r.pipe(i?ss.filter(function(s,n){return i(s,n,r)}):Es.identity,Ei.takeLast(1),l?Ns.defaultIfEmpty(c):Ci.throwIfEmpty(function(){return new Ai.EmptyError}))}}t.last=e}),km=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.mapTo=i;var c=function(){function r(s){this.value=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.value))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.value=o,u}return s.prototype._next=function(n){this.destination.next(this.value)},s}(R.Subscriber)}),Am=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(s){return s.lift(new c)}}t.materialize=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}(),l=function(r){e(s,r);function s(n){return r.call(this,n)||this}return s.prototype._next=function(n){this.destination.next(Qe.Notification.createNext(n))},s.prototype._error=function(n){var o=this.destination;o.next(Qe.Notification.createError(n)),o.complete()},s.prototype._complete=function(){var n=this.destination;n.next(Qe.Notification.createComplete()),n.complete()},s}(R.Subscriber)}),Di=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){var n=!1;return arguments.length>=2&&(n=!0),function(u){return u.lift(new c(r,s,n))}}t.scan=i;var c=function(){function r(s,n,o){o===void 0&&(o=!1),this.accumulator=s,this.seed=n,this.hasSeed=o}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.accumulator,this.seed,this.hasSeed))},r}(),l=function(r){e(s,r);function s(n,o,u,h){var f=r.call(this,n)||this;return f.accumulator=o,f._seed=u,f.hasSeed=h,f.index=0,f}return Object.defineProperty(s.prototype,"seed",{get:function(){return this._seed},set:function(n){this.hasSeed=!0,this._seed=n},enumerable:!0,configurable:!0}),s.prototype._next=function(n){if(!this.hasSeed)this.seed=n,this.destination.next(n);else return this._tryNext(n)},s.prototype._tryNext=function(n){var o=this.index++,u;try{u=this.accumulator(this.seed,n,o)}catch(h){this.destination.error(h)}this.seed=u,this.destination.next(u)},s}(R.Subscriber)}),Mi=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return arguments.length>=2?function(r){return Pr.pipe(Di.scan(i,c),Ei.takeLast(1),Ns.defaultIfEmpty(c))(r)}:function(r){return Pr.pipe(Di.scan(function(s,n,o){return i(s,n,o+1)}),Ei.takeLast(1))(r)}}t.reduce=e}),Cm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){var c=typeof i=="function"?function(l,r){return i(l,r)>0?l:r}:function(l,r){return l>r?l:r};return Mi.reduce(c)}t.max=e}),Em=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];var l=Number.POSITIVE_INFINITY,r=null,s=i[i.length-1];return Se.isScheduler(s)?(r=i.pop(),i.length>1&&typeof i[i.length-1]=="number"&&(l=i.pop())):typeof s=="number"&&(l=i.pop()),r===null&&i.length===1&&i[0]instanceof pt.Observable?i[0]:Wr.mergeAll(l)(Ms.fromArray(i,r))}t.merge=e}),Dm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return function(l){return l.lift.call(Em.merge.apply(void 0,[l].concat(i)))}}t.merge=e}),Mm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c,l){return l===void 0&&(l=Number.POSITIVE_INFINITY),typeof c=="function"?ns.mergeMap(function(){return i},c,l):(typeof c=="number"&&(l=c),ns.mergeMap(function(){return i},l))}t.mergeMapTo=e}),Nm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s,n){return n===void 0&&(n=Number.POSITIVE_INFINITY),function(o){return o.lift(new c(r,s,n))}}t.mergeScan=i;var c=function(){function r(s,n,o){this.accumulator=s,this.seed=n,this.concurrent=o}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.accumulator,this.seed,this.concurrent))},r}();t.MergeScanOperator=c;var l=function(r){e(s,r);function s(n,o,u,h){var f=r.call(this,n)||this;return f.accumulator=o,f.acc=u,f.concurrent=h,f.hasValue=!1,f.hasCompleted=!1,f.buffer=[],f.active=0,f.index=0,f}return s.prototype._next=function(n){if(this.active<this.concurrent){var o=this.index++,u=this.destination,h=void 0;try{var f=this.accumulator;h=f(this.acc,n,o)}catch(p){return u.error(p)}this.active++,this._innerSub(h)}else this.buffer.push(n)},s.prototype._innerSub=function(n){var o=new P.SimpleInnerSubscriber(this),u=this.destination;u.add(o);var h=P.innerSubscribe(n,o);h!==o&&u.add(h)},s.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},s.prototype.notifyNext=function(n){var o=this.destination;this.acc=n,this.hasValue=!0,o.next(n)},s.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n.length>0?this._next(n.shift()):this.active===0&&this.hasCompleted&&(this.hasValue===!1&&this.destination.next(this.acc),this.destination.complete())},s}(P.SimpleOuterSubscriber);t.MergeScanSubscriber=l}),Im=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){var c=typeof i=="function"?function(l,r){return i(l,r)<0?l:r}:function(l,r){return l<r?l:r};return Mi.reduce(c)}t.min=e}),Br=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(s){return s.lift(new c(s))}}t.refCount=i;var c=function(){function r(s){this.connectable=s}return r.prototype.call=function(s,n){var o=this.connectable;o._refCount++;var u=new l(s,o),h=n.subscribe(u);return u.closed||(u.connection=o.connect()),h},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.connectable=o,u}return s.prototype._unsubscribe=function(){var n=this.connectable;if(!n){this.connection=null;return}this.connectable=null;var o=n._refCount;if(o<=0){this.connection=null;return}if(n._refCount=o-1,o>1){this.connection=null;return}var u=this.connection,h=n._connection;this.connection=null,h&&(!u||h===u)&&h.unsubscribe()},s}(R.Subscriber)}),Pm=v(function(a,t){var e=S&&S.__extends||function(){var l=function(r,s){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var u in o)o.hasOwnProperty(u)&&(n[u]=o[u])},l(r,s)};return function(r,s){l(r,s);function n(){this.constructor=r}r.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(l){e(r,l);function r(s,n){var o=l.call(this)||this;return o.source=s,o.subjectFactory=n,o._refCount=0,o._isComplete=!1,o}return r.prototype._subscribe=function(s){return this.getSubject().subscribe(s)},r.prototype.getSubject=function(){var s=this._subject;return(!s||s.isStopped)&&(this._subject=this.subjectFactory()),this._subject},r.prototype.connect=function(){var s=this._connection;return s||(this._isComplete=!1,s=this._connection=new _t.Subscription,s.add(this.source.subscribe(new c(this.getSubject(),this))),s.closed&&(this._connection=null,s=_t.Subscription.EMPTY)),s},r.prototype.refCount=function(){return Br.refCount()(this)},r}(pt.Observable);t.ConnectableObservable=i,t.connectableObservableDescriptor=function(){var l=i.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:l._subscribe},_isComplete:{value:l._isComplete,writable:!0},getSubject:{value:l.getSubject},connect:{value:l.connect},refCount:{value:l.refCount}}}();var c=function(l){e(r,l);function r(s,n){var o=l.call(this,s)||this;return o.connectable=n,o}return r.prototype._error=function(s){this._unsubscribe(),l.prototype._error.call(this,s)},r.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),l.prototype._complete.call(this)},r.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var n=s._connection;s._refCount=0,s._subject=null,s._connection=null,n&&n.unsubscribe()}},r}(Mt.SubjectSubscriber);(function(l){e(r,l);function r(s,n){var o=l.call(this,s)||this;return o.connectable=n,o}return r.prototype._unsubscribe=function(){var s=this.connectable;if(!s){this.connection=null;return}this.connectable=null;var n=s._refCount;if(n<=0){this.connection=null;return}if(s._refCount=n-1,n>1){this.connection=null;return}var o=this.connection,u=s._connection;this.connection=null,u&&(!o||u===o)&&u.unsubscribe()},r})(R.Subscriber)}),mn=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l){return function(s){var n;if(typeof c=="function"?n=c:n=function(){return c},typeof l=="function")return s.lift(new i(n,l));var o=Object.create(s,Pm.connectableObservableDescriptor);return o.source=s,o.subjectFactory=n,o}}t.multicast=e;var i=function(){function c(l,r){this.subjectFactory=l,this.selector=r}return c.prototype.call=function(l,r){var s=this.selector,n=this.subjectFactory(),o=s(n).subscribe(l);return o.add(r.subscribe(n)),o},c}();t.MulticastOperator=i}),Dc=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n){return n===void 0&&(n=0),function(u){return u.lift(new c(s,n))}}t.observeOn=i;var c=function(){function s(n,o){o===void 0&&(o=0),this.scheduler=n,this.delay=o}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.scheduler,this.delay))},s}();t.ObserveOnOperator=c;var l=function(s){e(n,s);function n(o,u,h){h===void 0&&(h=0);var f=s.call(this,o)||this;return f.scheduler=u,f.delay=h,f}return n.dispatch=function(o){var u=o.notification,h=o.destination;u.observe(h),this.unsubscribe()},n.prototype.scheduleMessage=function(o){var u=this.destination;u.add(this.scheduler.schedule(n.dispatch,this.delay,new r(o,this.destination)))},n.prototype._next=function(o){this.scheduleMessage(Qe.Notification.createNext(o))},n.prototype._error=function(o){this.scheduleMessage(Qe.Notification.createError(o)),this.unsubscribe()},n.prototype._complete=function(){this.scheduleMessage(Qe.Notification.createComplete()),this.unsubscribe()},n}(R.Subscriber);t.ObserveOnSubscriber=l;var r=function(){function s(n,o){this.notification=n,this.destination=o}return s}();t.ObserveOnMessage=r}),jm=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];return s.length===1&&Me.isArray(s[0])&&(s=s[0]),function(o){return o.lift(new l(s))}}t.onErrorResumeNext=i;function c(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];var o=void 0;return s.length===1&&Me.isArray(s[0])&&(s=s[0]),o=s.shift(),es.from(o).lift(new l(s))}t.onErrorResumeNextStatic=c;var l=function(){function s(n){this.nextSources=n}return s.prototype.call=function(n,o){return o.subscribe(new r(n,this.nextSources))},s}(),r=function(s){e(n,s);function n(o,u){var h=s.call(this,o)||this;return h.destination=o,h.nextSources=u,h}return n.prototype.notifyError=function(){this.subscribeToNextSource()},n.prototype.notifyComplete=function(){this.subscribeToNextSource()},n.prototype._error=function(o){this.subscribeToNextSource(),this.unsubscribe()},n.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},n.prototype.subscribeToNextSource=function(){var o=this.nextSources.shift();if(o){var u=new P.SimpleInnerSubscriber(this),h=this.destination;h.add(u);var f=P.innerSubscribe(o,u);f!==u&&h.add(f)}else this.destination.complete()},n}(P.SimpleOuterSubscriber)}),Rm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){return function(r){return r.lift(new c)}}t.pairwise=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}(),l=function(r){e(s,r);function s(n){var o=r.call(this,n)||this;return o.hasPrev=!1,o}return s.prototype._next=function(n){var o;this.hasPrev?o=[this.prev,n]:this.hasPrev=!0,this.prev=n,o&&this.destination.next(o)},s}(R.Subscriber)}),Fm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){function l(){return!l.pred.apply(l.thisArg,arguments)}return l.pred=i,l.thisArg=c,l}t.not=e}),qm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return function(l){return[ss.filter(i,c)(l),ss.filter(Fm.not(i,c))(l)]}}t.partition=e}),Vm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];var r=c.length;if(r===0)throw new Error("list of properties cannot be empty.");return function(s){return dn.map(i(c,r))(s)}}t.pluck=e;function i(c,l){var r=function(s){for(var n=s,o=0;o<l;o++){var u=n!=null?n[c[o]]:void 0;if(u!==void 0)n=u;else return}return n};return r}}),Wm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return i?mn.multicast(function(){return new Mt.Subject},i):mn.multicast(new Mt.Subject)}t.publish=e}),Lm=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r){var s=c.call(this)||this;return s._value=r,s}return Object.defineProperty(l.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),l.prototype._subscribe=function(r){var s=c.prototype._subscribe.call(this,r);return s&&!s.closed&&r.next(this._value),s},l.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new _n.ObjectUnsubscribedError;return this._value},l.prototype.next=function(r){c.prototype.next.call(this,this._value=r)},l}(Mt.Subject);t.BehaviorSubject=i}),Bm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return function(c){return mn.multicast(new Lm.BehaviorSubject(i))(c)}}t.publishBehavior=e}),zm=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(){var r=c!==null&&c.apply(this,arguments)||this;return r.value=null,r.hasNext=!1,r.hasCompleted=!1,r}return l.prototype._subscribe=function(r){return this.hasError?(r.error(this.thrownError),_t.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(r.next(this.value),r.complete(),_t.Subscription.EMPTY):c.prototype._subscribe.call(this,r)},l.prototype.next=function(r){this.hasCompleted||(this.value=r,this.hasNext=!0)},l.prototype.error=function(r){this.hasCompleted||c.prototype.error.call(this,r)},l.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&c.prototype.next.call(this,this.value),c.prototype.complete.call(this)},l}(Mt.Subject);t.AsyncSubject=i}),Um=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){return function(i){return mn.multicast(new zm.AsyncSubject)(i)}}t.publishLast=e}),Gm=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s){var n=c.call(this,r,s)||this;return n.scheduler=r,n.work=s,n}return l.prototype.schedule=function(r,s){return s===void 0&&(s=0),s>0?c.prototype.schedule.call(this,r,s):(this.delay=s,this.state=r,this.scheduler.flush(this),this)},l.prototype.execute=function(r,s){return s>0||this.closed?c.prototype.execute.call(this,r,s):this._execute(r,s)},l.prototype.requestAsyncId=function(r,s,n){return n===void 0&&(n=0),n!==null&&n>0||n===null&&this.delay>0?c.prototype.requestAsyncId.call(this,r,s,n):r.flush(this)},l}(Rr.AsyncAction);t.QueueAction=i}),Ym=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(){return c!==null&&c.apply(this,arguments)||this}return l}(Fr.AsyncScheduler);t.QueueScheduler=i}),Qm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queueScheduler=new Ym.QueueScheduler(Gm.QueueAction),t.queue=t.queueScheduler}),Mc=v(function(a,t){var e=S&&S.__extends||function(){var l=function(r,s){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var u in o)o.hasOwnProperty(u)&&(n[u]=o[u])},l(r,s)};return function(r,s){l(r,s);function n(){this.constructor=r}r.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(l){e(r,l);function r(s,n,o){s===void 0&&(s=Number.POSITIVE_INFINITY),n===void 0&&(n=Number.POSITIVE_INFINITY);var u=l.call(this)||this;return u.scheduler=o,u._events=[],u._infiniteTimeWindow=!1,u._bufferSize=s<1?1:s,u._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(u._infiniteTimeWindow=!0,u.next=u.nextInfiniteTimeWindow):u.next=u.nextTimeWindow,u}return r.prototype.nextInfiniteTimeWindow=function(s){if(!this.isStopped){var n=this._events;n.push(s),n.length>this._bufferSize&&n.shift()}l.prototype.next.call(this,s)},r.prototype.nextTimeWindow=function(s){this.isStopped||(this._events.push(new c(this._getNow(),s)),this._trimBufferThenGetEvents()),l.prototype.next.call(this,s)},r.prototype._subscribe=function(s){var n=this._infiniteTimeWindow,o=n?this._events:this._trimBufferThenGetEvents(),u=this.scheduler,h=o.length,f;if(this.closed)throw new _n.ObjectUnsubscribedError;if(this.isStopped||this.hasError?f=_t.Subscription.EMPTY:(this.observers.push(s),f=new Ec.SubjectSubscription(this,s)),u&&s.add(s=new Dc.ObserveOnSubscriber(s,u)),n)for(var p=0;p<h&&!s.closed;p++)s.next(o[p]);else for(var p=0;p<h&&!s.closed;p++)s.next(o[p].value);return this.hasError?s.error(this.thrownError):this.isStopped&&s.complete(),f},r.prototype._getNow=function(){return(this.scheduler||Qm.queue).now()},r.prototype._trimBufferThenGetEvents=function(){for(var s=this._getNow(),n=this._bufferSize,o=this._windowTime,u=this._events,h=u.length,f=0;f<h&&!(s-u[f].time<o);)f++;return h>n&&(f=Math.max(f,h-n)),f>0&&u.splice(0,f),u},r}(Mt.Subject);t.ReplaySubject=i;var c=function(){function l(r,s){this.time=r,this.value=s}return l}()}),Hm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c,l,r){l&&typeof l!="function"&&(r=l);var s=typeof l=="function"?l:void 0,n=new Mc.ReplaySubject(i,c,r);return function(o){return mn.multicast(function(){return n},s)(o)}}t.publishReplay=e}),Zm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(r.length===1)if(Me.isArray(r[0]))r=r[0];else return r[0];return Ms.fromArray(r,void 0).lift(new c)}t.race=i;var c=function(){function r(){}return r.prototype.call=function(s,n){return n.subscribe(new l(s))},r}();t.RaceOperator=c;var l=function(r){e(s,r);function s(n){var o=r.call(this,n)||this;return o.hasFirst=!1,o.observables=[],o.subscriptions=[],o}return s.prototype._next=function(n){this.observables.push(n)},s.prototype._complete=function(){var n=this.observables,o=n.length;if(o===0)this.destination.complete();else{for(var u=0;u<o&&!this.hasFirst;u++){var h=n[u],f=Ne.subscribeToResult(this,h,void 0,u);this.subscriptions&&this.subscriptions.push(f),this.add(f)}this.observables=null}},s.prototype.notifyNext=function(n,o,u){if(!this.hasFirst){this.hasFirst=!0;for(var h=0;h<this.subscriptions.length;h++)if(h!==u){var f=this.subscriptions[h];f.unsubscribe(),this.remove(f)}this.subscriptions=null}this.destination.next(o)},s}(pn.OuterSubscriber);t.RaceSubscriber=l}),Xm=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return function(r){return i.length===1&&Me.isArray(i[0])&&(i=i[0]),r.lift.call(Zm.race.apply(void 0,[r].concat(i)))}}t.race=e}),Km=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return r===void 0&&(r=-1),function(s){return r===0?Is.empty():r<0?s.lift(new c(-1,s)):s.lift(new c(r-1,s))}}t.repeat=i;var c=function(){function r(s,n){this.count=s,this.source=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.count,this.source))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.count=o,h.source=u,h}return s.prototype.complete=function(){if(!this.isStopped){var n=this,o=n.source,u=n.count;if(u===0)return r.prototype.complete.call(this);u>-1&&(this.count=u-1),o.subscribe(this._unsubscribeAndRecycle())}},s}(R.Subscriber)}),Jm=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.repeatWhen=i;var c=function(){function r(s){this.notifier=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.notifier,n))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.notifier=o,h.source=u,h.sourceIsBeingSubscribedTo=!0,h}return s.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},s.prototype.notifyComplete=function(){if(this.sourceIsBeingSubscribedTo===!1)return r.prototype.complete.call(this)},s.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return r.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},s.prototype._unsubscribe=function(){var n=this,o=n.notifications,u=n.retriesSubscription;o&&(o.unsubscribe(),this.notifications=void 0),u&&(u.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},s.prototype._unsubscribeAndRecycle=function(){var n=this._unsubscribe;return this._unsubscribe=null,r.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=n,this},s.prototype.subscribeToRetries=function(){this.notifications=new Mt.Subject;var n;try{var o=this.notifier;n=o(this.notifications)}catch(u){return r.prototype.complete.call(this)}this.retries=n,this.retriesSubscription=P.innerSubscribe(n,new P.SimpleInnerSubscriber(this))},s}(P.SimpleOuterSubscriber)}),$m=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return r===void 0&&(r=-1),function(s){return s.lift(new c(r,s))}}t.retry=i;var c=function(){function r(s,n){this.count=s,this.source=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.count,this.source))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.count=o,h.source=u,h}return s.prototype.error=function(n){if(!this.isStopped){var o=this,u=o.source,h=o.count;if(h===0)return r.prototype.error.call(this,n);h>-1&&(this.count=h-1),u.subscribe(this._unsubscribeAndRecycle())}},s}(R.Subscriber)}),ty=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r,s))}}t.retryWhen=i;var c=function(){function r(s,n){this.notifier=s,this.source=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.notifier,this.source))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.notifier=o,h.source=u,h}return s.prototype.error=function(n){if(!this.isStopped){var o=this.errors,u=this.retries,h=this.retriesSubscription;if(u)this.errors=void 0,this.retriesSubscription=void 0;else{o=new Mt.Subject;try{var f=this.notifier;u=f(o)}catch(p){return r.prototype.error.call(this,p)}h=P.innerSubscribe(u,new P.SimpleInnerSubscriber(this))}this._unsubscribeAndRecycle(),this.errors=o,this.retries=u,this.retriesSubscription=h,o.next(n)}},s.prototype._unsubscribe=function(){var n=this,o=n.errors,u=n.retriesSubscription;o&&(o.unsubscribe(),this.errors=void 0),u&&(u.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},s.prototype.notifyNext=function(){var n=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=n,this.source.subscribe(this)},s}(P.SimpleOuterSubscriber)}),ey=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.sample=i;var c=function(){function r(s){this.notifier=s}return r.prototype.call=function(s,n){var o=new l(s),u=n.subscribe(o);return u.add(P.innerSubscribe(this.notifier,new P.SimpleInnerSubscriber(o))),u},r}(),l=function(r){e(s,r);function s(){var n=r!==null&&r.apply(this,arguments)||this;return n.hasValue=!1,n}return s.prototype._next=function(n){this.value=n,this.hasValue=!0},s.prototype.notifyNext=function(){this.emitValue()},s.prototype.notifyComplete=function(){this.emitValue()},s.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},s}(P.SimpleOuterSubscriber)}),ny=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n){return n===void 0&&(n=te.async),function(o){return o.lift(new c(s,n))}}t.sampleTime=i;var c=function(){function s(n,o){this.period=n,this.scheduler=o}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.period,this.scheduler))},s}(),l=function(s){e(n,s);function n(o,u,h){var f=s.call(this,o)||this;return f.period=u,f.scheduler=h,f.hasValue=!1,f.add(h.schedule(r,u,{subscriber:f,period:u})),f}return n.prototype._next=function(o){this.lastValue=o,this.hasValue=!0},n.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},n}(R.Subscriber);function r(s){var n=s.subscriber,o=s.period;n.notifyNext(),this.schedule(s,o)}}),sy=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n){return function(o){return o.lift(new c(s,n))}}t.sequenceEqual=i;var c=function(){function s(n,o){this.compareTo=n,this.comparator=o}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.compareTo,this.comparator))},s}();t.SequenceEqualOperator=c;var l=function(s){e(n,s);function n(o,u,h){var f=s.call(this,o)||this;return f.compareTo=u,f.comparator=h,f._a=[],f._b=[],f._oneComplete=!1,f.destination.add(u.subscribe(new r(o,f))),f}return n.prototype._next=function(o){this._oneComplete&&this._b.length===0?this.emit(!1):(this._a.push(o),this.checkValues())},n.prototype._complete=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0,this.unsubscribe()},n.prototype.checkValues=function(){for(var o=this,u=o._a,h=o._b,f=o.comparator;u.length>0&&h.length>0;){var p=u.shift(),d=h.shift(),_=!1;try{_=f?f(p,d):p===d}catch(y){this.destination.error(y)}_||this.emit(!1)}},n.prototype.emit=function(o){var u=this.destination;u.next(o),u.complete()},n.prototype.nextB=function(o){this._oneComplete&&this._a.length===0?this.emit(!1):(this._b.push(o),this.checkValues())},n.prototype.completeB=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=!0},n}(R.Subscriber);t.SequenceEqualSubscriber=l;var r=function(s){e(n,s);function n(o,u){var h=s.call(this,o)||this;return h.parent=u,h}return n.prototype._next=function(o){this.parent.nextB(o)},n.prototype._error=function(o){this.parent.error(o),this.unsubscribe()},n.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},n}(R.Subscriber)}),iy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){return new Mt.Subject}function i(){return function(c){return Br.refCount()(mn.multicast(e)(c))}}t.share=i}),ry=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l,r){var s;return c&&typeof c=="object"?s=c:s={bufferSize:c,windowTime:l,refCount:!1,scheduler:r},function(n){return n.lift(i(s))}}t.shareReplay=e;function i(c){var l=c.bufferSize,r=l===void 0?Number.POSITIVE_INFINITY:l,s=c.windowTime,n=s===void 0?Number.POSITIVE_INFINITY:s,o=c.refCount,u=c.scheduler,h,f=0,p,d=!1,_=!1;return function(m){f++;var b;!h||d?(d=!1,h=new Mc.ReplaySubject(r,n,u),b=h.subscribe(this),p=m.subscribe({next:function(k){h.next(k)},error:function(k){d=!0,h.error(k)},complete:function(){_=!0,p=void 0,h.complete()}}),_&&(p=void 0)):b=h.subscribe(this),this.add(function(){f--,b.unsubscribe(),b=void 0,p&&!_&&o&&f===0&&(p.unsubscribe(),p=void 0,h=void 0)})}}}),oy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r,s))}}t.single=i;var c=function(){function r(s,n){this.predicate=s,this.source=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate,this.source))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.predicate=o,h.source=u,h.seenValue=!1,h.index=0,h}return s.prototype.applySingleValue=function(n){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=n)},s.prototype._next=function(n){var o=this.index++;this.predicate?this.tryNext(n,o):this.applySingleValue(n)},s.prototype.tryNext=function(n,o){try{this.predicate(n,o,this.source)&&this.applySingleValue(n)}catch(u){this.destination.error(u)}},s.prototype._complete=function(){var n=this.destination;this.index>0?(n.next(this.seenValue?this.singleValue:void 0),n.complete()):n.error(new Ai.EmptyError)},s}(R.Subscriber)}),ay=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.skip=i;var c=function(){function r(s){this.total=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.total))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.total=o,u.count=0,u}return s.prototype._next=function(n){++this.count>this.total&&this.destination.next(n)},s}(R.Subscriber)}),cy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.skipLast=i;var c=function(){function r(s){if(this._skipCount=s,this._skipCount<0)throw new Ps.ArgumentOutOfRangeError}return r.prototype.call=function(s,n){return this._skipCount===0?n.subscribe(new R.Subscriber(s)):n.subscribe(new l(s,this._skipCount))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u._skipCount=o,u._count=0,u._ring=new Array(o),u}return s.prototype._next=function(n){var o=this._skipCount,u=this._count++;if(u<o)this._ring[u]=n;else{var h=u%o,f=this._ring,p=f[h];f[h]=n,this.destination.next(p)}},s}(R.Subscriber)}),uy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.skipUntil=i;var c=function(){function r(s){this.notifier=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.notifier))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;u.hasValue=!1;var h=new P.SimpleInnerSubscriber(u);u.add(h),u.innerSubscription=h;var f=P.innerSubscribe(o,h);return f!==h&&(u.add(f),u.innerSubscription=f),u}return s.prototype._next=function(n){this.hasValue&&r.prototype._next.call(this,n)},s.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},s.prototype.notifyComplete=function(){},s}(P.SimpleOuterSubscriber)}),ly=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.skipWhile=i;var c=function(){function r(s){this.predicate=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.predicate=o,u.skipping=!0,u.index=0,u}return s.prototype._next=function(n){var o=this.destination;this.skipping&&this.tryCallPredicate(n),this.skipping||o.next(n)},s.prototype.tryCallPredicate=function(n){try{var o=this.predicate(n,this.index++);this.skipping=Boolean(o)}catch(u){this.destination.error(u)}},s}(R.Subscriber)}),hy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];var l=i[i.length-1];return Se.isScheduler(l)?(i.pop(),function(r){return ki.concat(i,r,l)}):function(r){return ki.concat(i,r)}}t.startWith=e}),Nc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=1,i=function(){return Promise.resolve()}(),c={};function l(r){return r in c?(delete c[r],!0):!1}t.Immediate={setImmediate:function(r){var s=e++;return c[s]=!0,i.then(function(){return l(s)&&r()}),s},clearImmediate:function(r){l(r)}},t.TestTools={pending:function(){return Object.keys(c).length}}}),fy=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s){var n=c.call(this,r,s)||this;return n.scheduler=r,n.work=s,n}return l.prototype.requestAsyncId=function(r,s,n){return n===void 0&&(n=0),n!==null&&n>0?c.prototype.requestAsyncId.call(this,r,s,n):(r.actions.push(this),r.scheduled||(r.scheduled=Nc.Immediate.setImmediate(r.flush.bind(r,null))))},l.prototype.recycleAsyncId=function(r,s,n){if(n===void 0&&(n=0),n!==null&&n>0||n===null&&this.delay>0)return c.prototype.recycleAsyncId.call(this,r,s,n);r.actions.length===0&&(Nc.Immediate.clearImmediate(s),r.scheduled=void 0)},l}(Rr.AsyncAction);t.AsapAction=i}),py=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(){return c!==null&&c.apply(this,arguments)||this}return l.prototype.flush=function(r){this.active=!0,this.scheduled=void 0;var s=this.actions,n,o=-1,u=s.length;r=r||s.shift();do if(n=r.execute(r.state,r.delay))break;while(++o<u&&(r=s.shift()));if(this.active=!1,n){for(;++o<u&&(r=s.shift());)r.unsubscribe();throw n}},l}(Fr.AsyncScheduler);t.AsapScheduler=i}),zr=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.asapScheduler=new py.AsapScheduler(fy.AsapAction),t.asap=t.asapScheduler}),dy=v(function(a,t){var e=S&&S.__extends||function(){var c=function(l,r){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o])},c(l,r)};return function(l,r){c(l,r);function s(){this.constructor=l}l.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){e(l,c);function l(r,s,n){s===void 0&&(s=0),n===void 0&&(n=zr.asap);var o=c.call(this)||this;return o.source=r,o.delayTime=s,o.scheduler=n,(!Ds.isNumeric(s)||s<0)&&(o.delayTime=0),(!n||typeof n.schedule!="function")&&(o.scheduler=zr.asap),o}return l.create=function(r,s,n){return s===void 0&&(s=0),n===void 0&&(n=zr.asap),new l(r,s,n)},l.dispatch=function(r){var s=r.source,n=r.subscriber;return this.add(s.subscribe(n))},l.prototype._subscribe=function(r){var s=this.delayTime,n=this.source,o=this.scheduler;return o.schedule(l.dispatch,s,{source:n,subscriber:r})},l}(pt.Observable);t.SubscribeOnObservable=i}),_y=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l){return l===void 0&&(l=0),function(s){return s.lift(new i(c,l))}}t.subscribeOn=e;var i=function(){function c(l,r){this.scheduler=l,this.delay=r}return c.prototype.call=function(l,r){return new dy.SubscribeOnObservable(r,this.delay,this.scheduler).subscribe(l)},c}()}),Ni=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return typeof s=="function"?function(n){return n.pipe(i(function(o,u){return es.from(r(o,u)).pipe(dn.map(function(h,f){return s(o,h,u,f)}))}))}:function(n){return n.lift(new c(r))}}t.switchMap=i;var c=function(){function r(s){this.project=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.project))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.project=o,u.index=0,u}return s.prototype._next=function(n){var o,u=this.index++;try{o=this.project(n,u)}catch(h){this.destination.error(h);return}this._innerSub(o)},s.prototype._innerSub=function(n){var o=this.innerSubscription;o&&o.unsubscribe();var u=new P.SimpleInnerSubscriber(this),h=this.destination;h.add(u),this.innerSubscription=P.innerSubscribe(n,u),this.innerSubscription!==u&&h.add(this.innerSubscription)},s.prototype._complete=function(){var n=this.innerSubscription;(!n||n.closed)&&r.prototype._complete.call(this),this.unsubscribe()},s.prototype._unsubscribe=function(){this.innerSubscription=void 0},s.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&r.prototype._complete.call(this)},s.prototype.notifyNext=function(n){this.destination.next(n)},s}(P.SimpleOuterSubscriber)}),my=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){return Ni.switchMap(Es.identity)}t.switchAll=e}),yy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return c?Ni.switchMap(function(){return i},c):Ni.switchMap(function(){return i})}t.switchMapTo=e}),gy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(s){return s.lift(new c(r))}}t.takeUntil=i;var c=function(){function r(s){this.notifier=s}return r.prototype.call=function(s,n){var o=new l(s),u=P.innerSubscribe(this.notifier,new P.SimpleInnerSubscriber(o));return u&&!o.seenValue?(o.add(u),n.subscribe(o)):o},r}(),l=function(r){e(s,r);function s(n){var o=r.call(this,n)||this;return o.seenValue=!1,o}return s.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},s.prototype.notifyComplete=function(){},s}(P.SimpleOuterSubscriber)}),by=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return s===void 0&&(s=!1),function(n){return n.lift(new c(r,s))}}t.takeWhile=i;var c=function(){function r(s,n){this.predicate=s,this.inclusive=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.predicate,this.inclusive))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.predicate=o,h.inclusive=u,h.index=0,h}return s.prototype._next=function(n){var o=this.destination,u;try{u=this.predicate(n,this.index++)}catch(h){o.error(h);return}this.nextOrComplete(n,u)},s.prototype.nextOrComplete=function(n,o){var u=this.destination;Boolean(o)?u.next(n):(this.inclusive&&u.next(n),u.complete())},s}(R.Subscriber)}),He=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){}t.noop=e}),vy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s,n){return function(u){return u.lift(new c(r,s,n))}}t.tap=i;var c=function(){function r(s,n,o){this.nextOrObserver=s,this.error=n,this.complete=o}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.nextOrObserver,this.error,this.complete))},r}(),l=function(r){e(s,r);function s(n,o,u,h){var f=r.call(this,n)||this;return f._tapNext=He.noop,f._tapError=He.noop,f._tapComplete=He.noop,f._tapError=u||He.noop,f._tapComplete=h||He.noop,Si.isFunction(o)?(f._context=f,f._tapNext=o):o&&(f._context=o,f._tapNext=o.next||He.noop,f._tapError=o.error||He.noop,f._tapComplete=o.complete||He.noop),f}return s.prototype._next=function(n){try{this._tapNext.call(this._context,n)}catch(o){this.destination.error(o);return}this.destination.next(n)},s.prototype._error=function(n){try{this._tapError.call(this._context,n)}catch(o){this.destination.error(o);return}this.destination.error(n)},s.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(n){this.destination.error(n);return}return this.destination.complete()},s}(R.Subscriber)}),Ic=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.defaultThrottleConfig={leading:!0,trailing:!1};function i(r,s){return s===void 0&&(s=t.defaultThrottleConfig),function(n){return n.lift(new c(r,!!s.leading,!!s.trailing))}}t.throttle=i;var c=function(){function r(s,n,o){this.durationSelector=s,this.leading=n,this.trailing=o}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.durationSelector,this.leading,this.trailing))},r}(),l=function(r){e(s,r);function s(n,o,u,h){var f=r.call(this,n)||this;return f.destination=n,f.durationSelector=o,f._leading=u,f._trailing=h,f._hasValue=!1,f}return s.prototype._next=function(n){this._hasValue=!0,this._sendValue=n,this._throttled||(this._leading?this.send():this.throttle(n))},s.prototype.send=function(){var n=this,o=n._hasValue,u=n._sendValue;o&&(this.destination.next(u),this.throttle(u)),this._hasValue=!1,this._sendValue=void 0},s.prototype.throttle=function(n){var o=this.tryDurationSelector(n);o&&this.add(this._throttled=P.innerSubscribe(o,new P.SimpleInnerSubscriber(this)))},s.prototype.tryDurationSelector=function(n){try{return this.durationSelector(n)}catch(o){return this.destination.error(o),null}},s.prototype.throttlingDone=function(){var n=this,o=n._throttled,u=n._trailing;o&&o.unsubscribe(),this._throttled=void 0,u&&this.send()},s.prototype.notifyNext=function(){this.throttlingDone()},s.prototype.notifyComplete=function(){this.throttlingDone()},s}(P.SimpleOuterSubscriber)}),wy=v(function(a,t){var e=S&&S.__extends||function(){var s=function(n,o){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)h.hasOwnProperty(f)&&(u[f]=h[f])},s(n,o)};return function(n,o){s(n,o);function u(){this.constructor=n}n.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(s,n,o){return n===void 0&&(n=te.async),o===void 0&&(o=Ic.defaultThrottleConfig),function(u){return u.lift(new c(s,n,o.leading,o.trailing))}}t.throttleTime=i;var c=function(){function s(n,o,u,h){this.duration=n,this.scheduler=o,this.leading=u,this.trailing=h}return s.prototype.call=function(n,o){return o.subscribe(new l(n,this.duration,this.scheduler,this.leading,this.trailing))},s}(),l=function(s){e(n,s);function n(o,u,h,f,p){var d=s.call(this,o)||this;return d.duration=u,d.scheduler=h,d.leading=f,d.trailing=p,d._hasTrailingValue=!1,d._trailingValue=null,d}return n.prototype._next=function(o){this.throttled?this.trailing&&(this._trailingValue=o,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(r,this.duration,{subscriber:this})),this.leading?this.destination.next(o):this.trailing&&(this._trailingValue=o,this._hasTrailingValue=!0))},n.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},n.prototype.clearThrottle=function(){var o=this.throttled;o&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),o.unsubscribe(),this.remove(o),this.throttled=null)},n}(R.Subscriber);function r(s){var n=s.subscriber;n.clearThrottle()}}),Sy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return new pt.Observable(function(c){var l;try{l=i()}catch(s){c.error(s);return}var r=l?es.from(l):Is.empty();return r.subscribe(c)})}t.defer=e}),xy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c){return c===void 0&&(c=te.async),function(l){return Sy.defer(function(){return l.pipe(Di.scan(function(r,s){var n=r.current;return{value:s,current:c.now(),last:n}},{current:c.now(),value:void 0,last:void 0}),dn.map(function(r){var s=r.current,n=r.last,o=r.value;return new i(o,s-n)}))})}}t.timeInterval=e;var i=function(){function c(l,r){this.value=l,this.interval=r}return c}();t.TimeInterval=i}),Oy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function i(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return i.prototype=Object.create(Error.prototype),i}();t.TimeoutError=e}),Pc=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s,n){return n===void 0&&(n=te.async),function(o){var u=Tc.isDate(r),h=u?+r-n.now():Math.abs(r);return o.lift(new c(h,u,s,n))}}t.timeoutWith=i;var c=function(){function r(s,n,o,u){this.waitFor=s,this.absoluteTimeout=n,this.withObservable=o,this.scheduler=u}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},r}(),l=function(r){e(s,r);function s(n,o,u,h,f){var p=r.call(this,n)||this;return p.absoluteTimeout=o,p.waitFor=u,p.withObservable=h,p.scheduler=f,p.scheduleTimeout(),p}return s.dispatchTimeout=function(n){var o=n.withObservable;n._unsubscribeAndRecycle(),n.add(P.innerSubscribe(o,new P.SimpleInnerSubscriber(n)))},s.prototype.scheduleTimeout=function(){var n=this.action;n?this.action=n.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(s.dispatchTimeout,this.waitFor,this))},s.prototype._next=function(n){this.absoluteTimeout||this.scheduleTimeout(),r.prototype._next.call(this,n)},s.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},s}(P.SimpleOuterSubscriber)}),Ty=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i,c){return c===void 0&&(c=te.async),Pc.timeoutWith(i,kc.throwError(new Oy.TimeoutError),c)}t.timeout=e}),ky=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c){return c===void 0&&(c=te.async),dn.map(function(l){return new i(l,c.now())})}t.timestamp=e;var i=function(){function c(l,r){this.value=l,this.timestamp=r}return c}();t.Timestamp=i}),Ay=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l,r){return r===0?[l]:(c.push(l),c)}function i(){return Mi.reduce(e,[])}t.toArray=i}),Cy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(n){return n.lift(new c(r))}}t.window=i;var c=function(){function r(s){this.windowBoundaries=s}return r.prototype.call=function(s,n){var o=new l(s),u=n.subscribe(o);return u.closed||o.add(P.innerSubscribe(this.windowBoundaries,new P.SimpleInnerSubscriber(o))),u},r}(),l=function(r){e(s,r);function s(n){var o=r.call(this,n)||this;return o.window=new Mt.Subject,n.next(o.window),o}return s.prototype.notifyNext=function(){this.openWindow()},s.prototype.notifyError=function(n){this._error(n)},s.prototype.notifyComplete=function(){this._complete()},s.prototype._next=function(n){this.window.next(n)},s.prototype._error=function(n){this.window.error(n),this.destination.error(n)},s.prototype._complete=function(){this.window.complete(),this.destination.complete()},s.prototype._unsubscribe=function(){this.window=null},s.prototype.openWindow=function(){var n=this.window;n&&n.complete();var o=this.destination,u=this.window=new Mt.Subject;o.next(u)},s}(P.SimpleOuterSubscriber)}),Ey=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return s===void 0&&(s=0),function(o){return o.lift(new c(r,s))}}t.windowCount=i;var c=function(){function r(s,n){this.windowSize=s,this.startWindowEvery=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.windowSize,this.startWindowEvery))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.destination=n,h.windowSize=o,h.startWindowEvery=u,h.windows=[new Mt.Subject],h.count=0,n.next(h.windows[0]),h}return s.prototype._next=function(n){for(var o=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,u=this.destination,h=this.windowSize,f=this.windows,p=f.length,d=0;d<p&&!this.closed;d++)f[d].next(n);var _=this.count-h+1;if(_>=0&&_%o==0&&!this.closed&&f.shift().complete(),++this.count%o==0&&!this.closed){var y=new Mt.Subject;f.push(y),u.next(y)}},s.prototype._error=function(n){var o=this.windows;if(o)for(;o.length>0&&!this.closed;)o.shift().error(n);this.destination.error(n)},s.prototype._complete=function(){var n=this.windows;if(n)for(;n.length>0&&!this.closed;)n.shift().complete();this.destination.complete()},s.prototype._unsubscribe=function(){this.count=0,this.windows=null},s}(R.Subscriber)}),Dy=v(function(a,t){var e=S&&S.__extends||function(){var u=function(h,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,d){p.__proto__=d}||function(p,d){for(var _ in d)d.hasOwnProperty(_)&&(p[_]=d[_])},u(h,f)};return function(h,f){u(h,f);function p(){this.constructor=h}h.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(u){var h=te.async,f=null,p=Number.POSITIVE_INFINITY;return Se.isScheduler(arguments[3])&&(h=arguments[3]),Se.isScheduler(arguments[2])?h=arguments[2]:Ds.isNumeric(arguments[2])&&(p=Number(arguments[2])),Se.isScheduler(arguments[1])?h=arguments[1]:Ds.isNumeric(arguments[1])&&(f=Number(arguments[1])),function(_){return _.lift(new c(u,f,p,h))}}t.windowTime=i;var c=function(){function u(h,f,p,d){this.windowTimeSpan=h,this.windowCreationInterval=f,this.maxWindowSize=p,this.scheduler=d}return u.prototype.call=function(h,f){return f.subscribe(new r(h,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},u}(),l=function(u){e(h,u);function h(){var f=u!==null&&u.apply(this,arguments)||this;return f._numberOfNextedValues=0,f}return h.prototype.next=function(f){this._numberOfNextedValues++,u.prototype.next.call(this,f)},Object.defineProperty(h.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),h}(Mt.Subject),r=function(u){e(h,u);function h(f,p,d,_,y){var m=u.call(this,f)||this;m.destination=f,m.windowTimeSpan=p,m.windowCreationInterval=d,m.maxWindowSize=_,m.scheduler=y,m.windows=[];var b=m.openWindow();if(d!==null&&d>=0){var k={subscriber:m,window:b,context:null},x={windowTimeSpan:p,windowCreationInterval:d,subscriber:m,scheduler:y};m.add(y.schedule(o,p,k)),m.add(y.schedule(n,d,x))}else{var g={subscriber:m,window:b,windowTimeSpan:p};m.add(y.schedule(s,p,g))}return m}return h.prototype._next=function(f){for(var p=this.windows,d=p.length,_=0;_<d;_++){var y=p[_];y.closed||(y.next(f),y.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(y))}},h.prototype._error=function(f){for(var p=this.windows;p.length>0;)p.shift().error(f);this.destination.error(f)},h.prototype._complete=function(){for(var f=this.windows;f.length>0;){var p=f.shift();p.closed||p.complete()}this.destination.complete()},h.prototype.openWindow=function(){var f=new l;this.windows.push(f);var p=this.destination;return p.next(f),f},h.prototype.closeWindow=function(f){f.complete();var p=this.windows;p.splice(p.indexOf(f),1)},h}(R.Subscriber);function s(u){var h=u.subscriber,f=u.windowTimeSpan,p=u.window;p&&h.closeWindow(p),u.window=h.openWindow(),this.schedule(u,f)}function n(u){var h=u.windowTimeSpan,f=u.subscriber,p=u.scheduler,d=u.windowCreationInterval,_=f.openWindow(),y=this,m={action:y,subscription:null},b={subscriber:f,window:_,context:m};m.subscription=p.schedule(o,h,b),y.add(m.subscription),y.schedule(u,d)}function o(u){var h=u.subscriber,f=u.window,p=u.context;p&&p.action&&p.subscription&&p.action.remove(p.subscription),h.closeWindow(f)}}),My=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r,s){return function(n){return n.lift(new c(r,s))}}t.windowToggle=i;var c=function(){function r(s,n){this.openings=s,this.closingSelector=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.openings,this.closingSelector))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;return h.openings=o,h.closingSelector=u,h.contexts=[],h.add(h.openSubscription=Ne.subscribeToResult(h,o,o)),h}return s.prototype._next=function(n){var o=this.contexts;if(o)for(var u=o.length,h=0;h<u;h++)o[h].window.next(n)},s.prototype._error=function(n){var o=this.contexts;if(this.contexts=null,o)for(var u=o.length,h=-1;++h<u;){var f=o[h];f.window.error(n),f.subscription.unsubscribe()}r.prototype._error.call(this,n)},s.prototype._complete=function(){var n=this.contexts;if(this.contexts=null,n)for(var o=n.length,u=-1;++u<o;){var h=n[u];h.window.complete(),h.subscription.unsubscribe()}r.prototype._complete.call(this)},s.prototype._unsubscribe=function(){var n=this.contexts;if(this.contexts=null,n)for(var o=n.length,u=-1;++u<o;){var h=n[u];h.window.unsubscribe(),h.subscription.unsubscribe()}},s.prototype.notifyNext=function(n,o,u,h,f){if(n===this.openings){var p=void 0;try{var d=this.closingSelector;p=d(o)}catch(k){return this.error(k)}var _=new Mt.Subject,y=new _t.Subscription,m={window:_,subscription:y};this.contexts.push(m);var b=Ne.subscribeToResult(this,p,m);b.closed?this.closeWindow(this.contexts.length-1):(b.context=m,y.add(b)),this.destination.next(_)}else this.closeWindow(this.contexts.indexOf(n))},s.prototype.notifyError=function(n){this.error(n)},s.prototype.notifyComplete=function(n){n!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(n.context))},s.prototype.closeWindow=function(n){if(n!==-1){var o=this.contexts,u=o[n],h=u.window,f=u.subscription;o.splice(n,1),h.complete(),f.unsubscribe()}},s}(pn.OuterSubscriber)}),Ny=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(r){return function(n){return n.lift(new c(r))}}t.windowWhen=i;var c=function(){function r(s){this.closingSelector=s}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.closingSelector))},r}(),l=function(r){e(s,r);function s(n,o){var u=r.call(this,n)||this;return u.destination=n,u.closingSelector=o,u.openWindow(),u}return s.prototype.notifyNext=function(n,o,u,h,f){this.openWindow(f)},s.prototype.notifyError=function(n){this._error(n)},s.prototype.notifyComplete=function(n){this.openWindow(n)},s.prototype._next=function(n){this.window.next(n)},s.prototype._error=function(n){this.window.error(n),this.destination.error(n),this.unsubscribeClosingNotification()},s.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},s.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},s.prototype.openWindow=function(n){n===void 0&&(n=null),n&&(this.remove(n),n.unsubscribe());var o=this.window;o&&o.complete();var u=this.window=new Mt.Subject;this.destination.next(u);var h;try{var f=this.closingSelector;h=f()}catch(p){this.destination.error(p),this.window.error(p);return}this.add(this.closingNotification=Ne.subscribeToResult(this,h))},s}(pn.OuterSubscriber)}),Iy=v(function(a,t){var e=S&&S.__extends||function(){var r=function(s,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var h in u)u.hasOwnProperty(h)&&(o[h]=u[h])},r(s,n)};return function(s,n){r(s,n);function o(){this.constructor=s}s.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];return function(n){var o;typeof r[r.length-1]=="function"&&(o=r.pop());var u=r;return n.lift(new c(u,o))}}t.withLatestFrom=i;var c=function(){function r(s,n){this.observables=s,this.project=n}return r.prototype.call=function(s,n){return n.subscribe(new l(s,this.observables,this.project))},r}(),l=function(r){e(s,r);function s(n,o,u){var h=r.call(this,n)||this;h.observables=o,h.project=u,h.toRespond=[];var f=o.length;h.values=new Array(f);for(var p=0;p<f;p++)h.toRespond.push(p);for(var p=0;p<f;p++){var d=o[p];h.add(Ne.subscribeToResult(h,d,void 0,p))}return h}return s.prototype.notifyNext=function(n,o,u){this.values[u]=o;var h=this.toRespond;if(h.length>0){var f=h.indexOf(u);f!==-1&&h.splice(f,1)}},s.prototype.notifyComplete=function(){},s.prototype._next=function(n){if(this.toRespond.length===0){var o=[n].concat(this.values);this.project?this._tryProject(o):this.destination.next(o)}},s.prototype._tryProject=function(n){var o;try{o=this.project.apply(this,n)}catch(u){this.destination.error(u);return}this.destination.next(o)},s}(pn.OuterSubscriber)}),jc=v(function(a,t){var e=S&&S.__extends||function(){var o=function(u,h){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var d in p)p.hasOwnProperty(d)&&(f[d]=p[d])},o(u,h)};return function(u,h){o(u,h);function f(){this.constructor=u}u.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(t,"__esModule",{value:!0});function i(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];var h=o[o.length-1];return typeof h=="function"&&o.pop(),Ms.fromArray(o,void 0).lift(new c(h))}t.zip=i;var c=function(){function o(u){this.resultSelector=u}return o.prototype.call=function(u,h){return h.subscribe(new l(u,this.resultSelector))},o}();t.ZipOperator=c;var l=function(o){e(u,o);function u(h,f,p){var d=o.call(this,h)||this;return d.resultSelector=f,d.iterators=[],d.active=0,d.resultSelector=typeof f=="function"?f:void 0,d}return u.prototype._next=function(h){var f=this.iterators;Me.isArray(h)?f.push(new s(h)):typeof h[Ye.iterator]=="function"?f.push(new r(h[Ye.iterator]())):f.push(new n(this.destination,this,h))},u.prototype._complete=function(){var h=this.iterators,f=h.length;if(this.unsubscribe(),f===0){this.destination.complete();return}this.active=f;for(var p=0;p<f;p++){var d=h[p];if(d.stillUnsubscribed){var _=this.destination;_.add(d.subscribe())}else this.active--}},u.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},u.prototype.checkIterators=function(){for(var h=this.iterators,f=h.length,p=this.destination,d=0;d<f;d++){var _=h[d];if(typeof _.hasValue=="function"&&!_.hasValue())return}for(var y=!1,m=[],d=0;d<f;d++){var _=h[d],b=_.next();if(_.hasCompleted()&&(y=!0),b.done){p.complete();return}m.push(b.value)}this.resultSelector?this._tryresultSelector(m):p.next(m),y&&p.complete()},u.prototype._tryresultSelector=function(h){var f;try{f=this.resultSelector.apply(this,h)}catch(p){this.destination.error(p);return}this.destination.next(f)},u}(R.Subscriber);t.ZipSubscriber=l;var r=function(){function o(u){this.iterator=u,this.nextResult=u.next()}return o.prototype.hasValue=function(){return!0},o.prototype.next=function(){var u=this.nextResult;return this.nextResult=this.iterator.next(),u},o.prototype.hasCompleted=function(){var u=this.nextResult;return Boolean(u&&u.done)},o}(),s=function(){function o(u){this.array=u,this.index=0,this.length=0,this.length=u.length}return o.prototype[Ye.iterator]=function(){return this},o.prototype.next=function(u){var h=this.index++,f=this.array;return h<this.length?{value:f[h],done:!1}:{value:null,done:!0}},o.prototype.hasValue=function(){return this.array.length>this.index},o.prototype.hasCompleted=function(){return this.array.length===this.index},o}(),n=function(o){e(u,o);function u(h,f,p){var d=o.call(this,h)||this;return d.parent=f,d.observable=p,d.stillUnsubscribed=!0,d.buffer=[],d.isComplete=!1,d}return u.prototype[Ye.iterator]=function(){return this},u.prototype.next=function(){var h=this.buffer;return h.length===0&&this.isComplete?{value:null,done:!0}:{value:h.shift(),done:!1}},u.prototype.hasValue=function(){return this.buffer.length>0},u.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},u.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},u.prototype.notifyNext=function(h){this.buffer.push(h),this.parent.checkIterators()},u.prototype.subscribe=function(){return P.innerSubscribe(this.observable,new P.SimpleInnerSubscriber(this))},u}(P.SimpleOuterSubscriber)}),Py=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];return function(r){return r.lift.call(jc.zip.apply(void 0,[r].concat(i)))}}t.zip=e}),jy=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0});function e(i){return function(c){return c.lift(new jc.ZipOperator(i))}}t.zipAll=e}),Rc=v(function(a,t){Object.defineProperty(t,"__esModule",{value:!0}),t.audit=vc.audit,t.auditTime=L_.auditTime,t.buffer=B_.buffer,t.bufferCount=z_.bufferCount,t.bufferTime=U_.bufferTime,t.bufferToggle=Y_.bufferToggle,t.bufferWhen=Q_.bufferWhen,t.catchError=H_.catchError,t.combineAll=Z_.combineAll,t.combineLatest=nm.combineLatest,t.concat=sm.concat,t.concatAll=xc.concatAll,t.concatMap=Oc.concatMap,t.concatMapTo=im.concatMapTo,t.count=rm.count,t.debounce=om.debounce,t.debounceTime=am.debounceTime,t.defaultIfEmpty=Ns.defaultIfEmpty,t.delay=cm.delay,t.delayWhen=um.delayWhen,t.dematerialize=lm.dematerialize,t.distinct=hm.distinct,t.distinctUntilChanged=Ac.distinctUntilChanged,t.distinctUntilKeyChanged=fm.distinctUntilKeyChanged,t.elementAt=pm.elementAt,t.endWith=dm.endWith,t.every=_m.every,t.exhaust=mm.exhaust,t.exhaustMap=ym.exhaustMap,t.expand=gm.expand,t.filter=ss.filter,t.finalize=bm.finalize,t.find=Cc.find,t.findIndex=vm.findIndex,t.first=wm.first,t.groupBy=Sm.groupBy,t.ignoreElements=xm.ignoreElements,t.isEmpty=Om.isEmpty,t.last=Tm.last,t.map=dn.map,t.mapTo=km.mapTo,t.materialize=Am.materialize,t.max=Cm.max,t.merge=Dm.merge,t.mergeAll=Wr.mergeAll,t.mergeMap=ns.mergeMap,t.flatMap=ns.flatMap,t.mergeMapTo=Mm.mergeMapTo,t.mergeScan=Nm.mergeScan,t.min=Im.min,t.multicast=mn.multicast,t.observeOn=Dc.observeOn,t.onErrorResumeNext=jm.onErrorResumeNext,t.pairwise=Rm.pairwise,t.partition=qm.partition,t.pluck=Vm.pluck,t.publish=Wm.publish,t.publishBehavior=Bm.publishBehavior,t.publishLast=Um.publishLast,t.publishReplay=Hm.publishReplay,t.race=Xm.race,t.reduce=Mi.reduce,t.repeat=Km.repeat,t.repeatWhen=Jm.repeatWhen,t.retry=$m.retry,t.retryWhen=ty.retryWhen,t.refCount=Br.refCount,t.sample=ey.sample,t.sampleTime=ny.sampleTime,t.scan=Di.scan,t.sequenceEqual=sy.sequenceEqual,t.share=iy.share,t.shareReplay=ry.shareReplay,t.single=oy.single,t.skip=ay.skip,t.skipLast=cy.skipLast,t.skipUntil=uy.skipUntil,t.skipWhile=ly.skipWhile,t.startWith=hy.startWith,t.subscribeOn=_y.subscribeOn,t.switchAll=my.switchAll,t.switchMap=Ni.switchMap,t.switchMapTo=yy.switchMapTo,t.take=Lr.take,t.takeLast=Ei.takeLast,t.takeUntil=gy.takeUntil,t.takeWhile=by.takeWhile,t.tap=vy.tap,t.throttle=Ic.throttle,t.throttleTime=wy.throttleTime,t.throwIfEmpty=Ci.throwIfEmpty,t.timeInterval=xy.timeInterval,t.timeout=Ty.timeout,t.timeoutWith=Pc.timeoutWith,t.timestamp=ky.timestamp,t.toArray=Ay.toArray,t.window=Cy.window,t.windowCount=Ey.windowCount,t.windowTime=Dy.windowTime,t.windowToggle=My.windowToggle,t.windowWhen=Ny.windowWhen,t.withLatestFrom=Iy.withLatestFrom,t.zip=Py.zip,t.zipAll=jy.zipAll}),Ur=Rc.map,Fc=Rc.switchMap;var qc;(function(a){a[a.Stopped=0]="Stopped",a[a.Playing=1]="Playing"})(qc||(qc={}));var Vc={};function Wc(){return Li(Vc)}function Lc(a,t){Wi(Vc,[a,t])}function Bc(){let a=new wi(120),t=new wi(new Array(16).fill(-1).map(l=>[l,l,l,l])),e=new wi(0),i=Ir([e.asObservable(),a.asObservable()]).pipe(Fc(([l,r])=>(l===1?_c(6e4/(r*8)):hc(0)).pipe(Ur(s=>({playing:l,tick:s,bpm:r})))));return[Ir([i,t.asObservable()]).pipe(Ur(([l,r])=>{let s=Math.floor(l.tick/8),n=Math.floor(l.tick%8/2),o=Math.floor(l.tick%8),u=l.tick%r.length;return{playHead:{...l,row:u,bar:s,beat:n,eighthNote:o},sequence:r,events:l.playing===1?r[u].filter(f=>f>-1&&f<128).map(f=>({play:f})):[]}})),{play(){e.next(1)},stop(){e.next(0)},setEvent(l,r,s){t.next(t.getValue().map((n,o)=>o===r?n.map((u,h)=>h===l?s:u):n))}}]}function Ry(a){let t,e,i,c;return t=new Ja({props:{activeRow:a[1],activeCol:a[2],dragging:a[0],tracker:a[3].sequence,playingRow:a[3].playHead.playing?a[3].playHead.row:void 0}}),t.$on("setEvent",a[6]),t.$on("focus",a[7]),t.$on("drop",a[5]),{c(){ne(t.$$.fragment)},m(l,r){Zt(t,l,r),e=!0,i||(c=Ct(window,"keydown",a[8]),i=!0)},p(l,[r]){let s={};r&2&&(s.activeRow=l[1]),r&4&&(s.activeCol=l[2]),r&1&&(s.dragging=l[0]),r&8&&(s.tracker=l[3].sequence),r&8&&(s.playingRow=l[3].playHead.playing?l[3].playHead.row:void 0),t.$set(s)},i(l){e||(at(t.$$.fragment,l),e=!0)},o(l){St(t.$$.fragment,l),e=!1},d(l){Xt(t,l),i=!1,c()}}}function Fy(a,t,e){let i,[c,l]=Wc();ee(a,c,m=>e(3,i=m));let{dragging:r=void 0}=t,s=0,n=0;function o(m){e(1,s=m.detail.row),e(2,n=m.detail.col),l.setEvent(m.detail.col,m.detail.row,m.detail.event)}function u(m){m.detail.nextActive!==void 0&&(e(1,s=m.detail.nextActive.row),e(2,n=m.detail.nextActive.col)),l.setEvent(m.detail.col,m.detail.row,m.detail.event)}function h(m){e(1,s=m.detail.row),e(2,n=m.detail.col)}function f(){e(1,s=s<i.sequence.length-1?s+1:i.sequence.length)}function p(){e(1,s=s>0?s-1:0)}function d(){e(2,n=n>0?n-1:0)}function _(){e(2,n=n<3?n+1:3)}function y(m){return document.activeElement!=null&&document.activeElement!=document.body||(m.key===" "&&(i.playHead.playing?l.stop():l.play()),m.key==="Shift")?!0:(m.key==="j"&&f(),m.key==="k"&&p(),m.key==="h"&&d(),m.key==="l"&&_(),m.key==="Enter"&&(m.shiftKey?p():f()),m.key==="Tab"&&(m.shiftKey?d():_()),!1)}return a.$$set=m=>{"dragging"in m&&e(0,r=m.dragging)},[r,s,n,i,c,o,u,h,y]}var zc=class extends jt{constructor(t){super();qt(this,t,Fy,Ry,At,{dragging:0})}},Uc=zc;function qy(a){let t,e=a[3].default,i=ji(e,a,a[2],null);return{c(){i&&i.c()},m(c,l){i&&i.m(c,l),t=!0},p(c,[l]){i&&i.p&&l&4&&Ri(i,e,c,c[2],l,null,null)},i(c){t||(at(i,c),t=!0)},o(c){St(i,c),t=!1},d(c){i&&i.d(c)}}}function Vy(a,t,e){let{$$slots:i={},$$scope:c}=t,{ctrl:l}=t,{sequencer:r}=t;return Lc(r,l),a.$$set=s=>{"ctrl"in s&&e(0,l=s.ctrl),"sequencer"in s&&e(1,r=s.sequencer),"$$scope"in s&&e(2,c=s.$$scope)},[l,r,c,i]}var Gc=class extends jt{constructor(t){super();qt(this,t,Vy,qy,At,{ctrl:0,sequencer:1})}},Yc=Gc;function Wy(a){let t,e,i,c,l,r;return e=new Ba({props:{playing:a[1]}}),e.$on("dragStart",a[6]),e.$on("dragEnd",a[7]),e.$on("play",a[8]),l=new Uc({props:{dragging:a[0]}}),{c(){t=K("div"),ne(e.$$.fragment),i=Pt(),c=K("div"),ne(l.$$.fragment),H(t,"class","px-16 py-4  max-w-8xl"),H(c,"class","px-16 py-4 flex-1 overflow-hidden  max-w-8xl")},m(s,n){Ot(s,t,n),Zt(e,t,null),Ot(s,i,n),Ot(s,c,n),Zt(l,c,null),r=!0},p(s,n){let o={};n&2&&(o.playing=s[1]),e.$set(o);let u={};n&1&&(u.dragging=s[0]),l.$set(u)},i(s){r||(at(e.$$.fragment,s),at(l.$$.fragment,s),r=!0)},o(s){St(e.$$.fragment,s),St(l.$$.fragment,s),r=!1},d(s){s&&wt(t),Xt(e),s&&wt(i),s&&wt(c),Xt(l)}}}function Ly(a){let t,e,i;return e=new Yc({props:{sequencer:a[2],ctrl:a[3],$$slots:{default:[Wy]},$$scope:{ctx:a}}}),{c(){t=K("div"),ne(e.$$.fragment),H(t,"class","absolute w-full h-full flex flex-col items-center")},m(c,l){Ot(c,t,l),Zt(e,t,null),i=!0},p(c,[l]){let r={};l&32771&&(r.$$scope={dirty:l,ctx:c}),e.$set(r)},i(c){i||(at(e.$$.fragment,c),i=!0)},o(c){St(e.$$.fragment,c),i=!1},d(c){c&&wt(t),Xt(e)}}}var By=24;function zy(a,t,e){let i,[c,l]=Bc();ee(a,c,b=>e(5,i=b)),window.ctrl=l;let r,s=new Array(128).fill(1),n,o=["C_1","C#_1","D_1","D#_1","E_1","F_1","F#_1","G_1","G#_1","A_1","A#_1","B_1","C0","C#0","D0","D#0","E0","F0","F#0","G0","G#0","A0","A#0","B0","C1","C#1","D1","D#1","E1","F1","F#1","G1","G#1","A1","A#1","B1","C2","C#2","D2","D#2","E2","F2","F#2","G2","G#2","A2","A#2","B2","C3","C#3","D3","D#3","E3","F3","F#3","G3","G#3","A3","A#3","B3","C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4","A4","A#4","B4","C5","C#5","D5","D#5","E5","F5","F#5","G5","G#5","A5","A#5","B5","C6","C#6","D6","D#6","E6","F6","F#6","G6","G#6","A6","A#6","B6","C7","C#7","D7","D#7","E7","F7","F#7","G7","G#7","A7","A#7","B7","C8","C#8","D8","D#8","E8","F8","F#8","G8","G#8","A8","A#8","B8","C9","C#9","D9","D#9","E9","F9","F#9","G9"],u=new Array(128).fill(void 0);function h(b,k){u[b]===void 0&&(u[b]=new ze().toDestination());let x=o[By+Math.floor(b/16)*7+b%16];u[b].triggerAttackRelease(x,"8n",k)}function f(b){let k=Ar();b.forEach(({play:x})=>p(x,k))}function p(b,k){e(1,s=s.map((x,g)=>b===g?.4*Math.random()+1.1:x)),h(b,k),setTimeout(()=>{e(1,s=s.map((x,g)=>b===g?1:x))},200)}function d(b){l.setEvent(b.detail.col,b.detail.row,b.detail.event)}let _=b=>e(0,r=b.detail.event),y=()=>e(0,r=void 0),m=b=>p(b.detail.event,Ar());return a.$$.update=()=>{if(a.$$.dirty&32){t:f(i.events)}if(a.$$.dirty&1){t:r!==void 0?document.body.style.cursor="grabbing":document.body.style.cursor=""}},[r,s,c,l,p,i,_,y,m]}var Qc=class extends jt{constructor(t){super();qt(this,t,zy,Ly,At,{})}},Hc=Qc;import.meta.env=Pi;var Uy=new Hc({target:document.body}),Gy=Uy;export{Gy as default};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */
